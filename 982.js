"use strict";(self.webpackChunkPokeTool=self.webpackChunkPokeTool||[]).push([[982],{4982:(be,L,g)=>{g.r(L),g.d(L,{HomeNdsModule:()=>Ee});var v=g(9808),k=g(8555),t=g(5e3),P=g(2233);let N=(()=>{class s{constructor(){this.isLoaded=!1,this.onFileSystemLoad=new t.vpe}load(e){this.fileAllocationTable=new U(e),this.fileNameTable=new H(e,this.fileAllocationTable),this.isLoaded=!0,this.onFileSystemLoad.emit()}getFileByType(e,r){return null}getFile(e){let r=e.split("/"),n=r[r.length-1],o="";for(let c=0;c<r.length-1;c++)o+=r[c]+(c!==r.length-2?"/":"");let l=this.getFolder(o);return this.getFileInFolder(l,n)}getFolder(e){let r=e.split("/"),n=new Array(r.length),o=this.fileNameTable.root;for(let l=0;l<n.length;l++){if(n[l]=this.getFolderInFolder(o,r[l]),l==n.length-1)return n[l];o=n[l]}}getFolderInFolder(e,r){for(let n=0;n<e.folders.length;n++){let o=e.folders[n];if(r===o.name)return o}}getFileInFolder(e,r){for(let n=0;n<e.files.length;n++){let o=e.files[n];if(r===o.name)return o}}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();class U{constructor(i){this.ndsService=i,this.entries=[],this.ndsService.goTo(this.ndsService.header.fatOffset);for(let e=0;e<i.header.fatLength/8;e++){let r=new B;r.offset=i.getInt(),r.size=i.getInt()-r.offset,console.log({offset:r.offset,size:r.size}),this.entries.push(r)}}}class B{constructor(i,e){this.offset=i,this.size=e}}class H{constructor(i,e){this.ndsService=i;let r=e.entries,n=i.getShort(i.header.fntOffset+6),o=[];i.goTo(i.header.fntOffset);for(let l=0;l<n;l++){let c=new M;if(c.offset=i.getInt(),c.firstFileId=i.getShort(),c.parentFolderId=i.getShort(),0!==l&&i.position>i.header.fntOffset+(o.length>0?o[0].offset:0)){n--,l--;continue}let m=i.position,u=c.firstFileId;i.goTo(i.header.fntOffset+c.offset);let d=i.getByte();for(;0!==d;){if(d<128){let h=new w;h.name=i.getString(d),h.id=u++,h.address=r[h.id].offset,h.size=r[h.id].size,h.path=i.header.title;let f=i.position;this.ndsService.goTo(h.address),h.format=this.getFileFormat(h.name,h.id,h.size),this.ndsService.goTo(f),c.subFolder.files.push(h)}else{d-=128;let h=new _;h.name=i.getString(d),h.id=i.getShort(),c.subFolder.folders.push(h)}d=i.getByte()}o.push(c),i.goTo(m)}this.root=this.createFolder(o,0,"root"),this.root.id=n}createFolder(i,e,r){let n=new _;if(n.id=e,n.name=r,n.files=i[e&=4095].subFolder.files,i[e].subFolder.folders.length>0)for(let o of i[e].subFolder.folders)n.folders.push(this.createFolder(i,o.id,o.name));return n}getFileFormat(i,e,r){return r<=0?T.Unknown:"FNT.BIN"===(i=i.toUpperCase())||"FAT.BIN"===i||i.startsWith("OVERLAY9_")||i.startsWith("OVERLAY7_")||"ARM9.BIN"===i||"ARM7.BIN"===i||"Y9.BIN"===i||"BANNER.BIN"===i||i.endsWith(".SRL")||i.endsWith(".NDS")?T.System:T.Unknown}}var T=(()=>{return(s=T||(T={}))[s.Palette=0]="Palette",s[s.Tile=1]="Tile",s[s.Map=2]="Map",s[s.Cell=3]="Cell",s[s.Animation=4]="Animation",s[s.FullImage=5]="FullImage",s[s.Text=6]="Text",s[s.Video=7]="Video",s[s.Sound=8]="Sound",s[s.Font=9]="Font",s[s.Compressed=10]="Compressed",s[s.Unknown=11]="Unknown",s[s.System=12]="System",s[s.Script=13]="Script",s[s.Pack=14]="Pack",s[s.Model3D=15]="Model3D",s[s.Texture=16]="Texture",T;var s})();class w{constructor(i,e,r,n,o,l,c){this.address=i,this.size=e,this.name=r,this.id=n,this.path=o,this.format=l,this.tag=c}}class _{constructor(i=[],e=[],r,n,o){this.folders=i,this.files=e,this.name=r,this.id=n,this.tag=o}}class M{constructor(i,e,r,n=new _){this.offset=i,this.firstFileId=e,this.parentFolderId=r,this.subFolder=n}}let Z=(()=>{class s{constructor(){}bgr555ToColorList(e){let r=new Array(e.length/2);for(let n=0;n<r.length;n++)r[n]=this.bgr555ToColor(e[2*n],e[2*n+1]);return r}bgr555ToColor(e,r){let n,o,l,c=this.bytesToInt16([e,r],0);return n=8*(31&c),o=8*((992&c)>>5),l=8*((31744&c)>>10),{red:n,green:o,blue:l,alpha:1}}bytesToInt16(e,r){return(255&e[r+1])<<8|(255&e[r])<<0}byteToBit4(e){let r=new Array(2);return r[0]=15&e,r[1]=(240&e)>>4,r}bytesToBit4(e){let r=new Array(2*e.length);for(let n=0;n<e.length;n++){let o=this.byteToBit4(e[n]);r[2*n]=o[0],r[2*n+1]=o[1]}return r}byteToBit2(e){let r=new Array(4);return r[0]=3&e,r[1]=e>>2&3,r[2]=e>>4&3,r[3]=e>>6&3,r}bytesToBit2(e){let r=Array(4*e.length);for(let n=0;n<r.length;n+=4)r[n]=3&e[n],r[n+1]=e[n]>>2&3,r[n+2]=e[n]>>4&3,r[n+3]=e[n]>>6&3;return r}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var D=g(9224),E=g(3251);class b{constructor(i,e){this.ndsService=i,this.fileInfo=e}readHeader(i){let e;switch(i){case S.Length_12:e=new I,e.extension=this.ndsService.getString(4),e.endian=65534==this.ndsService.getShort()?"BIG":"LITTLE",this.ndsService.skip(2),e.fileSize=this.ndsService.getInt(),e.headerSize=this.ndsService.getShort(),e.sectionCount=this.ndsService.getShort();break;case S.Length_16:e=new I,e.extension=this.ndsService.getString(4),e.endian=65534==this.ndsService.getShort()?"BIG":"LITTLE",this.ndsService.skip(4),e.fileSize=this.ndsService.getInt(),e.headerSize=this.ndsService.getInt(),e.sectionCount=this.ndsService.getShort();break;case S.Length_Long:e=new I,e.extension=this.ndsService.getString(4),e.endian=65534==this.ndsService.getShort()?"BIG":"LITTLE",this.ndsService.skip(2),e.fileSize=this.ndsService.getInt(),e.headerSize=this.ndsService.getShort(),e.sectionCount=this.ndsService.getShort();let r=new Array(e.sectionCount);for(let n=0;n<r.length;n++)r[n]=this.ndsService.getInt()+this.fileInfo.address+4;e.sectionOffsets=r}this.header=e}unpack(){}}class I{constructor(){}}var S=(()=>{return(s=S||(S={}))[s.Length_12=0]="Length_12",s[s.Length_16=1]="Length_16",s[s.Length_Long=2]="Length_Long",S;var s})();class j extends b{constructor(i,e,r){super(i,e),this.utilService=r,this.frames=[]}unpack(){super.readHeader(S.Length_12);let i=new Array(this.header.sectionCount);for(let e=0;e<i.length;e++)i[e]=this.fileInfo.address+this.ndsService.getInt();this.ndsService.goTo(i[0]),this.texture=new J(this.ndsService),this.texture.unpack(),this.buildFrames()}buildFrames(){this.frames=new Array(this.texture.textureInfo.objCount);for(let i=0;i<this.frames.length;i++){let e=i;e>=this.texture.textureInfo.names.length&&(e=0);let r,n=!1;for(r=0;r<this.texture.paletteInfo.objCount;r++)if(this.texture.paletteInfo.names[r]==this.texture.textureInfo.names[e]||this.texture.paletteInfo.names[r].split("_pl").join("")==this.texture.textureInfo.names[e]){n=!0;break}n||(r=0),this.frames[i]=this.buildFrame(e,r)}}buildFrame(i,e){let r=this.texture.textureInfo.infoBlock.frameInfos[i],n=this.texture.paletteInfo.info.paletteFrames[e];this.ndsService.goTo(5!==r.format?8*r.textureOffset+this.texture.address+this.texture.header.textureDataOffset:8*r.textureOffset+this.texture.address+this.texture.header.textureCompressedDataOffset);let o=this.ndsService.getBytes(r.width*r.height*r.depth/8);this.ndsService.goTo(this.texture.address+this.texture.header.paletteDataOffset+8*n.paletteOffset);let u,c=this.ndsService.getBytes(this.getPaletteSize(r.textureFormat)),m=this.utilService.bgr555ToColorList(c);return u=5!==r.format?this.buildTexture(r,o,m):this.buildCompressedTexture(r,o,m),u}buildTexture(i,e,r){let n=new Uint8ClampedArray(i.width*i.height*4),o=i.format;e=3==o?this.utilService.bytesToBit4(e):this.utilService.bytesToBit2(e);for(let u=0;u<i.height;u++)for(let d=0;d<i.width;d++){let h=0,f={red:0,green:0,blue:0,alpha:255};if(2==o||3==o||4==o)h=e[d+u*i.width],f=r[h];else if(1==o){h=31&e[d+u*i.width];let p=4*(e[d+u*i.width]>>5);p=8*(4*p+p/2),f={red:r[h].red,green:r[h].green,blue:r[h].blue,alpha:p}}else if(6==o){h=7&e[d+u*i.width];let p=e[d+u*i.width]>>3;p*=8,f={red:r[h].red,green:r[h].green,blue:r[h].blue,alpha:p}}if(1!=i.color0||0!=h){let p=4*(u*i.width+d);n[p]=f.red,n[p+1]=f.green,n[p+2]=f.blue,n[p+3]=255}}let l=document.createElement("canvas"),c=l.getContext("2d");l.width=i.width,l.height=i.height;let m=c.createImageData(i.width,i.height);return m.data.set(n),c.putImageData(m,0,0),l}buildCompressedTexture(i,e,r){}getPaletteSize(i){switch(i){case a.NO_TEXTURE:return 0;case a.A3I5_TRANSLUCENT:return 64;case a.COLORS_4_PALETTE:return 8;case a.COLORS_16_PALETTE:return 32;case a.COLORS_256_PALETTE:case a.TEXEL_4x4_COMPRESSED:return 512;case a.A5I3_TRANSLUCENT:return 16;default:return 0}}}class J{constructor(i){this.ndsService=i,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.header=new Q(this.ndsService),this.header.unpack(),this.ndsService.goTo(this.address+this.header.textureInfoOffset),this.textureInfo=new Y(this.ndsService),this.textureInfo.unpack(),this.ndsService.goTo(this.address+this.header.paletteInfoOffset),this.paletteInfo=new V(this.ndsService),this.paletteInfo.unpack()}}class Y{constructor(i){this.ndsService=i,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.dummy=this.ndsService.getByte(),this.objCount=this.ndsService.getByte(),this.sectionSize=this.ndsService.getShort(),this.ndsService.skip(8+4*this.objCount),this.infoBlock=new q(this.ndsService,this.objCount),this.infoBlock.unpack(),this.names=new Array(this.objCount);for(let i=0;i<this.names.length;i++)this.names[i]=this.ndsService.getString(16)}}class q{constructor(i,e){this.ndsService=i,this.objCount=e,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.headerSize=this.ndsService.getShort(),this.dataSize=this.ndsService.getShort(),this.frameTextures=new Array(this.objCount),this.frameInfos=new Array(this.objCount);let i=0;for(let e=0;e<this.objCount;e++){let r=new X(this.ndsService);r.unpack(),5==r.format&&(r.compressedStartOffset=i,i+=r.width*r.height/8),this.frameInfos[e]=r}}}var a=(()=>{return(s=a||(a={}))[s.NO_TEXTURE=0]="NO_TEXTURE",s[s.A3I5_TRANSLUCENT=1]="A3I5_TRANSLUCENT",s[s.COLORS_4_PALETTE=2]="COLORS_4_PALETTE",s[s.COLORS_16_PALETTE=3]="COLORS_16_PALETTE",s[s.COLORS_256_PALETTE=4]="COLORS_256_PALETTE",s[s.TEXEL_4x4_COMPRESSED=5]="TEXEL_4x4_COMPRESSED",s[s.A5I3_TRANSLUCENT=6]="A5I3_TRANSLUCENT",s[s.DIRECT=7]="DIRECT",a;var s})();class X{constructor(i){this.ndsService=i,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.textureOffset=this.ndsService.getShort(),this.parameters=this.ndsService.getShort(),this.width2=this.ndsService.getByte(),this.sizeOpcode=this.ndsService.getByte(),this.ndsService.skip(2),this.coordTransform=14&this.parameters,this.color0=this.parameters>>13&1,this.format=this.parameters>>10&7,this.height=8<<(this.parameters>>7&7),this.width=8<<(this.parameters>>4&7),this.flipY=this.parameters>>3&1,this.flipX=this.parameters>>2&1,this.repeatY=this.parameters>>1&1,this.repeatX=1&this.parameters,0==this.width&&(this.width=2==(3&this.sizeOpcode)?512:256),0==this.height&&(this.height=2==(this.sizeOpcode>>4&3)?512:256),this.textureFormat=this.getTextureFormat(this.format),this.depth=this.getDepth(this.textureFormat)}getDepth(i){switch(i){case a.NO_TEXTURE:return 0;case a.A3I5_TRANSLUCENT:return 8;case a.COLORS_4_PALETTE:return 2;case a.COLORS_16_PALETTE:return 4;case a.COLORS_256_PALETTE:return 8;case a.TEXEL_4x4_COMPRESSED:return 2;case a.A5I3_TRANSLUCENT:return 8;case a.DIRECT:return 16;default:return 0}}getTextureFormat(i){switch(i){case 0:default:return a.NO_TEXTURE;case 1:return a.A3I5_TRANSLUCENT;case 2:return a.COLORS_4_PALETTE;case 3:return a.COLORS_16_PALETTE;case 4:return a.COLORS_256_PALETTE;case 5:return a.TEXEL_4x4_COMPRESSED;case 6:return a.A5I3_TRANSLUCENT;case 7:return a.DIRECT}}}class Q{constructor(i){this.ndsService=i,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.type=this.ndsService.getString(4),this.sectionSize=this.ndsService.getInt(),this.ndsService.skip(4),this.textureDataSize=this.ndsService.getShort(),this.textureInfoOffset=this.ndsService.getShort(),this.ndsService.skip(4),this.textureDataOffset=this.ndsService.getInt(),this.ndsService.skip(4),this.textureCompressedDataSize=this.ndsService.getShort(),this.textureCompressedInfoOffset=this.ndsService.getShort(),this.ndsService.skip(4),this.textureCompressedDataOffset=this.ndsService.getInt(),this.textureCompressedInfoDataOffset=this.ndsService.getInt(),this.ndsService.skip(4),this.paletteDataSize=this.ndsService.getInt(),this.paletteInfoOffset=this.ndsService.getInt(),this.paletteDataOffset=this.ndsService.getInt(),this.textureCompressedDataSize<<=3,this.paletteDataSize<<=3}}class V{constructor(i){this.ndsService=i,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.dummy=this.ndsService.getByte(),this.objCount=this.ndsService.getByte(),this.sectionSize=this.ndsService.getByte(),this.ndsService.skip(8+4*this.objCount),this.info=new $(this.ndsService,this.objCount),this.info.unpack(),this.names=new Array(this.objCount);for(let i=0;i<this.objCount;i++)this.names[i]=this.ndsService.getString(16)}}class ${constructor(i,e){this.ndsService=i,this.objCount=e,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.headerSize=this.ndsService.getShort(),this.dataSize=this.ndsService.getShort(),this.paletteData=new Array(this.objCount),this.paletteFrames=new Array(this.objCount);for(let i=0;i<this.objCount;i++){let e=new G(this.ndsService);e.unpack(),this.paletteFrames[i]=e}}}class G{constructor(i){this.ndsService=i,this.address=this.ndsService.position}unpack(){this.ndsService.goTo(this.address),this.paletteOffset=8191&this.ndsService.getShort()}}class W extends b{constructor(i,e){super(i,e),this.ndsService=i,this.fileInfo=e,this.folders=[],this.files=[],i.goTo(e.address+16),this.fat=new K(e.address+16),i.goTo(e.address+24),this.fnt=new ee(8*i.getInt()+28),i.goTo(this.fnt.offset+4),this.fimg=new te(i.getInt()+this.fnt.offset)}unpack(){this.ndsService.goTo(this.fileInfo.address),super.readHeader(S.Length_12),this.ndsService.goTo(this.fat.offset),this.fat.id=this.ndsService.getString(4),this.fat.sectionSize=this.ndsService.getInt(),this.fat.fileCount=this.ndsService.getInt();let i=new Array(this.fat.fileCount);for(let o=0;o<i.length;o++)i[o]=new ie,i[o].offset=this.ndsService.getInt(),i[o].size=this.ndsService.getInt()-i[o].offset;this.fat.entries=i,this.fnt.id=this.ndsService.getString(4),this.fnt.sectionSize=this.ndsService.getInt();let e=this.ndsService.position;this.fimg.offset=this.ndsService.position+this.fnt.sectionSize,this.ndsService.skip(6);let r=this.ndsService.getShort();this.ndsService.goTo(this.ndsService.position-8);for(let o=0;o<r;o++){let l=new se;l.offset=this.ndsService.getInt(),l.firstFileId=this.ndsService.getShort(),l.parentFolderId=this.ndsService.getShort();let c=l.firstFileId;if(l.offset<8){for(let h=0;h<this.fat.fileCount;h++){let f=new w;f.name=this.fileInfo.name+"_"+c,f.id=c++,f.path=this.fileInfo.path,f.size=this.fat.entries[f.id].size,f.address=this.fat.entries[f.id].offset+this.fimg.offset;let p=this.ndsService.position;this.ndsService.goTo(f.address);let C="";C=this.ndsService.getString(f.size<4?f.size:4);let O=".";for(let F=0;F<C.length;F++){let y=C.charAt(F);(/^[a-zA-Z()]+$/.test(y)||!isNaN(y)||32==y.charCodeAt(F))&&(O+=C)}f.name+=5==O.length&&f.size>=4?O:".bin",this.ndsService.goTo(p),l.files.push(f)}this.fnt.entries.push(l);continue}let m=this.ndsService.position;this.ndsService.goTo(l.offset+e);let u=128,d=this.ndsService.getByte();for(;0!==d;){if(0==(d&u)){let h=new w;h.id=c++,h.name=this.ndsService.getString(h.id),h.path=this.fileInfo.path,h.address=this.fat.entries[h.id].offset,h.size=this.fat.entries[h.id].size,l.files.push(h)}else{let h=new _;h.name=this.ndsService.getString(d-u),h.id=this.ndsService.getShort(),l.folders.push(h)}d=this.ndsService.getByte()}this.fnt.entries.push(l),this.ndsService.goTo(m)}let n=this.createFolderRecursively(this.fnt.entries,61440,"root");for(let o=0;o<n.files.length;o++)this.files.push(n.files[o]);for(let o=0;o<n.folders.length;o++)this.folders.push(n.folders[o]);this.ndsService.goTo(this.fimg.offset-8),this.fimg.id=this.ndsService.getString(4),this.fimg.sectionSize=this.ndsService.getInt()}createFolderRecursively(i,e,r){let n=new _;n.name=r,n.id=e,n.files=i[4095&e].files;for(let o of i[4095&e].folders)n.folders.push(this.createFolderRecursively(i,o.id,o.name));return n}}class K{constructor(i){this.offset=i,this.entries=[]}}class ee{constructor(i){this.offset=i,this.entries=[]}}class te{constructor(i){this.offset=i}}class ie{constructor(i,e){this.offset=i,this.size=e}}class se{constructor(i,e,r,n=[],o=[]){this.offset=i,this.firstFileId=e,this.parentFolderId=r,this.folders=n,this.files=o}}var re=g(508),ne=g(8099),oe=g(4834),z=g(4623),A=g(7322),he=g(7531),x=g(3075);function le(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"mat-list-item",12),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw(2).setCurrentFolder(o)}),t.TgZ(1,"mat-icon",13),t._uU(2,"folder"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&s){const e=i.$implicit;t.xp6(4),t.Oqu(e.name)}}function ae(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"mat-list-item",12),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw(2).setCurrentFile(o)}),t.TgZ(1,"mat-icon",14),t._uU(2,"description"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&s){const e=i.$implicit;t.xp6(4),t.Oqu(e.name)}}function ce(s,i){if(1&s&&(t.TgZ(0,"mat-list",10),t.YNc(1,le,5,1,"mat-list-item",11),t.YNc(2,ae,5,1,"mat-list-item",11),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.currentFolder.folders),t.xp6(1),t.Q6J("ngForOf",e.currentFolder.files)}}function de(s,i){if(1&s&&(t.TgZ(0,"span",34)(1,"b"),t._uU(2),t.qZA()()),2&s){const e=i.index;t.xp6(2),t.Oqu((1==e.toString(16).length?"0":"")+e.toString(16).toUpperCase()+" ")}}function fe(s,i){1&s&&t._UZ(0,"br")}function ue(s,i){if(1&s&&(t.TgZ(0,"span",35),t.YNc(1,fe,1,0,"br",36),t.TgZ(2,"b"),t._uU(3),t.qZA()()),2&s){const e=i.$implicit,r=i.index;t.xp6(1),t.Q6J("ngIf",0!==r&&r%16==0),t.xp6(2),t.Oqu((1==e.toString(16).length?"0":"")+e.toString(16).toUpperCase()+" ")}}function ge(s,i){1&s&&t._UZ(0,"br")}function pe(s,i){if(1&s&&(t.TgZ(0,"span",35),t.YNc(1,ge,1,0,"br",36),t.TgZ(2,"b"),t._uU(3),t.qZA()()),2&s){const e=i.$implicit,r=i.index,n=t.oxw(3);t.xp6(1),t.Q6J("ngIf",0!==r&&r%16==0),t.xp6(2),t.Oqu(n.characterFromByte(e))}}const Se=function(){return[]};function me(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"div",25)(1,"div",26),t.YNc(2,de,3,1,"span",27),t.TgZ(3,"div",28)(4,"span",29),t._uU(5),t.qZA(),t.TgZ(6,"mat-icon",30),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).goBackHexPage()}),t._uU(7,"arrow_back"),t.qZA(),t.TgZ(8,"mat-icon",30),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).goForwardHexPage()}),t._uU(9,"arrow_forward"),t.qZA()()(),t.TgZ(10,"div",31)(11,"div",32),t.YNc(12,ue,4,2,"span",33),t.qZA(),t.TgZ(13,"div"),t.YNc(14,pe,4,2,"span",33),t.qZA()()()}if(2&s){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",t.DdM(7,Se).constructor(16)),t.xp6(3),t.AsE("",e.currentHexPage+1," / ",e.currentHexPageCount,""),t.xp6(1),t.Q6J("ngClass",0==e.currentHexPage?"text-gray":""),t.xp6(2),t.Q6J("ngClass",e.currentHexPage==e.currentHexPageCount-1?"text-gray":""),t.xp6(4),t.Q6J("ngForOf",e.currentFileData),t.xp6(2),t.Q6J("ngForOf",e.currentFileData)}}function ve(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t.TgZ(7,"input",20),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().currentFile.fileInfo.name=n}),t.qZA()(),t.TgZ(8,"mat-form-field",21)(9,"mat-label"),t._uU(10,"Address"),t.qZA(),t.TgZ(11,"input",22),t.NdJ("change",function(n){t.CHM(e);const o=t.oxw();return o.currentFile.fileInfo.address=o.getInputHexValue(n)}),t.qZA(),t.TgZ(12,"mat-hint"),t._uU(13,"Hexidecimal big endian"),t.qZA()()(),t.TgZ(14,"div",23),t.YNc(15,me,15,8,"div",24),t.qZA()()()()}if(2&s){const e=t.oxw();t.xp6(7),t.Q6J("ngModel",e.currentFile.fileInfo.name),t.xp6(4),t.Q6J("value",e.currentFile.fileInfo.address.toString(16).toUpperCase()),t.xp6(4),t.Q6J("ngIf",e.currentFileData)}}let Te=(()=>{class s{constructor(e,r,n){this.ndsService=e,this.fileService=r,this.utilityService=n,this.currentPath="root",this.currentFileData=[],this.hexPageSize=512,this.currentHexPage=0,this.currentHexPageCount=1}ngOnInit(){this.ndsService.isLoaded&&this.fileService.isLoaded&&(this.currentFolder=this.fileService.fileNameTable.root),this.ndsService.onRomLoad.subscribe(()=>{this.fileService.isLoaded&&(this.currentFolder=this.fileService.fileNameTable.root)}),this.fileService.onFileSystemLoad.subscribe(()=>{this.ndsService.isLoaded&&(this.currentFolder=this.fileService.fileNameTable.root)})}setCurrentFolder(e,r){this.currentFolder=e,r||(this.currentPath+="/"+e.name)}setCurrentFile(e){switch(this.currentFile=new b(this.ndsService,e),this.ndsService.goTo(e.address),this.currentFile.readHeader(S.Length_12),this.currentFile.header.extension){case"NARC":this.currentFile=new W(this.ndsService,e);break;case"BTX0":this.currentFile=new j(this.ndsService,e,this.utilityService)}this.currentFile.unpack(),this.ndsService.goTo(e.address),this.currentFileData=this.ndsService.getBytes(e.size<=this.hexPageSize?e.size:this.hexPageSize),this.currentHexPageCount=Math.floor(e.size/this.hexPageSize)+1,this.currentHexPage=0}goBack(){if("root"!==this.currentPath){let n,e=this.currentPath.split("/"),r="";for(let o=0;o<e.length-1;o++)r+=e[o]+(o!==e.length-2?"/":"");this.currentPath=r,console.log(r),n="root"==r?this.fileService.fileNameTable.root:this.fileService.getFolder(r.replace("root/","")),this.currentPath=r,this.setCurrentFolder(n,!0)}}goForwardHexPage(){if(this.currentHexPage+1>=this.currentHexPageCount)return;let e=this.currentHexPage+2==this.currentHexPageCount;this.currentHexPage++,this.ndsService.goTo(this.currentFile.fileInfo.address+this.currentHexPage*this.hexPageSize),console.log(e),this.currentFileData=this.ndsService.getBytes(e?Math.floor(this.currentFile.fileInfo.size%this.hexPageSize):this.hexPageSize)}goBackHexPage(){this.currentHexPage-1<0||(this.currentHexPage--,this.ndsService.goTo(this.currentFile.fileInfo.address+this.currentHexPage*this.hexPageSize),this.currentFileData=this.ndsService.getBytes(this.hexPageSize))}characterFromByte(e){return String.fromCharCode(e)}getInputHexValue(e){let r=e.target.value,o=0;return/[0-9A-Fa-f]{6}/g.test(r)&&(o=Number.parseInt(r,16)),o}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(P.ET),t.Y36(N),t.Y36(Z))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-file-editor"]],decls:16,vars:4,consts:[[1,"d-inline-flex","poke-tool-card-inner","w-100"],[1,"d-flex","flex-column","poke-tool-card-inner","bg-gray","file-list","overflow-auto"],[1,"w-100","d-inline-flex","align-items-center"],[1,"mx-3","pt-2"],["matRipple","",1,"cursor-pointer","back-button","d-inline-flex","align-items-center","justify-content-center","bg-gray-dark-hover",3,"click"],[3,"vertical"],[1,"mr-3","pt-2"],[1,"mb-0"],["class","file-list",4,"ngIf"],["class","p-3 d-inline-flex poke-tool-card-inner overflow-auto w-100",4,"ngIf"],[1,"file-list"],["class","poke-tool-sidenav-item-inner border-top","matRipple","",3,"click",4,"ngFor","ngForOf"],["matRipple","",1,"poke-tool-sidenav-item-inner","border-top",3,"click"],[1,"cursor-pointer","mr-2","material-icons-outlined"],[1,"cursor-pointer","mr-2","text-secondary","material-icons-outlined"],[1,"p-3","d-inline-flex","poke-tool-card-inner","overflow-auto","w-100"],[1,"w-100"],[1,"row"],[1,"col-md-3"],["appearance","outline",1,"w-100"],["matInput","","placeholder","??????????","maxlength","13","readonly","",3,"ngModel","ngModelChange"],["appearance","outline",1,"w-100","mb-2"],["type","text","matInput","","placeholder","0",3,"value","change"],[1,"col-md-9"],["class","bg-gray w-100",4,"ngIf"],[1,"bg-gray","w-100"],[1,"mb-2","p-2","border-bottom"],["class","hex-value",4,"ngFor","ngForOf"],[1,"float-right","d-inline-flex","align-items-center"],[1,"mr-2"],[1,"cursor-pointer",3,"ngClass","click"],[1,"p-2","d-inline-flex","w-100"],[1,"border-right","mr-3","pr-3"],["class","hex-value text-no-wrap",4,"ngFor","ngForOf"],[1,"hex-value"],[1,"hex-value","text-no-wrap"],[4,"ngIf"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.NdJ("click",function(){return r.goBack()}),t.TgZ(5,"mat-icon"),t._uU(6,"arrow_backward"),t.qZA()()(),t._UZ(7,"mat-divider",5),t.TgZ(8,"div",6)(9,"p",7)(10,"b"),t._uU(11,"Current Folder"),t.qZA()(),t.TgZ(12,"p",7),t._uU(13),t.qZA()()(),t.YNc(14,ce,3,2,"mat-list",8),t.qZA(),t.YNc(15,ve,16,3,"div",9),t.qZA()),2&e&&(t.xp6(7),t.Q6J("vertical",!0),t.xp6(6),t.Oqu(r.currentPath),t.xp6(1),t.Q6J("ngIf",r.currentFolder),t.xp6(1),t.Q6J("ngIf",r.currentFile))},directives:[re.wG,ne.Hw,oe.d,v.O5,z.i$,v.sg,z.Tg,A.KE,A.hX,he.Nt,x.Fj,x.nD,x.JJ,x.On,A.bx,v.mk],styles:[".file-list[_ngcontent-%COMP%]{width:auto!important;min-width:240px;overflow-x:hidden}.back-button[_ngcontent-%COMP%]{height:36px;width:36px;line-height:36px;border-radius:18px;text-align:center}"]}),s})();function _e(s,i){1&s&&t._UZ(0,"app-file-editor")}function xe(s,i){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.hij("NDS ROM loaded in ",(e.ndsService.romLoadTime/1e3).toFixed(1)," seconds")}}const Ce=[{path:"",component:(()=>{class s{constructor(e,r,n){this.ndsService=e,this.nitroFileService=r,this.utilService=n,this.isLoaded=!1}ngAfterViewInit(){console.log("Landed on NDS page"),this.nitroFileService.load(this.ndsService)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(P.ET),t.Y36(N),t.Y36(Z))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-home-nds"]],decls:13,vars:3,consts:[[1,"w-100","p-0","poke-tool-card","noselect"],["toolGroup",""],["label","Files"],["fileTool",""],["matTabContent",""],[1,"w-100","d-inline-flex","justify-content-between","align-items-center","px-2"],[4,"ngIf"],[1,"d-inline-flex"],["href","https://www.pokecommunity.com/showthread.php?t=456210","target","_blank",1,"mr-3"],["href","https://github.com/jugales/pokewebkit","target","_blank"]],template:function(e,r){1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-tab-group",null,1)(3,"mat-tab",2,3),t.YNc(5,_e,1,0,"ng-template",4),t.qZA()()(),t.TgZ(6,"div",5),t.YNc(7,xe,2,1,"span",6),t.TgZ(8,"div",7)(9,"a",8),t._uU(10,"Pok\xe9Community"),t.qZA(),t.TgZ(11,"a",9),t._uU(12,"Github"),t.qZA()()()),2&e&&(t.xp6(6),t.Udp("height","36px"),t.xp6(1),t.Q6J("ngIf",r.ndsService.isLoaded))},directives:[D.a8,E.SP,E.uX,E.Vc,Te,v.O5],styles:[""]}),s})()}];let Fe=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[k.Bz.forChild(Ce)],k.Bz]}),s})();var R=g(4202);let we=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[v.ez,x.u5,R.q]]}),s})(),Ee=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[v.ez,R.q,we,Fe]]}),s})()}}]);