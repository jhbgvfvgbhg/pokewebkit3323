"use strict";(self.webpackChunkPokeTool=self.webpackChunkPokeTool||[]).push([[981],{7981:(p0,Be,v)=>{v.r(Be),v.d(Be,{WorldModule:()=>c0});var _=v(9808),Fe=v(8555),ie=v(655),w=v(1474),y=v(1909);class Oe{constructor(r,t,n,o,a,s,c,l,p){this.bankId=r,this.mapId=t,this.label=n,this.header=o,this.layout=a,this.blockset=s,this.blockData=c,this.entityData=l,this.encounterData=p}}class Qt{constructor(r,t=[],n,o,a,s,c,l,p,d,h,x,u,m){this.address=r,this.data=t,this.mapDataAddress=n,this.eventDataAddress=o,this.mapScriptsAddress=a,this.connectionsAddress=s,this.musicId=c,this.mapIndex=l,this.labelIndex=p,this.visibilityType=d,this.weatherType=h,this.mapType=x,this.shouldShowLabelOnEntry=u,this.battlefieldType=m}}class Wt{constructor(r,t,n,o,a,s,c,l,p,d){this.mapWidth=r,this.mapHeight=t,this.borderTilemapAddress=n,this.tileDataAddress=o,this.primaryTilesetAddress=a,this.secondaryTilesetAddress=s,this.borderWidth=c,this.borderHeight=l,this.primaryTileset=p,this.secondaryTileset=d}load(r){this.mapWidth=r.getInt(),this.mapHeight=r.getInt(),this.borderTilemapAddress=r.getPointer(),this.tileDataAddress=r.getPointer(),this.primaryTilesetAddress=r.getPointer(),this.secondaryTilesetAddress=r.getPointer(),this.borderWidth=r.getInt(),this.borderHeight=r.getInt()}}class Ne{constructor(r,t,n,o,a,s,c,l,p=[],d=[],h=new Array(15)){this.index=r,this.isCompressed=t,this.isSecondary=n,this.bitmapAddress=o,this.paletteAddress=a,this.blockAddress=s,this.blockBackgroundAddress=c,this.blockMetaAddress=l,this.pixels=p,this.alternatePixels=d,this.palettes=h,this.PALETTE_COUNT=15,this.tileCache=new Map,this.blockCache=new Map}load(r,t){this.isCompressed=1==r.getByte(),this.isSecondary=1==r.getByte(),r.skip(2),this.bitmapAddress=r.getPointer(),this.paletteAddress=r.getPointer(),this.blockAddress=r.getPointer(),r.header.gameCode.startsWith("BPRE")?(this.blockBackgroundAddress=r.getPointer(),this.blockMetaAddress=r.getPointer()):(this.blockMetaAddress=r.getPointer(),this.blockBackgroundAddress=r.getPointer()),r.goTo(this.paletteAddress);let n=this.isSecondary?r.constants().MAIN_TILESET_PALETTE_COUNT:0,o=this.isSecondary?this.PALETTE_COUNT:r.constants().MAIN_TILESET_PALETTE_COUNT;for(let a=n;a<o;a++){let s=new y.qD(this.paletteAddress+32*a,16,void 0,void 0,t,r);this.palettes[a]=s,this.loadPalettedImage(a,s,t,r)}}loadPalettedImage(r,t,n,o){let a=new y.dg(this.bitmapAddress,y.eT.BPP_4,void 0,n,o);(!this.pixels||0==this.pixels.length)&&(this.pixels=a.values),this.palettes[r]=t}getBlock(r,t,n){let o=r;if(this.blockCache.has(o))return this.blockCache.get(o);r>=t.constants().MAIN_TILESET_BLOCK_COUNT&&(r-=t.constants().MAIN_TILESET_BLOCK_COUNT);let a=new $t;a.blockId=o,t.header.gameCode.startsWith("BPRE")?(a.behaviorId=t.getByteAt(this.blockMetaAddress+4*r),a.backgroundId=t.getByteAt(this.blockMetaAddress+(4*r+3))):(a.behaviorId=t.getByteAt(this.blockMetaAddress+2*r),a.backgroundId=t.getByteAt(this.blockMetaAddress+(2*r+1)));let l=this.blockAddress+16*r;for(let p=0;p<8;p++){let d=new en,h=t.getShortAt(l+2*p);d.tileId=1023&h,d.paletteId=(61440&h)>>12,d.xFlip=(1024&h)>0,d.yFlip=(2048&h)>0,d=this.getTile(d,t,n),a.tiles.push(d)}return this.blockCache.set(o,a),a}getTile(r,t,n){let o=r.tileId;r.tileId>t.constants().MAIN_TILESET_BLOCK_COUNT&&(o-=t.constants().MAIN_TILESET_BLOCK_COUNT);let a=r.tileId+"-"+r.paletteId+"-"+r.xFlip.toString()+"-"+r.yFlip.toString();if(this.tileCache.has(a))return this.tileCache.get(a);let c=[];if(o==r.tileId&&!this.isSecondary||o!=r.tileId&&this.isSecondary)for(let x=0;x<32;x++)c[x]=this.pixels[32*o+x];else for(let x=0;x<32;x++)c[x]=this.alternatePixels[32*o+x];let l=new y.dg(void 0,y.eT.BPP_4,c,n,t),p=n.createBitmapCanvas(l,this.palettes[r.paletteId],8,8,!0),d=document.createElement("canvas");d.width=8,d.height=8;let h=d.getContext("2d");return r.xFlip||r.yFlip?this.mirrorImage(h,p,0,0,r.xFlip,r.yFlip):d=p,r.bitmap=new y.GC([d],d,125,!0,!1,0),this.tileCache.set(a,r),r}mirrorImage(r,t,n=0,o=0,a=!1,s=!1){r.save(),r.setTransform(a?-1:1,0,0,s?-1:1,a?t.width:0,s?t.height:0),r.drawImage(t,0,0),r.restore()}}class Ht{constructor(r,t,n,o){this.primaryTileset=r,this.secondaryTileset=t,this.bitmapService=n,this.gbaService=o,this.animatedTiles=new Map,this.tilesetAnimationMap=[],this.isLoaded=!1,this.tileCache=new Map,this.blockCache=new Map;for(let s=0;s<o.constants().MAIN_TILESET_PALETTE_COUNT;s++)t.loadPalettedImage(s,r.palettes[s],n,o),t.alternatePixels=r.pixels;for(let s=o.constants().MAIN_TILESET_PALETTE_COUNT;s<15;s++)r.loadPalettedImage(s,t.palettes[s],n,o),r.alternatePixels=t.pixels;let a=[];for(let s=0;s<13;s++)s<this.gbaService.constants().MAIN_TILESET_PALETTE_COUNT?a.push(r.palettes[s]):a.push(t.palettes[s]);r.palettes=a,t.palettes=a;for(let s=0;s<58;s++){let c=this.gbaService.constants().MAP_TILESET_ANIMATION_HEADER+24*s;8==this.gbaService.getByteAt(c+3)&&this.tilesetAnimationMap.push({id:s,address:c})}}getAnimatedTiles(r,t){let n=[],o=t.layout.primaryTileset.index,a=t.layout.secondaryTileset.index;for(let h=0;h<this.tilesetAnimationMap.length;h++)if(this.tilesetAnimationMap[h].id==o||this.tilesetAnimationMap[h].id==a){this.gbaService.goTo(this.tilesetAnimationMap[h].address);let x=this.gbaService.getPointer();for(let u=0;u<(0==h?3:1);u++){this.gbaService.goTo(x+16*u);let m=this.gbaService.getPointer(),f=this.gbaService.getShort(),b=this.gbaService.getByte(),M=this.gbaService.getByte(),de=this.gbaService.getShort(),ne=this.gbaService.getByte(),qt=this.gbaService.getByte(),H=this.gbaService.getShort();var s=[];let j=[];for(let Y=0;Y<ne;Y++){this.gbaService.goTo(m+4*Y);let xe=this.gbaService.getPointer();this.gbaService.goTo(xe);let F=this.gbaService.getBytes(64*H/2),Ie=new y.dg(void 0,y.eT.BPP_4,F,this.bitmapService,this.gbaService),De=this.bitmapService.createBitmapCanvas(Ie,t.layout.primaryTileset.palettes[4],16,void 0,!0);j.push(De.toDataURL()),s.push([]);for(var c=0;c<2;++c)for(var l=0;l<De.height;++l){var p=document.createElement("canvas");p.width=8,p.height=8,p.getContext("2d").drawImage(De,8*c,8*l,8,8,0,0,p.width,p.height),s[Y].push(p.toDataURL())}}let Pe=new y.GC(j,j[0],125,!0,!1);n.push({animation:Pe,stepPieces:s,steps:j,stepDataAddress:m,speed:f,unknown:b,animSlot:M,startTile:de,stepCount:ne,unknown2:qt,tileCount:H})}}return n}getAnimatedTile(r,t,n,o,a,s,c){null==c&&(c=-1);let l=t,p=!1;if(t>this.gbaService.constants().MAIN_TILESET_BLOCK_COUNT&&(l-=this.gbaService.constants().MAIN_TILESET_BLOCK_COUNT,p=!0),!(l<=0))for(let d=0;d<this.tilesetAnimationMap.length;d++)if(this.tilesetAnimationMap[d].id==r||this.tilesetAnimationMap[d].id==c){this.gbaService.goTo(this.tilesetAnimationMap[d].address);let h=this.gbaService.getPointer();for(let x=0;x<(0==d?3:1);x++){this.gbaService.goTo(h+16*x);let u=this.gbaService.getPointer();this.gbaService.skip(4);let m=this.gbaService.getShort(),f=this.gbaService.getByte();this.gbaService.skip(1);let b=this.gbaService.getShort(),M=[],de=m;if(p&&(de-=this.gbaService.constants().MAIN_TILESET_BLOCK_COUNT),(t<m||t>m+b)&&t)continue;let ne=32;for(let H=0;H<f;H++){this.gbaService.goTo(u+4*H);let j=this.gbaService.getPointer()+ne*(l-de);this.gbaService.goTo(j);let Pe=this.gbaService.getBytes(ne),Y=new y.dg(void 0,y.eT.BPP_4,Pe,this.bitmapService,this.gbaService),xe=this.bitmapService.createBitmapCanvas(Y,n[o||0],8,8,!0),F=document.createElement("canvas"),Ie=F.getContext("2d");F.width=8,F.height=8,a||s?this.mirrorImage(Ie,xe,0,0,a,s):F=xe,M.push(F)}return{animation:new y.GC(M,M[0],125,!0,!1)}}}}mirrorImage(r,t,n=0,o=0,a=!1,s=!1){r.save(),r.setTransform(a?-1:1,0,0,s?-1:1,a?t.width:0,s?t.height:0),r.drawImage(t,0,0),r.restore()}getAnimatedTileIndexes(r,t){let n=[];for(let o=0;o<this.tilesetAnimationMap.length;o++)if(this.tilesetAnimationMap[o].id==r||this.tilesetAnimationMap[o].id==t){this.gbaService.goTo(this.tilesetAnimationMap[o].address);let a=this.gbaService.getPointer();for(let s=0;s<(0==o?3:1);s++){n.push([]),this.gbaService.goTo(a+16*s),this.gbaService.skip(8);let c=this.gbaService.getShort();this.gbaService.skip(2);let l=this.gbaService.getShort();for(let p=0;p<l;p++)n[s].push(c+p)}}return n}getBlock(r,t,n){return r<this.gbaService.constants().MAIN_TILESET_BLOCK_COUNT?this.primaryTileset.getBlock(r,t,n):this.secondaryTileset.getBlock(r,t,n)}}class jt{constructor(r,t,n,o){this.tileDataAddress=r,this.mapWidth=t,this.mapHeight=n,this.gbaService=o,this.bottomBlocks=[],this.topBlocks=[],this.blockIds=[],this.blockMetas=[];let a=new Array(t*n),s=new Array(t*n),c=0;for(let l=0;l<n;l++){let p="";for(let d=0;d<t;d++){let h=o.getShortAt(r+2*c);a[c]=1023&h,s[c]=(64512&h)>>10,c++}p=""}this.blockIds=a,this.blockMetas=s}}class Yt{constructor(r,t,n,o,a,s,c,l,p,d=[],h=[],x=[],u=[]){this.gbaService=r,this.npcCount=t,this.signCount=n,this.warpCount=o,this.scriptCount=a,this.npcAddress=s,this.signAddress=c,this.warpAddress=l,this.scriptAddress=p,this.npcs=d,this.signs=h,this.warps=x,this.scripts=u}loadEntities(){for(let r=0;r<this.npcCount;r++){this.gbaService.goTo(this.npcAddress+24*r);let t=this.gbaService.getBytes(24);this.gbaService.goTo(this.npcAddress+24*r);let n=new zt;n.uid=r,n.data=t,n.address=this.gbaService.position,n.npcIndex=this.gbaService.getByte(),n.spriteId=this.gbaService.getByte(),this.gbaService.skip(2),n.xPosition=this.gbaService.getShort(),n.yPosition=this.gbaService.getShort(),this.gbaService.skip(1),n.movementType=this.gbaService.getByte(),n.movementParam=this.gbaService.getByte(),this.gbaService.skip(1),n.isTrainer=1==this.gbaService.getByte(),this.gbaService.skip(1),n.viewRadius=this.gbaService.getShort(),n.scriptAddress=this.gbaService.getPointer(),n.personId=this.gbaService.getShort(),this.gbaService.skip(2),this.npcs.push(n)}for(let r=0;r<this.signCount;r++){this.gbaService.goTo(this.signAddress+12*r);let t=this.gbaService.getBytes(12);this.gbaService.goTo(this.signAddress+12*r);let n=new Gt;n.uid=r,n.data=t,n.address=this.gbaService.position,n.xPosition=this.gbaService.getShort(),n.yPosition=this.gbaService.getShort(),n.movementLayer=this.gbaService.getByte(),n.signType=this.gbaService.getByte(),this.gbaService.skip(2),n.scriptAddress=this.gbaService.getPointer(),(5==n.signType||6==n.signType||7==n.signType)&&(this.gbaService.backtrack(4),n.hiddenItemId=this.gbaService.getShort(),n.globalHiddenIndex=this.gbaService.getByte(),n.hiddenItemAmount=this.gbaService.getByte()),this.signs.push(n)}for(let r=0;r<this.warpCount;r++){this.gbaService.goTo(this.warpAddress+8*r);let t=this.gbaService.getBytes(8);this.gbaService.goTo(this.warpAddress+8*r);let n=new Vt;n.uid=r,n.data=t,n.address=this.gbaService.position,n.xPosition=this.gbaService.getShort(),n.yPosition=this.gbaService.getShort(),this.gbaService.skip(1),n.destinationWarp=this.gbaService.getByte(),n.destinationMap=this.gbaService.getByte(),n.destinationBank=this.gbaService.getByte(),this.warps.push(n)}for(let r=0;r<this.scriptCount;r++){this.gbaService.goTo(this.scriptAddress+16*r);let t=this.gbaService.getBytes(16);this.gbaService.goTo(this.scriptAddress+16*r);let n=new Xt;n.uid=r,n.data=t,n.address=this.gbaService.position,n.xPosition=this.gbaService.getShort(),n.yPosition=this.gbaService.getShort(),this.gbaService.skip(2),n.varNumber=this.gbaService.getShort(),n.varValue=this.gbaService.getShort(),this.gbaService.skip(2),n.scriptAddress=this.gbaService.getPointer(),this.scripts.push(n)}}}class zt{constructor(r,t,n,o,a,s,c,l,p,d,h,x,u,m,f=[],b=[]){this.uid=r,this.address=t,this.npcIndex=n,this.spriteId=o,this.xPosition=a,this.yPosition=s,this.movementType=c,this.movementParam=l,this.isTrainer=p,this.viewRadius=d,this.scriptAddress=h,this.personId=x,this.overworldSprite=u,this.script=m,this.trainers=f,this.trainerSprites=b,this.data=[]}}class Gt{constructor(r,t,n,o,a,s,c,l,p,d,h,x){this.uid=r,this.address=t,this.signIndex=n,this.xPosition=o,this.yPosition=a,this.movementLayer=s,this.signType=c,this.scriptAddress=l,this.hiddenItemId=p,this.globalHiddenIndex=d,this.hiddenItemAmount=h,this.script=x,this.data=[]}}class Vt{constructor(r,t,n,o,a,s,c){this.uid=r,this.address=t,this.xPosition=n,this.yPosition=o,this.destinationWarp=a,this.destinationBank=s,this.destinationMap=c,this.data=[]}}class Xt{constructor(r,t,n,o,a,s,c,l){this.uid=r,this.address=t,this.xPosition=n,this.yPosition=o,this.varNumber=a,this.varValue=s,this.scriptAddress=c,this.script=l,this.data=[]}}class Kt{constructor(r,t,n,o,a=[],s=[]){this.blockId=r,this.doorType=t,this.paletteId=n,this.paletteIdAddress=o,this.blockPixelData=a,this.blocks=s}}class $t{constructor(r,t=[],n,o,a=!1){this.blockId=r,this.tiles=t,this.behaviorId=n,this.backgroundId=o,this.isAnimated=a}}class en{constructor(r,t,n,o,a,s){this.tileId=r,this.paletteId=t,this.xFlip=n,this.yFlip=o,this.isSecondary=a,this.bitmap=s}}class tn{constructor(r,t,n,o,a,s,c,l,p,d,h=16,x=16,u=0,m=0,f,b=[],M=[]){this.address=r,this.title=t,this.index=n,this.tilesTag=o,this.paletteTag=a,this.baseOamAddress=s,this.animationTableAddress=c,this.imageAddress=l,this.oamc=p,this.framesTableAddress=d,this.frameWidth=h,this.frameHeight=x,this.frameCount=u,this.animationCount=m,this.bitmap=f,this.frames=b,this.animations=M}}class nn{constructor(r,t=[],n,o,a,s){this.address=r,this.monsterData=t,this.minLevel=n,this.maxLevel=o,this.monsterId=a,this.spriteCanvas=s}}class on{constructor(){this.encounterBankId=0,this.encounterMapId=0,this.grassAddress=0,this.surfAddress=0,this.treeAddress=0,this.fishingAddress=0,this.encounterTypeGroups=[]}load(r,t){r.goTo(t),this.encounterBankId=r.getByte(),this.encounterMapId=r.getByte(),r.skip(2),this.grassAddress=r.getPointer(),this.surfAddress=r.getPointer(),this.treeAddress=r.getPointer(),this.fishingAddress=r.getPointer(),this.grassAddress>0&&this.encounterTypeGroups.push(new oe(r,this.grassAddress,"GRASS")),this.surfAddress>0&&this.encounterTypeGroups.push(new oe(r,this.surfAddress,"SURF")),this.treeAddress>0&&this.encounterTypeGroups.push(new oe(r,this.treeAddress,"TREE")),this.fishingAddress>0&&this.encounterTypeGroups.push(new oe(r,this.fishingAddress,"FISHING"))}getTypeList(r){for(let t=0;t<this.encounterTypeGroups.length;t++)if(r==this.encounterTypeGroups[t].type)return this.encounterTypeGroups[t]}containsType(r){for(let t=0;t<this.encounterTypeGroups.length;t++)if(r==this.encounterTypeGroups[t].type)return!0;return!1}}class oe{constructor(r,t,n){if(this.ENCOUNTER_COUNTS={GRASS:12,SURF:5,TREE:5,FISHING:10},this.ratio=0,this.isDayNightEnabled=!1,this.monsterDataAddress=0,this.wildMonsters=[],this.dayNightMonsters=[],this.type="",this.type=n,t>0){r.goTo(t),this.ratio=r.getByte(),this.isDayNightEnabled=1==r.getByte(),r.skip(2),this.monsterDataAddress=r.getPointer(),this.wildMonsters=new Array(this.isDayNightEnabled?4:1),this.dayNightMonsters=new Array(4);for(let o=0;o<4;o++)this.isDayNightEnabled?(r.goTo(this.monsterDataAddress+4*o),this.dayNightMonsters[o]=r.getPointer()):this.dayNightMonsters[o]=-1;for(let o=0;o<this.wildMonsters.length;o++){r.goTo(this.isDayNightEnabled?this.dayNightMonsters[o]:this.monsterDataAddress);for(let a=0;a<this.ENCOUNTER_COUNTS[n];a++){let s=new nn;s.address=r.position,s.monsterData=r.getBytes(4),r.goTo(s.address),s.minLevel=r.getByte(),s.maxLevel=r.getByte(),s.monsterId=r.getShort(),this.wildMonsters[o]||(this.wildMonsters[o]=[]),this.wildMonsters[o].push(s)}}}}}var Z=v(8966),e=v(5e3);let rn=(()=>{class i{constructor(t){this.gbaService=t,this.BPRE_FLAG=2457,this.tileAnimationReplacementScript=[0,0,1,33,9,2,136,66,1,211,0,32,16,128,16,76,32,136,1,48,32,128,15,73,0,0,1,33,9,2,136,66,1,211,0,32,32,128,3,76,0,240,3,248,16,188,1,188,0,71,32,71],this.tileAnimationReplacementScriptFiller=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.tileAnimationAssemblyScriptBPRE0=[255,181,18,136,71,72,0,104,0,105,0,40,26,208,6,105,0,46,23,208,247,123,0,36,33,1,113,24,141,123,16,35,43,64,16,43,11,208,141,121,19,28,43,64,205,121,157,66,8,216,4,211,13,121,16,28,232,64,0,240,37,248,1,52,188,66,233,211,55,72,0,104,64,105,0,40,26,208,6,105,0,46,23,208,247,123,0,36,33,1,113,24,141,123,16,35,43,64,16,43,11,208,141,121,19,28,43,64,205,121,157,66,8,216,4,211,13,121,16,28,232,64,0,240,5,248,1,52,188,66,233,211,255,188,0,189,252,181,143,123,2,38,62,64,2,46,2,209,192,26,0,4,0,12,8,38,62,64,8,46,10,209,78,121,176,66,0,216,6,224,16,49,143,123,16,38,62,64,16,46,0,208,37,224,74,137,1,38,62,64,1,46,1,208,16,64,5,224,18,180,17,28,23,76,0,240,40,248,18,188,138,137,12,104,13,137,2,38,62,64,2,46,15,209,11,137,91,1,74,137,16,64,128,0,0,25,0,104,138,137,18,1,14,73,201,24,11,223,13,73,201,24,11,223,1,224,0,240,2,248,252,189,192,70,55,181,128,0,0,25,0,104,8,73,109,1,73,25,82,1,7,76,0,240,1,248,55,189,32,71,0,0,252,109,3,2,133,70,30,8,20,123,3,2,0,0,0,5,0,0,0,6,5,255,6,8,255,255,255,255,255,255,255,255,116,184,58,8,3,0,7,0,208,1,7,0,18,0,0,3,84,166,58,8,4,0,15,1,160,1,7,0,48,0,0,3,96,118,58,8,4,0,15,2,252,1,5,0,4,0,1,3,180,189,58,8,4,0,12,0,232,2,5,0,8,0,1,1,200,199,58,8,1,0,1,0,112,3,1,0,7,0,0,1,80,201,58,8,4,0,15,0,227,2,3,0,4,0,0,1,232,193,58,8,4,0,10,0,208,3,3,0,8,0,0,1,248,197,58,8,4,0,15,0,128,3,3,0,8,0,0,1],this.tileAnimationAssemblyScriptBPRE1=[255,181,18,136,71,72,0,104,0,105,0,40,26,208,6,105,0,46,23,208,247,123,0,36,33,1,113,24,141,123,16,35,43,64,16,43,11,208,141,121,19,28,43,64,205,121,157,66,8,216,4,211,13,121,16,28,232,64,0,240,37,248,1,52,188,66,233,211,55,72,0,104,64,105,0,40,26,208,6,105,0,46,23,208,247,123,0,36,33,1,113,24,141,123,16,35,43,64,16,43,11,208,141,121,19,28,43,64,205,121,157,66,8,216,4,211,13,121,16,28,232,64,0,240,5,248,1,52,188,66,233,211,255,188,0,189,252,181,143,123,2,38,62,64,2,46,2,209,192,26,0,4,0,12,8,38,62,64,8,46,10,209,78,121,176,66,0,216,6,224,16,49,143,123,16,38,62,64,16,46,0,208,37,224,74,137,1,38,62,64,1,46,1,208,16,64,5,224,18,180,17,28,23,76,0,240,40,248,18,188,138,137,12,104,13,137,2,38,62,64,2,46,15,209,11,137,91,1,74,137,16,64,128,0,0,25,0,104,138,137,18,1,14,73,201,24,11,223,13,73,201,24,11,223,1,224,0,240,2,248,252,189,192,70,55,181,128,0,0,25,0,104,8,73,109,1,73,25,82,1,7,76,0,240,1,248,55,189,32,71,0,0,252,109,3,2,245,70,30,8,20,123,3,2,0,0,0,5,0,0,0,6,25,255,6,8,255,255,255,255,255,255,255,255,228,184,58,8,3,0,7,0,208,1,7,0,18,0,0,3,196,166,58,8,4,0,15,1,160,1,7,0,48,0,0,3,208,118,58,8,4,0,15,2,252,1,5,0,4,0,1,3,36,190,58,8,4,0,12,0,232,2,5,0,8,0,1,1,56,200,58,8,1,0,1,0,112,3,1,0,7,0,0,1,192,201,58,8,4,0,15,0,227,2,3,0,4,0,0,1,88,194,58,8,4,0,10,0,208,3,3,0,8,0,0,1,104,198,58,8,4,0,15,0,128,3,3,0,8,0,0,1],this.tileAnimationAssemblyScriptBPEE=[255,181,18,136,71,72,0,104,0,105,0,40,26,208,70,105,0,46,23,208,247,123,0,36,33,1,113,24,141,123,16,35,43,64,16,43,11,208,141,121,19,28,43,64,205,121,157,66,8,216,4,211,13,121,16,28,232,64,0,240,37,248,1,52,188,66,233,211,55,72,0,104,64,105,0,40,26,208,70,105,0,46,23,208,247,123,0,36,33,1,113,24,141,123,16,35,43,64,16,43,11,208,141,121,19,28,43,64,205,121,157,66,8,216,4,211,13,121,16,28,232,64,0,240,5,248,1,52,188,66,233,211,255,188,0,189,252,181,143,123,2,38,62,64,2,46,2,209,192,26,0,4,0,12,8,38,62,64,8,46,10,209,78,121,176,66,0,216,6,224,16,49,143,123,16,38,62,64,16,46,0,208,37,224,74,137,1,38,62,64,1,46,1,208,16,64,5,224,18,180,17,28,23,76,0,240,40,248,18,188,138,137,12,104,13,137,2,38,62,64,2,46,15,209,11,137,91,1,74,137,16,64,128,0,0,25,0,104,138,137,18,1,14,73,201,24,11,223,13,73,201,24,11,223,1,224,0,240,2,248,252,189,192,70,55,181,128,0,0,25,0,104,8,73,109,1,73,25,82,1,7,76,0,240,1,248,55,189,32,71,0,0,24,115,3,2,225,123,46,8,20,123,3,2,0,0,0,5,0,0,0,6,129,9,10,8,0,0,0,0,100,7,81,8,4,0,15,0,252,1,3,0,4,0,0,5,116,37,81,8,4,0,15,1,176,1,7,0,30,0,0,5,84,46,81,8,4,0,15,2,208,1,7,0,10,0,0,5,116,49,81,8,4,0,15,3,240,1,3,0,6,0,0,5,132,54,81,8,4,0,15,4,224,1,3,0,10,0,0,5,36,88,81,8,3,0,7,0,128,2,7,0,4,0,4,9,100,89,81,8,3,0,7,0,192,3,1,0,4,0,0,9,36,88,81,8,3,0,7,1,132,2,7,0,4,0,4,9,36,88,81,8,3,0,7,2,136,2,7,0,4,0,4,9,36,88,81,8,3,0,7,3,140,2,7,0,4,0,4,9,36,88,81,8,3,0,7,4,144,2,7,0,4,0,4,9,36,88,81,8,3,0,7,5,148,2,7,0,4,0,4,9,36,88,81,8,3,0,7,6,152,2,7,0,4,0,4,9,36,88,81,8,3,0,7,7,156,2,7,0,4,0,4,9,252,100,81,8,3,0,7,0,170,2,3,0,6,0,0,1,44,109,81,8,4,0,15,0,224,2,3,0,4,0,0,1,132,83,81,8,3,11,7,0,96,2,12,0,4,0,13,32,228,83,81,8,3,11,7,0,96,2,3,0,4,0,16,32,180,83,81,8,3,11,7,0,128,2,12,0,4,0,13,32,244,83,81,8,3,11,7,0,128,2,3,0,4,0,16,32,132,83,81,8,3,11,7,1,100,2,12,0,4,0,13,32,228,83,81,8,3,11,7,1,100,2,3,0,4,0,16,32,180,83,81,8,3,11,7,1,132,2,12,0,4,0,13,32,244,83,81,8,3,11,7,1,132,2,3,0,4,0,16,32,132,83,81,8,3,11,7,2,104,2,12,0,4,0,13,32,228,83,81,8,3,11,7,2,104,2,3,0,4,0,16,32,180,83,81,8,3,11,7,2,136,2,12,0,4,0,13,32,244,83,81,8,3,11,7,2,136,2,3,0,4,0,16,32,132,83,81,8,3,11,7,3,108,2,12,0,4,0,13,32,228,83,81,8,3,11,7,3,108,2,3,0,4,0,16,32,180,83,81,8,3,11,7,3,140,2,12,0,4,0,13,32,244,83,81,8,3,11,7,3,140,2,3,0,4,0,16,32,132,83,81,8,3,11,7,4,112,2,12,0,4,0,13,32,228,83,81,8,3,11,7,4,112,2,3,0,4,0,16,32,180,83,81,8,3,11,7,4,144,2,12,0,4,0,13,32,244,83,81,8,3,11,7,4,144,2,3,0,4,0,16,32,132,83,81,8,3,11,7,5,116,2,12,0,4,0,13,32,228,83,81,8,3,11,7,5,116,2,3,0,4,0,16,32,180,83,81,8,3,11,7,5,148,2,12,0,4,0,13,32,244,83,81,8,3,11,7,5,148,2,3,0,4,0,16,32,132,83,81,8,3,11,7,6,120,2,12,0,4,0,13,32,228,83,81,8,3,11,7,6,120,2,3,0,4,0,16,32,180,83,81,8,3,11,7,6,152,2,12,0,4,0,13,32,244,83,81,8,3,11,7,6,152,2,3,0,4,0,16,32,132,83,81,8,3,11,7,7,124,2,12,0,4,0,13,32,228,83,81,8,3,11,7,7,124,2,3,0,4,0,16,32,180,83,81,8,3,11,7,7,156,2,12,0,4,0,13,32,244,83,81,8,3,11,7,7,156,2,3,0,4,0,16,32,148,56,81,8,4,0,15,0,32,3,3,0,4,0,0,3,140,93,81,8,4,0,15,1,160,2,3,0,4,0,0,3,148,56,81,8,4,0,15,2,36,3,3,0,4,0,4,3,220,97,81,8,3,0,7,0,224,2,7,0,4,0,4,8,220,97,81,8,3,0,7,1,228,2,7,0,4,0,4,8,220,97,81,8,3,0,7,2,232,2,7,0,4,0,4,8,220,97,81,8,3,0,7,3,236,2,7,0,4,0,4,8,220,97,81,8,3,0,7,4,240,2,7,0,4,0,4,8,220,97,81,8,3,0,7,5,244,2,7,0,4,0,4,8,220,97,81,8,3,0,7,6,248,2,7,0,4,0,4,8,220,97,81,8,3,0,7,7,252,2,7,0,4,0,4,8,228,67,81,8,4,0,15,0,208,3,3,0,30,0,0,2,4,78,81,8,4,0,15,1,240,3,7,0,8,0,0,2,196,2,82,8,4,0,15,0,240,2,7,0,96,0,0,1,12,104,81,8,3,0,7,0,218,2,3,0,6,0,0,1,28,107,81,8,3,0,7,0,218,2,3,0,6,0,0,1,60,110,81,8,3,0,7,0,240,1,1,0,4,0,0,1,140,93,81,8,4,0,15,1,160,3,3,0,4,0,0,1,156,130,81,8,2,0,3,0,240,3,1,0,9,0,0,1,244,69,81,8,4,0,15,0,240,3,3,0,4,0,0,1,68,122,81,8,3,0,7,0,240,3,3,0,12,0,1,2,80,122,81,8,3,0,7,0,208,3,3,0,20,0,1,2,52,128,81,8,1,0,1,0,144,2,1,0,16,0,0,1,12,124,81,8,6,0,63,1,224,3,1,0,4,0,0,2,252,123,81,8,3,0,7,1,248,3,3,0,1,0,0,2,89,22,10,8,2,0,3,0,8,0,3,0,1,0,2,1,100,72,82,8,3,0,7,0,151,2,3,0,8,0,1,2,112,72,82,8,3,0,7,0,135,2,3,0,8,0,1,2]}applyTileAnimationAssembly(t){if("BPRE"==this.gbaService.header.gameCode&&0==this.gbaService.header.version){if(this.gbaService.goTo(458752),this.gbaService.getInt()!==this.gbaService.constants().MAP_TILESET_ANIMATION_FLAG)return;this.gbaService.goTo(458700),this.gbaService.writeBytes(this.tileAnimationReplacementScript,!0),this.gbaService.writePointer(t,!0),this.gbaService.writeBytes(this.tileAnimationReplacementScriptFiller,!0),this.gbaService.goTo(458830),this.gbaService.writeInt(0,!0),this.gbaService.goTo(458890),this.gbaService.writeInt(0,!0),this.gbaService.goTo(t),this.gbaService.writeBytes(this.tileAnimationAssemblyScriptBPRE0,!0);let a=t+1;this.gbaService.goTo(458752),this.gbaService.writePointer(a,!0),this.gbaService.goTo(2968228),this.gbaService.writePointer(t+324,!0),this.gbaService.goTo(2968396),this.gbaService.writePointer(t+372,!0),this.gbaService.goTo(2968900),this.gbaService.writePointer(t+388,!0),this.gbaService.goTo(2968924),this.gbaService.writePointer(t+404,!0),this.gbaService.goTo(2969308),this.gbaService.writePointer(t+420,!0),this.gbaService.goTo(2969596),this.gbaService.writePointer(t+436,!0)}else if("BPRE"==this.gbaService.header.gameCode&&1==this.gbaService.header.version){if(this.gbaService.goTo(458772),this.gbaService.getInt()!==this.gbaService.constants().MAP_TILESET_ANIMATION_FLAG)return void console.log("script already applied!");this.gbaService.goTo(458720),this.gbaService.writeBytes(this.tileAnimationReplacementScript,!0),this.gbaService.writePointer(t,!0),this.gbaService.writeBytes(this.tileAnimationReplacementScriptFiller,!0),this.gbaService.goTo(458850),this.gbaService.writeInt(0,!0),this.gbaService.goTo(458910),this.gbaService.writeInt(0,!0),this.gbaService.goTo(t),this.gbaService.writeBytes(this.tileAnimationAssemblyScriptBPRE1,!0);let a=t+1;this.gbaService.goTo(458772),this.gbaService.writePointer(a,!0),this.gbaService.goTo(2968340),this.gbaService.writePointer(t+324,!0),this.gbaService.goTo(2968508),this.gbaService.writePointer(t+372,!0),this.gbaService.goTo(2969012),this.gbaService.writePointer(t+388,!0),this.gbaService.goTo(2969036),this.gbaService.writePointer(t+404,!0),this.gbaService.goTo(2969420),this.gbaService.writePointer(t+420,!0),this.gbaService.goTo(2969708),this.gbaService.writePointer(t+436,!0)}else if("BPEE"==this.gbaService.header.gameCode){if(this.gbaService.goTo(658044),this.gbaService.getInt()!==this.gbaService.constants().MAP_TILESET_ANIMATION_FLAG)return void console.log("script already applied!");this.gbaService.goTo(657992),this.gbaService.writeBytes(this.tileAnimationReplacementScript,!0),this.gbaService.writePointer(t,!0),this.gbaService.writeBytes(this.tileAnimationReplacementScriptFiller,!0),this.gbaService.goTo(658122),this.gbaService.writeInt(0,!0),this.gbaService.goTo(658182),this.gbaService.writeInt(0,!0),this.gbaService.goTo(t),this.gbaService.writeBytes(this.tileAnimationAssemblyScriptBPEE,!0);let a=t+1;this.gbaService.goTo(658044),this.gbaService.writePointer(a,!0),this.gbaService.goTo(4060952),this.gbaService.writePointer(t+319+1,!0),this.gbaService.goTo(4060976),this.gbaService.writeInt(0,!0),this.gbaService.goTo(4061e3),this.gbaService.writePointer(t+399+1,!0),this.gbaService.goTo(4061024),this.gbaService.writePointer(t+543+1,!0),this.gbaService.goTo(4061048),this.gbaService.writePointer(t+559+1,!0),this.gbaService.goTo(4061072),this.gbaService.writePointer(t+575+1,!0),this.gbaService.goTo(4061096),this.gbaService.writePointer(t+1087+1,!0),this.gbaService.goTo(4061120),this.gbaService.writeInt(0,!0),this.gbaService.goTo(4061144),this.gbaService.writeInt(0,!0),this.gbaService.goTo(4061168),this.gbaService.writeInt(0,!0),this.gbaService.goTo(4061192),this.gbaService.writeInt(0,!0),this.gbaService.goTo(4061216),this.gbaService.writePointer(t+1135+1,!0),this.gbaService.goTo(4061240),this.gbaService.writePointer(t+1263+1,!0),this.gbaService.goTo(4061264),this.gbaService.writePointer(t+1295+1,!0),this.gbaService.goTo(4061288),this.gbaService.writePointer(t+1311+1,!0),this.gbaService.goTo(4061312),this.gbaService.writePointer(t+1327+1,!0),this.gbaService.goTo(4061336),this.gbaService.writePointer(t+1343+1,!0),this.gbaService.goTo(4061408),this.gbaService.writePointer(t+1359+1,!0),this.gbaService.goTo(4061672),this.gbaService.writePointer(t+1375+1,!0),this.gbaService.goTo(4062008),this.gbaService.writePointer(t+1391+1,!0),this.gbaService.goTo(4062056),this.gbaService.writePointer(t+1407+1,!0),this.gbaService.goTo(4062176),this.gbaService.writePointer(t+1439+1,!0),this.gbaService.goTo(4062352),this.gbaService.writePointer(t+1455+1,!0),this.gbaService.goTo(4062424),this.gbaService.writePointer(t+1487+1,!0),this.gbaService.goTo(4062520),this.gbaService.writePointer(t+1503+1,!0)}}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(w.VP))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var he=v(3580);let E=(()=>{class i{constructor(t,n,o,a){this.gbaService=t,this.bitmapService=n,this.assemblyService=o,this.overworldService=a,this.mapNames=[],this.maps=[],this.isLoaded=!1,this.monsterEncounterCache=new Map,this.overlays=[],this.overlayBaseOAMs=[]}getDoorset(t,n){this.gbaService.goTo(this.gbaService.constants().MAP_DOORS_ADDRESS+12*t);let o=new Kt;o.blockId=this.gbaService.getShort(),o.doorType=this.gbaService.getShort();let a=this.gbaService.getPointer();o.paletteIdAddress=this.gbaService.getPointer(),this.gbaService.goTo(o.paletteIdAddress),o.paletteId=this.gbaService.getByte();for(let s=0;s<3;s++){this.gbaService.goTo(a+s*this.gbaService.constants().MAP_DOOR_PIXEL_LENGTH),o.blockPixelData.push(this.gbaService.getBytes(this.gbaService.constants().MAP_DOOR_PIXEL_LENGTH));let c=new y.dg(void 0,y.eT.BPP_4,o.blockPixelData[s],this.bitmapService,this.gbaService);o.blocks.push(this.bitmapService.createBitmap(c,n[o.paletteId],16,void 0,!0))}return o}getDoorsetByBlockId(t,n){for(let o=0;o<n.length;o++)if(n[o].blockId==t)return n[o]}getAllDoorsets(t){let n=[];for(let o=0;o<32;o++){let a=this.getDoorset(o,t);n.push(a)}return n}loadOverlayBaseOAMs(){let t=this.gbaService.constants().FIELD_OVERLAY_BASE_OAM_ADDRESS;this.gbaService.header.gameCode.startsWith("BPRE")?(this.overlayBaseOAMs.push({address:t,width:8,height:8}),this.overlayBaseOAMs.push({address:t+8,width:16,height:8}),this.overlayBaseOAMs.push({address:t+16,width:16,height:16}),this.overlayBaseOAMs.push({address:t+32,width:32,height:8}),this.overlayBaseOAMs.push({address:t+40,width:64,height:32}),this.overlayBaseOAMs.push({address:t+48,width:16,height:32}),this.overlayBaseOAMs.push({address:t+56,width:32,height:32}),this.overlayBaseOAMs.push({address:t+64,width:64,height:64})):this.gbaService.header.gameCode.startsWith("BPEE")&&(this.overlayBaseOAMs.push({address:5281004,width:8,height:8}),this.overlayBaseOAMs.push({address:5281012,width:16,height:8}),this.overlayBaseOAMs.push({address:5281020,width:16,height:16}),this.overlayBaseOAMs.push({address:5281028,width:32,height:8}),this.overlayBaseOAMs.push({address:5281036,width:64,height:32}),this.overlayBaseOAMs.push({address:5281044,width:16,height:32}),this.overlayBaseOAMs.push({address:5281052,width:32,height:32}),this.overlayBaseOAMs.push({address:3065488,width:64,height:64}))}getBaseOAM(t){for(let n=0;n<this.overlayBaseOAMs.length;n++)if(this.overlayBaseOAMs[n].address==t)return this.overlayBaseOAMs[n];return{address:void 0,width:16,height:16}}loadWildMonsterCache(){this.gbaService.goTo(this.gbaService.constants().MAP_ENCOUNTER_TABLE);let t=this.gbaService.getPointer(),n=0;for(;n<255;){let o=new on;if(o.load(this.gbaService,t+20*n),3==o.encounterBankId&&19==o.encounterMapId&&console.log(o),255==o.encounterBankId&&255==o.encounterMapId)break;this.monsterEncounterCache.set(o.encounterBankId+"."+o.encounterMapId,o),n++}}isBlockAnimated(t){for(let n=0;n<t.tiles.length;n++)if(t.tiles[n].bitmap.bitmapFrames.length>1)return!0;return!1}drawBlock(t,n,o,a,s,c){if(n.tiles&&n.tiles.length>0){let l=0,p=8;void 0!==c&&(0==c?p=4:1==c&&(l=4),(this.gbaService.header.gameCode.startsWith("BPEE")&&16==n.backgroundId||this.gbaService.header.gameCode.startsWith("BPRE")&&(32==n.backgroundId||33==n.backgroundId))&&(p=0==c?8:0));for(let d=l;d<p;d++){let h=n.tiles[d];if(!s||h.bitmap.bitmapFrames.length>1){let x=0,u=0;switch(d){case 0:case 4:x=0,u=0;break;case 1:case 5:x=8,u=0;break;case 2:case 6:x=0,u=8;break;case 3:case 7:x=8,u=8}t.drawImage(h.bitmap.currentFrame,o+x,a+u)}}}}getMap(t,n){this.isLoaded=!1;let o=this.maps[t][n];o.encounterData||(o.encounterData=this.monsterEncounterCache.get(t+"."+n)),this.gbaService.goTo(o.header.mapDataAddress);let a=new Wt;a.load(this.gbaService),o.layout=a,this.gbaService.goTo(o.layout.primaryTilesetAddress);let s=new Ne;s.load(this.gbaService,this.bitmapService),s.index=Math.floor((o.layout.primaryTilesetAddress-this.gbaService.constants().MAP_TILESET_BASE)/24),o.layout.primaryTileset=s,this.gbaService.goTo(o.layout.secondaryTilesetAddress);let c=new Ne;c.load(this.gbaService,this.bitmapService),c.index=Math.floor((o.layout.secondaryTilesetAddress-this.gbaService.constants().MAP_TILESET_BASE)/24),o.layout.secondaryTileset=c,this.gbaService.goTo(o.layout.tileDataAddress),o.blockData=new jt(o.layout.tileDataAddress,o.layout.mapWidth,o.layout.mapHeight,this.gbaService),o.blockset=new Ht(s,c,this.bitmapService,this.gbaService);let l=0;for(let d=0;d<o.layout.mapHeight;d++){o.blockData.bottomBlocks.push([]),o.blockData.topBlocks.push([]);for(let h=0;h<o.layout.mapWidth;h++)o.blockData.bottomBlocks[d].push(o.blockset.getBlock(o.blockData.blockIds[l],this.gbaService,this.bitmapService)),o.blockData.topBlocks[d].push(o.blockset.getBlock(o.blockData.blockIds[l],this.gbaService,this.bitmapService)),l++}this.gbaService.goTo(o.header.eventDataAddress);let p=new Yt(this.gbaService);p.npcCount=this.gbaService.getByte(),p.warpCount=this.gbaService.getByte(),p.scriptCount=this.gbaService.getByte(),p.signCount=this.gbaService.getByte(),p.npcAddress=this.gbaService.getPointer(),p.warpAddress=this.gbaService.getPointer(),p.scriptAddress=this.gbaService.getPointer(),p.signAddress=this.gbaService.getPointer(),p.loadEntities();for(let d=0;d<p.npcCount;d++){let h=0,x=!1;switch(p.npcs[d].movementType){case 7:h=1;break;case 8:case 11:h=0;break;case 9:h=2;break;case 10:h=2,x=!0}let u=this.overworldService.getOverworldSprite(255&p.npcs[d].spriteId,h);if(u){let m=document.createElement("canvas");m.width=u.width,m.height=u.height;let f=m.getContext("2d");x&&u.width<=32?(f.save(),f.translate(m.width,0),f.scale(-1,1),f.drawImage(u,0,0),f.restore()):(f.save(),f.drawImage(u,0,0),f.restore()),p.npcs[d].overworldSprite=m}}return o.entityData=p,this.isLoaded=!0,o}loadBlockCache(t){return(0,ie.mG)(this,void 0,void 0,function*(){for(let n=0;n<861;n++)t.blockset.getBlock(n,this.gbaService,this.bitmapService)})}loadWorld(){if(this.gbaService.constants()){this.assemblyService.applyTileAnimationAssembly(this.gbaService.findFreeSpaceAddresses(1548,1)[0]),this.loadOverlayBaseOAMs(),this.loadFieldOverlays(),this.loadWildMonsterCache();let t=this.gbaService.constants().MAP_NAMES_ADDRESS,n=this.gbaService.constants().MAP_NAMES_COUNT;this.gbaService.goTo(t),this.mapNames=this.gbaService.getGameStringAutoList(n);let o=this.gbaService.constants().MAP_BANK_ADDRESS,a=this.gbaService.constants().MAP_BANK_COUNT,s=this.gbaService.constants().MAP_BANK_SIZES;for(let c=0;c<a;c++){this.gbaService.goTo(o+4*c);let l=this.gbaService.getPointer();this.maps.push([]);for(let p=0;p<s[c];p++){this.gbaService.goTo(l+4*p);let d=this.gbaService.getPointer();this.gbaService.goTo(d);let h=new Oe;h.bankId=c,h.mapId=p;let x=new Qt;x.address=this.gbaService.position,x.data=this.gbaService.getBytes(28),this.gbaService.goTo(x.address),x.mapDataAddress=this.gbaService.getPointer(),x.eventDataAddress=this.gbaService.getPointer(),x.mapScriptsAddress=this.gbaService.getPointer(),x.connectionsAddress=this.gbaService.getPointer(),x.musicId=this.gbaService.getShort(),x.mapIndex=this.gbaService.getShort(),x.labelIndex=this.gbaService.getByte(),x.visibilityType=this.gbaService.getByte(),x.weatherType=this.gbaService.getByte(),x.mapType=this.gbaService.getByte(),this.gbaService.skip(2),x.shouldShowLabelOnEntry=this.gbaService.getByte(),x.battlefieldType=this.gbaService.getByte(),h.header=x,h.label=this.mapNames[x.labelIndex+this.gbaService.constants().MAP_NAME_OFFSET],this.maps[c].push(h)}}}this.gbaService.markToolLoaded()}loadFieldOverlays(){let t=this.gbaService.constants().FIELD_OVERLAY_META,n=this.gbaService.constants().FIELD_OVERLAY_PALETTES;for(let o=0;o<t.length;o++){let a=t[o];this.overlays.push(this.loadFieldOverlay(a.label,a.index,n,a.paletteOverrideId))}}loadFieldOverlay(t,n,o,a){let s=new tn;this.gbaService.goTo(this.gbaService.constants().FIELD_OVERLAY_HEADER_ADDRESS+4*n);let c=this.gbaService.getPointer();this.gbaService.goTo(c),s.address=c,s.title=t,s.index=n,s.tilesTag=this.gbaService.getShort(),s.paletteTag=this.gbaService.getShort(),s.baseOamAddress=this.gbaService.getPointer(),s.animationTableAddress=this.gbaService.getPointer(),s.framesTableAddress=this.gbaService.getPointer(),this.gbaService.skip(4),s.oamc=this.gbaService.getPointer(),this.gbaService.goTo(s.framesTableAddress),s.imageAddress=this.gbaService.getPointer();let p,l=o[0].address;for(let d=0;d<o.length;d++)if(s.paletteTag==o[d].key){l=o[d].address;break}return this.overworldService.overworldPalettes[4]||this.overworldService.loadOverworldPalettes(),p=a?this.overworldService.overworldPalettes[a]:new y.qD(l,16,void 0,void 0,this.bitmapService,this.gbaService,s.paletteTag),s=this.loadOverlayFrames(s,p),s=this.loadOverlayAnimations(s,p),s}loadOverlayFrames(t,n){t.frameWidth=this.getBaseOAM(t.baseOamAddress).width,t.frameHeight=this.getBaseOAM(t.baseOamAddress).height,t.frameCount=0,t.animationCount=0;for(let o=0;o<32;o++){this.gbaService.goTo(t.animationTableAddress+4*o);let a=this.gbaService.getInt();if(!this.gbaService.isValidPointer(a))break;this.gbaService.goTo(this.gbaService.position-4);let s=this.gbaService.getPointer();for(let c=0;c<32&&(this.gbaService.goTo(s+4*c),65535!=this.gbaService.getShort());c++)t.frameCount++;t.animationCount++}for(let o=0;o<t.frameCount;o++){this.gbaService.goTo(t.framesTableAddress+8*o);let a=this.gbaService.getInt();if(!this.gbaService.isValidPointer(a))break;this.gbaService.goTo(this.gbaService.position-4);let s=this.gbaService.getPointer(),c=this.gbaService.getShort();this.gbaService.goTo(s);let l=this.gbaService.getBytes(c),p=new y.dg(void 0,y.eT.BPP_4,l,this.bitmapService,this.gbaService),d=this.bitmapService.createBitmapCanvas(p,n,t.frameWidth,t.frameHeight,!0);t.frames.push(d)}return t}loadOverlayAnimations(t,n){t.frameCount=0,t.animationCount=0;for(let o=0;o<32;o++){this.gbaService.goTo(t.animationTableAddress+4*o);let a=this.gbaService.getInt();if(!this.gbaService.isValidPointer(a))break;this.gbaService.goTo(this.gbaService.position-4);let s=this.gbaService.getPointer(),c=[];for(let p=0;p<32;p++){this.gbaService.goTo(s+4*p);let d=this.gbaService.getShort();if(65535==d||d>t.frames.length)break;c.push(t.frames[d])}let l=new y.GC(c,c[4==t.index||5==c[t.index]?1:0],300,!1,!1,4==t.index||5==c[t.index]?1:0);t.animations.push(l)}return t}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(w.VP),e.LFG(y.Lw),e.LFG(rn),e.LFG(he.mY))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var z=v(8099),A=v(508),S=v(7322),U=v(4107),g=v(3075),O=v(7423);function an(i,r){if(1&i&&e._UZ(0,"img",19),2&i){const t=e.oxw(2);e.Udp("width",t.blockset.width*t.zoom+"px")("height",t.blockset.height*t.zoom+"px")("z-index",15),e.Q6J("src",t.blockset.toDataURL(),e.LSH)}}const sn=function(i){return{"block-selected":i}};function ln(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw(2).selectBlock(a)}),e.qZA()}if(2&i){const t=r.index,n=e.oxw(2);e.Udp("left",16*t*n.zoom%(16*n.zoom*8)+"px")("top",16*n.floorValue(16*t*n.zoom/(16*n.zoom*8))*n.zoom+"px")("width",16*n.zoom+"px")("height",16*n.zoom+"px")("z-index",250),e.Q6J("ngClass",e.VKq(11,sn,t==n.selectedBlockId))}}const Le=function(){return[]};function cn(i,r){if(1&i&&(e.TgZ(0,"div",15)(1,"div",16),e.YNc(2,an,1,7,"img",17),e.qZA(),e.TgZ(3,"div",16),e.YNc(4,ln,1,13,"div",18),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.Udp("z-index",50),e.xp6(1),e.Q6J("ngIf",t.blockset),e.xp6(2),e.Q6J("ngForOf",e.DdM(4,Le).constructor(861))}}function pn(i,r){if(1&i&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&i){const t=r.index;e.Q6J("value",t),e.xp6(1),e.hij("Palette ",t,"")}}function dn(i,r){if(1&i&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",r.index),e.xp6(1),e.Oqu(t)}}function xn(i,r){if(1&i&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",r.index),e.xp6(1),e.Oqu(t)}}function hn(i,r){if(1&i&&e._UZ(0,"img",27),2&i){const t=e.oxw(2);e.Udp("min-width","32px")("max-width","32px")("z-index",20),e.Q6J("src",t.currentAnimation.currentFrame,e.LSH)}}function un(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).currentAnimation.stop()}),e._uU(1,"Stop"),e.qZA()}}function mn(i,r){if(1&i&&(e.TgZ(0,"div",22)(1,"p")(2,"b"),e._uU(3,"Door Animation"),e.qZA()(),e.TgZ(4,"div",23)(5,"div",24),e.YNc(6,hn,1,7,"img",25),e.YNc(7,un,2,0,"button",26),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngIf",t.currentAnimation.currentFrame),e.xp6(1),e.Q6J("ngIf",t.currentAnimation.isAnimating)}}let Je=(()=>{class i{constructor(t,n,o,a,s,c){this.dialog=t,this.data=n,this.gbaService=o,this.worldService=a,this.bitmapService=s,this.zone=c,this.currentTilesetPalette=0,this.behaviorNames=[],this.backgroundNames=[],this.zoom=2,this.allDoorsets=[],this.blockLayers=document.createElement("canvas"),this.blockLayersContext=this.blockLayers.getContext("2d"),this.blockLayers.width=32,this.blockLayers.height=16,this.buildBehaviorNames(),this.buildBackgroundNames(),this.currentMap=n.currentMap,this.blockset=n.blockset,this.allDoorsets=this.worldService.getAllDoorsets(this.currentMap.layout.primaryTileset.palettes),this.selectBlock(1)}ngOnInit(){}selectBlock(t){this.selectedBlockId=t,this.selectedBlock=this.currentMap.blockset.getBlock(this.selectedBlockId,this.gbaService,this.bitmapService),this.renderInterval&&clearInterval(this.renderInterval);let n=this.worldService.getDoorsetByBlockId(this.selectedBlockId,this.allDoorsets);n?(this.currentAnimation=new y.GC(n.blocks,n.blocks[0],225,!0,!1),this.currentAnimation.start(this.zone)):this.currentAnimation=void 0,this.renderInterval=setInterval(()=>{this.currentAnimation&&this.currentAnimation.doAnimation()},250)}close(){this.dialog.closeAll()}floorValue(t){return Math.floor(t)}buildBehaviorNames(){for(let t=0;t<256;t++){let n="???";switch(t){case 0:n="Normal";break;case 2:n="Grass animation";break;case 3:n="High grass animation";break;case 6:n="Sand foot prints (with sandheaps)";break;case 7:n="Animation micro grass";break;case 10:n="Only walking possible";break;case 13:n="Warp into pyramid. Floor 51";break;case 16:n="Reflection on water with waves trailing";break;case 19:n="Waterfall/with falling down";break;case 21:n="Jump with mach bike, splashing water";break;case 22:n="Reflection on water, splashing water, waves";break;case 23:n="Lasting water on feet";break;case 26:n="Reflection (Background byte=20)";break;case 27:case 116:case 117:case 118:case 119:n="Water on feet";break;case 28:n="Water on feet + arrow down";break;case 32:n="Slide like on ice";break;case 33:n="Foot prints";break;case 34:case 42:n="Diving animation bubbles";break;case 37:n="Sand foot prints";break;case 40:n="Hero halfway underwater";break;case 48:n="Person blocked on right";break;case 49:n="Person blocked on left";break;case 50:n="Person blocked upwards";break;case 51:n="Person blocked downwards";break;case 52:n="Person blocked up/down/right";break;case 53:n="Person blocked up/down/left";break;case 54:n="Person blocked down/right";break;case 55:n="Person blocked down/left";break;case 56:n="Person jumps right over block";break;case 57:n="Person jumps left over block";break;case 58:n="Person jumps up over block";break;case 59:n="Person jumps down over block";break;case 64:n="Hero walks right";break;case 65:n="Hero walks left";break;case 66:n="Hero walKs up";break;case 67:n="Hero walks down";break;case 68:n="Hero slides right";break;case 69:n="Hero slides left";break;case 70:n="Hero slides up";break;case 71:n="Hero slides down";break;case 72:n="Hero slides up/down/left/right";break;case 80:n="Hero runs right";break;case 81:n="Hero runs left";break;case 82:n="Hero runs up";break;case 83:n="Hero runs down";break;case 97:n="Use warp";break;case 98:n="Arrow right => warp left of block";break;case 99:n="Arrow left => warp right of block";break;case 100:n="Arrow up => warp above block";break;case 101:case 109:n="Arrow down => warp under block";break;case 102:n="Warp into last-visited building";break;case 103:n="Regular Warp";break;case 104:n="Drown in sand (warp)";break;case 105:n="Door Animation (if Block ID is in table)";break;case 106:n="Pok\ufffdCenter escalator up/use warp";break;case 107:n="Pok\ufffdCenter escalator down/use warp";break;case 108:n="Warp to emerge from water => Hero is surfing";break;case 110:n="Warp/person exits upwards";break;case 131:n="PC";break;case 132:n="Sign (FRLG)";break;case 131:n="Television";break;case 187:n="Hero jumps twice";break;case 188:n="Hero turns around and goes back into direction he came from";break;case 190:n="Person blocked left/right,";break;case 192:n="Person blocked up/down";break;case 193:n="Person blocked left/right";break;case 208:n="Slippery clay animation";break;case 209:n="Only passable with acro bike";break;case 211:case 212:case 213:case 214:n="Solid block";break;default:n="???"}this.behaviorNames.push(t+" - "+n)}}buildBackgroundNames(){for(let t=0;t<256;t++){let n="???";switch(t){case 0:n="Normal";break;case 16:"BPEE"==this.gbaService.header.gameCode&&(n="Overworlds Cover Block");break;case 32:this.gbaService.header.gameCode.startsWith("BPRE")&&(n="Overworlds Cover Block");break;default:n="???"}this.backgroundNames.push(t+" - "+n)}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.uw),e.Y36(Z.WI),e.Y36(w.VP),e.Y36(E),e.Y36(y.Lw),e.Y36(e.R0b))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-block-editor-dialog"]],decls:39,vars:11,consts:[[1,"w-100","py-3","poke-sheet-header","d-inline-flex","justify-content-between"],[1,"poke-sheet-header-title"],["matRipple","",1,"poke-sheet-header-icon","rounded","bg-gray","cursor-pointer",3,"click"],[1,"row"],[1,"col-sm-4"],[1,"my-3"],["class","map-sidenav blockset-display overflow-auto poke-tool-sub-sidenav-2x border-left",4,"ngIf"],["appearance","outline",1,"w-100"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-3","mb-0"],[1,"mb-3","text-gray"],["appearance","outline",1,"w-100","mt-4","mb-2"],["appearance","outline",1,"w-100","mb-2"],["class","w-100",4,"ngIf"],[1,"map-sidenav","blockset-display","overflow-auto","poke-tool-sub-sidenav-2x","border-left"],[1,"position-relative"],["class","d-block position-absolute",3,"src","width","height","zIndex",4,"ngIf"],["class","position-absolute block-hover","matRipple","",3,"left","top","width","height","zIndex","ngClass","click",4,"ngFor","ngForOf"],[1,"d-block","position-absolute",3,"src"],["matRipple","",1,"position-absolute","block-hover",3,"ngClass","click"],[3,"value"],[1,"w-100"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mb-4"],[1,"d-flex","flex-column","justify-content-center","align-items-center","p-2"],["width","32px","class","border d-block",3,"src","minWidth","maxWidth","zIndex",4,"ngIf"],["mat-button","","class","mt-2 bg-gray",3,"click",4,"ngIf"],["width","32px",1,"border","d-block",3,"src"],["mat-button","",1,"mt-2","bg-gray",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2,"Block Editor"),e.qZA(),e.TgZ(3,"mat-icon",2),e.NdJ("click",function(){return n.close()}),e._uU(4,"close"),e.qZA()(),e.TgZ(5,"div",3)(6,"div",4)(7,"h3",5)(8,"b"),e._uU(9,"Blockset"),e.qZA()(),e.YNc(10,cn,5,5,"div",6),e.qZA(),e.TgZ(11,"div",4)(12,"h3",5)(13,"b"),e._uU(14,"Tilesets"),e.qZA()(),e.TgZ(15,"mat-form-field",7)(16,"mat-label"),e._uU(17,"Tileset Palette"),e.qZA(),e.TgZ(18,"mat-select",8),e.NdJ("ngModelChange",function(a){return n.currentTilesetPalette=a}),e.YNc(19,pn,2,2,"mat-option",9),e.qZA()()(),e.TgZ(20,"div",4)(21,"h3",10)(22,"b"),e._uU(23,"Selected Block"),e.qZA()(),e.TgZ(24,"p",11)(25,"b"),e._uU(26,"BLOCK ID:"),e.qZA(),e._uU(27),e.qZA(),e.TgZ(28,"mat-form-field",12)(29,"mat-label"),e._uU(30,"Behavior"),e.qZA(),e.TgZ(31,"mat-select",8),e.NdJ("ngModelChange",function(a){return n.selectedBlock.behaviorId=a}),e.YNc(32,dn,2,2,"mat-option",9),e.qZA()(),e.TgZ(33,"mat-form-field",13)(34,"mat-label"),e._uU(35,"Background Type"),e.qZA(),e.TgZ(36,"mat-select",8),e.NdJ("ngModelChange",function(a){return n.selectedBlock.backgroundId=a}),e.YNc(37,xn,2,2,"mat-option",9),e.qZA()(),e.YNc(38,mn,8,2,"div",14),e.qZA()()),2&t&&(e.xp6(10),e.Q6J("ngIf",n.currentMap&&n.currentMap.blockset),e.xp6(8),e.Q6J("ngModel",n.currentTilesetPalette),e.xp6(1),e.Q6J("ngForOf",e.DdM(10,Le).constructor(16)),e.xp6(8),e.AsE(" ",n.selectedBlockId," | 0x",n.selectedBlockId.toString(16).toUpperCase(),""),e.xp6(4),e.Q6J("ngModel",n.selectedBlock.behaviorId),e.xp6(1),e.Q6J("ngForOf",n.behaviorNames),e.xp6(4),e.Q6J("ngModel",n.selectedBlock.backgroundId),e.xp6(1),e.Q6J("ngForOf",n.backgroundNames),e.xp6(1),e.Q6J("ngIf",105==n.selectedBlock.behaviorId&&n.currentAnimation))},directives:[z.Hw,A.wG,_.O5,_.sg,_.mk,S.KE,S.hX,U.gD,g.JJ,g.On,A.ey,O.lW],styles:[""]}),i})();var ue=v(4015),re=v(7531);function gn(i,r){if(1&i&&(e.TgZ(0,"div",19),e._UZ(1,"img",20),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Udp("min-width","32px")("max-width","32px")("z-index",20),e.Q6J("src",t,e.LSH)}}function _n(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",15),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().setCurrent(a)}),e.TgZ(2,"div",16)(3,"span",17),e._uU(4),e.qZA(),e.YNc(5,gn,2,7,"div",18),e.qZA()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.oxw();e.xp6(1),e.Q6J("ngClass",o.currentDoorset==t?"poke-tool-sidenav-item-active":""),e.xp6(2),e.Udp("height","18px"),e.xp6(1),e.Oqu(o.getPaddedId(n)),e.xp6(1),e.Q6J("ngForOf",t.blocks)}}function fn(i,r){if(1&i&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&i){const n=r.index;e.Q6J("value",r.$implicit),e.xp6(1),e.hij("Door #",n+1,"")}}function vn(i,r){1&i&&(e.TgZ(0,"div",22)(1,"div",23)(2,"span",24),e._uU(3,"NO DOORS FOUND FOR THIS MAP'S TILESETS"),e.qZA()()())}function bn(i,r){if(1&i&&(e.TgZ(0,"div",23)(1,"span",24),e._uU(2),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.AsE("USES BOTH CURRENT MAP TILESET PALETTE LISTS. PRIMARY TILESET PALETTES 0-",t.gbaService.constants().MAIN_TILESET_PALETTE_COUNT-1,". SECONDARY TILESET PALETTES ",t.gbaService.constants().MAIN_TILESET_PALETTE_COUNT,"-15. NAVIGATE TO A DOOR'S MAP IN THE WORLD EDITOR TO VIEW WITH PROPER PALETTE.")}}function yn(i,r){if(1&i&&e._UZ(0,"img",32),2&i){const t=e.oxw(2);e.Udp("min-width","32px")("max-width","32px")("z-index",20),e.Q6J("src",t.currentAnimation.currentFrame,e.LSH)}}function Tn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).playAnimation()}),e._uU(1,"Play"),e.qZA()}}function Cn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).stopAnimation()}),e._uU(1,"Stop"),e.qZA()}}function wn(i,r){if(1&i&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&i){const t=r.index;e.Q6J("value",t),e.xp6(1),e.hij("Palette ",t,"")}}const Sn=function(){return[]};function Mn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",22),e.YNc(1,bn,3,2,"div",25),e.TgZ(2,"div",26)(3,"div",27),e.YNc(4,yn,1,7,"img",28),e.YNc(5,Tn,2,0,"button",29),e.YNc(6,Cn,2,0,"button",29),e.qZA()(),e.TgZ(7,"div",8)(8,"div",30)(9,"mat-form-field",10)(10,"mat-label"),e._uU(11,"Block ID"),e.qZA(),e.TgZ(12,"input",31),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentDoorset.blockId=o}),e.qZA(),e.TgZ(13,"mat-hint"),e._uU(14,"0-255"),e.qZA()()(),e.TgZ(15,"div",30)(16,"mat-form-field",10)(17,"mat-label"),e._uU(18,"Door Type"),e.qZA(),e.TgZ(19,"input",31),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentDoorset.doorType=o}),e.qZA(),e.TgZ(20,"mat-hint"),e._uU(21,"0-255"),e.qZA()()(),e.TgZ(22,"div",30)(23,"mat-form-field",10)(24,"mat-label"),e._uU(25,"Palette"),e.qZA(),e.TgZ(26,"mat-select",11),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentDoorset.paletteId=o}),e.YNc(27,wn,2,2,"mat-option",12),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.viewportService.isMedium),e.xp6(3),e.Q6J("ngIf",t.currentAnimation.currentFrame),e.xp6(1),e.Q6J("ngIf",!t.currentAnimation.isAnimating),e.xp6(1),e.Q6J("ngIf",t.currentAnimation.isAnimating),e.xp6(6),e.Q6J("ngModel",t.currentDoorset.blockId),e.xp6(7),e.Q6J("ngModel",t.currentDoorset.doorType),e.xp6(7),e.Q6J("ngModel",t.currentDoorset.paletteId),e.xp6(1),e.Q6J("ngForOf",e.DdM(8,Sn).constructor(16))}}let qe=(()=>{class i{constructor(t,n,o,a,s,c,l){this.dialog=t,this.data=n,this.gbaService=o,this.worldService=a,this.bitmapService=s,this.zone=c,this.viewportService=l,this.doorsets=[],this.mapDoorsets=[],this.currentMap=n.currentMap}ngOnInit(){this.doorsets=this.worldService.getAllDoorsets(this.currentMap.layout.primaryTileset.palettes);for(let t=0;t<861;t++)if(105==this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService).behaviorId)for(let o=0;o<this.doorsets.length;o++)if(this.doorsets[o].blockId==t){this.mapDoorsets.push(this.doorsets[o]);break}this.mapDoorsets.length>0&&this.setCurrent(this.mapDoorsets[0])}setCurrent(t){this.currentDoorset=t,this.currentAnimation=new y.GC(this.currentDoorset.blocks,this.currentDoorset.blocks[0],225,!0,!1),this.stopAnimation(),this.playAnimation()}close(){this.dialog.closeAll()}getPaddedId(t){let n=t.toString();for(;n.length<3;)n="0"+n;return n}playAnimation(){this.currentAnimation.start(this.zone),this.intervalRef=setInterval(()=>{this.currentAnimation.doAnimation()},250)}stopAnimation(){this.currentAnimation.stop(),this.intervalRef&&clearInterval(this.intervalRef)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.uw),e.Y36(Z.WI),e.Y36(w.VP),e.Y36(E),e.Y36(y.Lw),e.Y36(e.R0b),e.Y36(ue.v))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-door-editor-dialog"]],decls:19,vars:7,consts:[[1,"w-100","py-3","poke-sheet-header","d-inline-flex","justify-content-between"],[1,"poke-sheet-header-title"],["matRipple","",1,"poke-sheet-header-icon","rounded","bg-gray","cursor-pointer",3,"click"],[1,"w-100","d-inline-flex","poke-tool-card-inner","doorset-editor"],[1,"bg-gray","overflow-auto","tablet-or-bigger"],[1,"poke-tool-sidenav","bg-gray"],["class","poke-tool-sidenav-item noselect",4,"ngFor","ngForOf"],[1,"w-100","phone-only"],[1,"row"],[1,"col-12"],["appearance","outline",1,"w-100"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","w-100 pt-3 px-3",4,"ngIf"],[1,"poke-tool-sidenav-item","noselect"],["matRipple","",1,"poke-tool-sidenav-item-inner","py-1","border-bottom",3,"ngClass","click"],[1,"d-inline-flex","align-items-center"],[1,"poke-border-sm","bg-white","mx-2","py-0","px-2","d-inline-flex","align-items-center"],["class","d-block",4,"ngFor","ngForOf"],[1,"d-block"],["width","32px",1,"d-block",3,"src"],[3,"value"],[1,"w-100","pt-3","px-3"],[1,"w-100","d-inline-flex","justify-content-center","text-center","text-danger","mb-4"],[1,"p-2","border"],["class","w-100 d-inline-flex justify-content-center text-center text-danger mb-4",4,"ngIf"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mb-4"],[1,"d-flex","flex-column","justify-content-center","align-items-center","p-2"],["width","32px","class","border d-block",3,"src","minWidth","maxWidth","zIndex",4,"ngIf"],["mat-button","","class","mt-2 bg-gray",3,"click",4,"ngIf"],[1,"col-md-4"],["type","number","min","0","max","255","matInput","","placeholder","0",3,"ngModel","ngModelChange"],["width","32px",1,"border","d-block",3,"src"],["mat-button","",1,"mt-2","bg-gray",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2,"Door Editor"),e.qZA(),e.TgZ(3,"mat-icon",2),e.NdJ("click",function(){return n.close()}),e._uU(4,"close"),e.qZA()(),e.TgZ(5,"div",3)(6,"div",4)(7,"div",5),e.YNc(8,_n,6,5,"div",6),e.qZA()(),e.TgZ(9,"div",7)(10,"div",8)(11,"div",9)(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Selected Door Animation"),e.qZA(),e.TgZ(15,"mat-select",11),e.NdJ("ngModelChange",function(a){return n.currentDoorset=a})("ngModelChange",function(){return n.setCurrent(n.currentDoorset)}),e.YNc(16,fn,2,2,"mat-option",12),e.qZA()()()()(),e.YNc(17,vn,4,0,"div",13),e.YNc(18,Mn,28,9,"div",13),e.qZA()),2&t&&(e.xp6(6),e.Udp("min-width","230px"),e.xp6(2),e.Q6J("ngForOf",n.mapDoorsets),e.xp6(7),e.Q6J("ngModel",n.currentDoorset),e.xp6(1),e.Q6J("ngForOf",n.mapDoorsets),e.xp6(1),e.Q6J("ngIf",0==n.mapDoorsets.length),e.xp6(1),e.Q6J("ngIf",n.currentDoorset&&n.currentAnimation&&n.mapDoorsets.length>0))},directives:[z.Hw,A.wG,_.sg,_.mk,S.KE,S.hX,U.gD,g.JJ,g.On,A.ey,_.O5,O.lW,g.qQ,g.Fd,g.wV,re.Nt,g.Fj,S.bx],styles:[""]}),i})();var An=v(4834);function kn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().setCurrent(a)}),e.TgZ(2,"span",12),e._uU(3),e.qZA(),e.TgZ(4,"b"),e._uU(5),e.qZA()()()}if(2&i){const t=r.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngClass",n.currentOverlay==t?"poke-tool-sidenav-item-active":""),e.xp6(1),e.Udp("height","18px"),e.xp6(1),e.Oqu(n.getPaddedId(t.index)),e.xp6(2),e.Oqu(t.title)}}function Zn(i,r){if(1&i&&(e.TgZ(0,"mat-option",33),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.title)}}function En(i,r){if(1&i&&e._UZ(0,"img",34),2&i){const t=r.$implicit,n=e.oxw(2);e.Udp("width",n.currentOverlay.frameWidth*n.zoom+"px")("height",n.currentOverlay.frameHeight*n.zoom+"px")("z-index",15),e.Q6J("src",t.toDataURL(),e.LSH)}}function Un(i,r){if(1&i&&(e.TgZ(0,"mat-option",33),e._uU(1),e.qZA()),2&i){const t=r.index,n=e.oxw(2);e.Q6J("value",t),e.xp6(1),e.AsE("",n.currentOverlay.title," #",t+1,"")}}function Pn(i,r){if(1&i&&e._UZ(0,"img",35),2&i){const t=e.oxw(2);e.Udp("min-width",t.currentOverlay.frameWidth*t.zoom+"px")("max-width",t.currentOverlay.frameHeight*t.zoom+"px")("z-index",20),e.Q6J("src",t.currentAnimation.currentFrame.toDataURL(),e.LSH)}}function In(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).playAnimation()}),e._uU(1,"Play"),e.qZA()}}function Dn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).stopAnimation()}),e._uU(1,"Stop"),e.qZA()}}function Bn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16)(4,"mat-form-field",17)(5,"mat-label"),e._uU(6,"Selected Field Animation"),e.qZA(),e.TgZ(7,"mat-select",18),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentOverlay=o})("ngModelChange",function(){e.CHM(t);const o=e.oxw();return o.setCurrent(o.currentOverlay)}),e.YNc(8,Zn,2,2,"mat-option",19),e.qZA()()()()(),e.TgZ(9,"div",15)(10,"div",20)(11,"p",21)(12,"b"),e._uU(13,"Frames"),e.qZA()(),e.YNc(14,En,1,7,"img",22),e.qZA(),e.TgZ(15,"div",23)(16,"div",24)(17,"mat-form-field",17)(18,"mat-label"),e._uU(19),e.qZA(),e.TgZ(20,"mat-select",18),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentAnimationIndex=o})("ngModelChange",function(){return e.CHM(t),e.oxw().setCurrentAnimation()}),e.YNc(21,Un,2,3,"mat-option",19),e.qZA()(),e.TgZ(22,"div",25)(23,"div",26)(24,"div",27),e.YNc(25,Pn,1,7,"img",28),e.YNc(26,In,2,0,"button",29),e.YNc(27,Dn,2,0,"button",29),e.TgZ(28,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleLooping()}),e._uU(29),e.qZA()()()()()(),e.TgZ(30,"div",23)(31,"div",31)(32,"p")(33,"b"),e._uU(34,"Frame Width:"),e.qZA(),e._UZ(35,"br"),e._uU(36),e.qZA(),e.TgZ(37,"p")(38,"b"),e._uU(39,"Frame Height:"),e.qZA(),e._UZ(40,"br"),e._uU(41),e.qZA(),e._UZ(42,"mat-divider",32),e.TgZ(43,"p")(44,"b"),e._uU(45,"Header Address:"),e.qZA(),e._UZ(46,"br"),e._uU(47),e.qZA(),e.TgZ(48,"p")(49,"b"),e._uU(50,"OAM Address:"),e.qZA(),e._UZ(51,"br"),e._uU(52),e.qZA(),e.TgZ(53,"p")(54,"b"),e._uU(55,"Animation Address:"),e.qZA(),e._UZ(56,"br"),e._uU(57),e.qZA(),e.TgZ(58,"p")(59,"b"),e._uU(60,"Frames Address:"),e.qZA(),e._UZ(61,"br"),e._uU(62),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngModel",t.currentOverlay),e.xp6(1),e.Q6J("ngForOf",t.worldService.overlays),e.xp6(6),e.Q6J("ngForOf",t.currentOverlay.frames),e.xp6(5),e.AsE("Animation ",t.currentAnimationIndex+1," of ",t.currentOverlay.animations.length,""),e.xp6(1),e.Q6J("ngModel",t.currentAnimationIndex),e.xp6(1),e.Q6J("ngForOf",t.currentOverlay.animations),e.xp6(4),e.Q6J("ngIf",t.currentAnimation.currentFrame.toDataURL()),e.xp6(1),e.Q6J("ngIf",!t.currentAnimation.isAnimating),e.xp6(1),e.Q6J("ngIf",t.currentAnimation.isAnimating),e.xp6(2),e.Oqu(t.isLooping?"Loop":"No Loop"),e.xp6(7),e.hij("",t.currentOverlay.frameWidth," pixels"),e.xp6(5),e.hij("",t.currentOverlay.frameHeight," pixels"),e.xp6(6),e.hij("0x",t.currentOverlay.address.toString(16).toUpperCase(),""),e.xp6(5),e.hij("0x",t.currentOverlay.baseOamAddress.toString(16).toUpperCase(),""),e.xp6(5),e.hij("0x",t.currentOverlay.animationTableAddress.toString(16).toUpperCase(),""),e.xp6(5),e.hij("0x",t.currentOverlay.framesTableAddress.toString(16).toUpperCase(),"")}}let Fn=(()=>{class i{constructor(t,n,o,a,s,c){this.dialog=t,this.data=n,this.zone=o,this.gbaService=a,this.worldService=s,this.bitmapService=c,this.currentAnimationIndex=0,this.isShowingGrid=!1,this.zoom=2,this.isLooping=!1,this.currentMap=n.currentMap}ngOnInit(){this.setCurrent(this.worldService.overlays[0])}setCurrent(t){this.currentAnimationIndex=0,this.currentOverlay=t,this.setCurrentAnimation()}setCurrentAnimation(){this.stopAnimation(),this.currentAnimation=this.currentOverlay.animations[this.currentAnimationIndex],this.playAnimation()}close(){this.dialog.closeAll()}floorValue(t){return Math.floor(t)}getPaddedId(t){let n=t.toString();for(;n.length<3;)n="0"+n;return n}playAnimation(){this.currentAnimation&&(this.currentAnimation.isLooping=this.isLooping,this.currentAnimation.start(this.zone),this.intervalRef&&clearInterval(this.intervalRef),this.intervalRef=setInterval(()=>{this.currentAnimation.doAnimation()},200))}stopAnimation(){this.currentAnimation&&(this.currentAnimation.stop(),this.intervalRef&&clearInterval(this.intervalRef))}toggleLooping(){this.isLooping=!this.isLooping,this.currentAnimation.isAnimating&&(this.stopAnimation(),this.playAnimation())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.uw),e.Y36(Z.WI),e.Y36(e.R0b),e.Y36(w.VP),e.Y36(E),e.Y36(y.Lw))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-field-editor-dialog"]],decls:14,vars:6,consts:[[1,"w-100","py-3","poke-sheet-header","d-inline-flex","justify-content-between"],[1,"w-100","d-inline-flex","justify-content-between"],[1,"poke-sheet-header-title"],["matRipple","",1,"poke-sheet-header-icon","rounded","bg-gray","cursor-pointer",3,"click"],[1,"mb-0","mt-1","text-gray"],[1,"w-100","d-inline-flex","poke-tool-card-inner","doorset-editor"],[1,"bg-gray","overflow-auto","tablet-or-bigger"],[1,"poke-tool-sidenav","bg-gray"],["class","poke-tool-sidenav-item noselect",4,"ngFor","ngForOf"],["class","w-100 overflow-auto p-3",4,"ngIf"],[1,"poke-tool-sidenav-item","noselect"],["matRipple","",1,"poke-tool-sidenav-item-inner","px-3","py-2","border-bottom",3,"ngClass","click"],[1,"poke-border-sm","bg-white","mr-2","py-0","px-2","d-inline-flex","align-items-center"],[1,"w-100","overflow-auto","p-3"],[1,"w-100","phone-only"],[1,"row"],[1,"col-12"],["appearance","outline",1,"w-100"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4","mb-3"],[1,"mb-1"],["class","d-inline-block border",3,"src","width","height","zIndex",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"d-flex","flex-column","w-100"],[1,"w-100"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mb-4"],[1,"d-flex","flex-column","justify-content-center","align-items-center","p-2"],["width","32px","class","border d-block",3,"src","minWidth","maxWidth","zIndex",4,"ngIf"],["mat-button","","class","mt-2 bg-gray",3,"click",4,"ngIf"],["mat-button","",1,"mt-2","bg-gray",3,"click"],[1,"d-flex","flex-column","border","w-100","poke-border-sm","p-3","float-right"],[1,"mb-3"],[3,"value"],[1,"d-inline-block","border",3,"src"],["width","32px",1,"border","d-block",3,"src"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div")(2,"div",1)(3,"span",2),e._uU(4,"Field Editor"),e.qZA(),e.TgZ(5,"mat-icon",3),e.NdJ("click",function(){return n.close()}),e._uU(6,"close"),e.qZA()(),e.TgZ(7,"p",4),e._uU(8,"These frames are not editable within this tool (for now). However, you may find the previews and addresses useful. Some frames may act strange because the ROM manages them with ASM/C. This is the base data before the ROM runtime manipulation."),e.qZA()()(),e.TgZ(9,"div",5)(10,"div",6)(11,"div",7),e.YNc(12,kn,6,5,"div",8),e.qZA()(),e.YNc(13,Bn,63,17,"div",9),e.qZA()),2&t&&(e.xp6(10),e.Udp("min-width","230px")("max-width","230px"),e.xp6(2),e.Q6J("ngForOf",n.worldService.overlays),e.xp6(1),e.Q6J("ngIf",n.currentOverlay))},directives:[z.Hw,A.wG,_.sg,_.mk,_.O5,S.KE,S.hX,U.gD,g.JJ,g.On,A.ey,O.lW,An.d],styles:[""]}),i})();class On{constructor(){this.commands=new Map,this.commandTemplates=new Map,this.messageTypes=new Map,this.movementTypes=new Map,this.loadCommandTemplates()}loadCommandTemplates(){let r=[["","nop","0","Does nothing at all.","1","0"],["3","nop1","1","Does nothing at all.","5","1"],["","end","2","Terminates execution of the script","1","0"],["","return","3","Pops back to the last calling command used","1","0"],["3","call","4","Continues script execution from another point. Can be returned to.","5","1"],["3","goto","5","Continues script execution from another point.","5","1"],["13","if1","6","In the last comparison returned a value, jumps to another script","6","2"],["13","if2","7","Calling version of if command","6","2"],["1","gotostd","8","Jumps to a built-in function","2","1"],["1","callstd","9","Calls a built-in function","2","1"],["11","gotostdif","10","Jumps to a built-in function, conditional","3","2"],["11","callstdif","11","Jump to a built-in function, conditional","3","2"],["","jumpram","12","Jumps to a default RAM location, executing the script stored there.","1","0"],["","killscript","13","Kills the script and resets the script RAM.","1","0"],["1","setbyte","14","Sets a predefined address to the specified byte value.","2","1"],["13","loadpointer","15","Loads a pointer into the script RAM so other commands can use it.","6","2"],["11","setbyte2","16","Sets a memory bank to the specified byte.","3","2"],["13","writebytetooffset","17","Sets the byte at the specified offset to a certain value.","6","2"],["13","loadbytefrompointer","18","Loads the byte found at the pointer into the script RAM so other commands can use it.","6","2"],["13","setfarbyte","19","Sets the byte into a specified pointer.","6","2"],["11","copyscriptbanks","20","Copies one script bank to another.","3","2"],["33","copybyte","21","Copies a byte value from one place to another.","9","2"],["22","setvar","22","Sets variable A to any value.","5","2"],["22","addvar","23","Adds any value to variable A.","5","2"],["22","subvar","24","Subtracts any value from variable A.","5","2"],["22","copyvar","25","Copies variable B to A.","5","2"],["22","copyvarifnotzero","26","Sets variable B to A, but only if B is higher than zero.","5","2"],["22","comparebanks","27","Compares two banks.","5","2"],["11","comparebanktobyte","28","Compares a variable stored in a buffer to a byte value.","3","2"],["13","comparebanktofarbyte","29","Compares a bank with a byte at some location","6","2"],["31","comparefarbytetobank","30","Compares a byte at some location to a buffered variable. The reverse of comparebanktofatbyte","6","2"],["31","comparefarbytetobyte","31","Compares a byte at some location to a byte value.","6","2"],["33","comparefarbytes","32","Compares a byte at some location to a byte at another location","9","2"],["22","compare","33","Compares variable A to a value","5","2"],["22","comparevars","34","Compares two variables","5","2"],["3","callasm","35","Calls a custom ASM routine","5","1"],["3","cmd24","36","Unknown Command","5","1"],["2","special","37","Calls a special event (ASM)","3","1"],["22","special2","38","Calls a special event and returns a value (ASM)","5","2"],["","waitstate","39","Sets the script to a wait state, useful for some specials and commands.","1","0"],["2","pause","40","Pauses script execution for a short amount of time.","3","1"],["2","setflag","41","Sets a flag for later use.","3","1"],["2","clearflag","42","Clears the value of a flag.","3","1"],["2","checkflag","43","Checks the value of a flag.","3","1"],["22","cmd2c","44","Unknown Command","5","2"],["","checkdailyflags","45","Checks the daily flags to see if any of them have been set already, but only if they were set previously. Then it clears those flags. R/S/E only.","1","0"],["","resetvars","46","Resets the value of variables 0x8000, 0x8001, and 0x8002.","1","0"],["2","sound","47","Plays a sound.","3","1"],["","checksound","48","Checks if a sound/fanfare/song is currently being played.","1","0"],["2","fanfare","49","Plays a Sappy song as a fanfare.","3","1"],["","waitfanfare","50","Waits for a fanfare to finish.","1","0"],["21","playsong","51","Switches to another Sappy song.","4","2"],["2","playsong2","52","Switches to another Sappy song","3","1"],["","fadedefault","53","Gently fades the current music back to the map's default song.","1","0"],["2","fadesong","54","Gently fades into another Sappy song.","3","1"],["1","fadeout","55","Fades you the currently playing Sappy song.","2","1"],["1","fadein","56","Fades the currently playing Sappy song back in.","2","1"],["11122","warp","57","Warps the player to another map.","8","5"],["11122","warpmuted","58","Warps the player to another map. No sound effect","8","5"],["11122","warpwalk","59","Warps the player to another map. Walking effect.","8","5"],["11","warphole","60","Warps the player to another map. Hole effect.","3","2"],["11122","warpteleport","61","Warps the player to another map. Teleport effect","8","5"],["11122","warp3","62","Warps the player to another map.","8","5"],["11122","setwarpplace","63","Sets the place a warp that lead to warp 127 of map 127. 127 warps the player. (It's confusing...)","8","5"],["11122","warp4","64","Warps the player to another map.","8","5"],["11122","warp5","65","Warps the player to another map.","8","5"],["22","getplayerpos","66","Gets current position of the player on the map and stores it on specified variables.","5","2"],["","countpokemon","67","Counts the number of Pokemon in your party and stores the result in LASTRESULT","1","0"],["22","additem","68","Adds the quantity of the specified item.","5","2"],["22","removeitem","69","Removes the quantity of the specified item.","5","2"],["22","checkitemroom","70","Checks to see if the player has enough room in the bag for the specified item.","5","2"],["22","checkitem","71","Checks if the player is carrying the specified item.","5","2"],["2","checkitemtype","72","Checks the item type for the specified item and stores the result in LASTRESULT.","3","1"],["22","addpcitem","73","Adds the quantity of the specified item to player's PC.","5","2"],["2","adddecoration","75","Adds a decoration to player's PC.","3","1"],["2","removedecoration","76","Removes a decoration from player's PC.","3","1"],["2","testdecoration","77","Tests a specific decoration to see if there's enough room to store it.","3","1"],["2","checkdecoration","78","Checks if a specific decoration is present in player's PC","3","1"],["23","applymovement","79","Applies the movement data found at the specified pointer to a sprite.","7","2"],["23","applymovementpos","80","Applies the movement data found at the specified pointer to a sprite. Then sets the specified X/Y coordinates.","7","2"],["2","waitmovement","81","Waits for applymovement to finish","3","1"],["2","hidesprite","83","Hides a sprite.","3","1"],["211","hidespritepos","84","Hides a sprite, then sets the specified X/Y corrdinates.","5","3"],["2","showsprite","85","Shows a previously vanished sprite.","3","1"],["211","showspritepos","86","Shows a previously vanished sprite. Then sets the specified X/Y.","5","3"],["222","movesprite","87","Moves a sprite to the specified location.","7","3"],["211","spritevisible","88","Makes the sprite visible at selected bank and map.","5","3"],["211","spriteinvisible","89","Makes the sprite invisible at selected bank and map.","5","3"],["","faceplayer","90","Turns the caller towards the player.","1","0"],["21","spriteface","91","Changes the facing of a sprite","4","2"],["122333","trainerbattle","92","Starts a trainer battle. Depending on the kind of battle, last parameters may differ.","18","6"],["","repeattrainerbattle","93","Repeats the last trainer battle started.","1","0"],["","endtrainerbattle","94","Returns from the trainer battle screen without starting message.","1","0"],["","endtrainerbattle2","95","Returns from the trainer battle screen without ending message.","1","0"],["2","checktrainerflag","96","Checks it the specified trainer flag is already activated and store the result in LASTRESULT.","3","1"],["2","cleartrainerflag","97","Deactivates the specified trainer flag.","3","1"],["2","settrainerflag","98","Activates the specified trainer flag.","3","1"],["222","movesprite2","99","Moves a sprite to the specified location. Permanent change.","7","3"],["2","moveoffscreen","100","Changes the location of the specified sprite to a value which is exactly one tile above the top left corner of the screen.","3","1"],["21","spritebehave","101","Changes the behaviour of a sprite.","4","2"],["","waitmsg","102","Waits for preparemsg to finish.","1","0"],["3","preparemsg","103","Prepares a pointer to dialogue text for being displayed.","5","1"],["","closeonkeypress","104","Holds a msgbox open and closes it on keypress.","1","0"],["","lockall","105","Locks down movement for all the people on the screen.","1","0"],["","lock","106","Locks down movement for the caller.","1","0"],["","releaseall","107","Resumes normal movement forall the people on the screen. Closes any previously opened msgboxes as well.","1","0"],["","release","108","Resumes normal movement for the caller. Closes any previously opened msgboxes as well.","1","0"],["","waitkeypress","109","Waits until a key is pressed.","1","0"],["11","yesnobox","110","Displays a Yes/No box at specified coordinates.","3","2"],["1111","multichoice","111","Puts up a list of choices for the player to make.","5","4"],["11111","multichoice2","112","Puts up a list of choices for the player to make. A default choice can be set.","6","5"],["11111","multichoice3","113","Puts up a list of choices for the player to make. The number of choices per row can be set.","6","5"],["1111","showbox","114","Displays a box with the given dimensions.","5","4"],["1111","hidebox","115","Hides a displayed box. Ruby/Sapphire only.","5","4"],["1111","clearbox","116","Clears a part of a custom box.","5","4"],["211","showpokepic","117","Displays a Pokemon in a picture box.","5","3"],["","hidepokepic","118","Hides a Pokemon picture box previously shown.","1","0"],["1","showcontestwinner","119","Shows the picture of the winner of set contest.","2","1"],["3","braille","120","Displays a braille box.","5","1"],["212331","givepokemon","121","Gives the player a Pokemon.","15","6"],["2","giveegg","122","Gives the player an egg of the specified Pokemon.","3","1"],["112","setpokemonpp","123","Sets a new amount of PP for the specified Pokemon in player's party.","5","3"],["2","checkattack","124","Checks if at least one Pokemon in the party has a particular attack.","3","1"],["12","bufferpokemon","125","Stores a Pokemon name within a specified buffer.","4","2"],["1","bufferfirstpokemon","126","Stores the first Pokemon name in player's party within a specified buffer.","2","1"],["12","bufferpartypokemon","127","Stores the selected Pokemon name in player's party within a specified buffer.","4","2"],["12","bufferitem","128","Stores an item name within a specified buffer.","4","2"],["12","bufferdecoration","129","Stores a decoration name within a specified buffer.","4","2"],["12","bufferattack","130","Stores an attack name within a specified buffer.","4","2"],["12","buffernumber","131","Variable version on buffernumber","4","2"],["12","bufferstd","132","Stores a standard string within a specified buffer.","4","2"],["13","bufferstring","133","Stores a string within a specified buffer.","6","2"],["3","pokemart","134","Opens the Pokemart shop system with the item/price list found at the selected pointer.","5","1"],["3","pokemart2","135","Opens the PokeMart shop system with the item/price list found at the selected pointer.","5","1"],["3","pokemart3","136","Opens the PokeMart shop system with the item/price list found at the selected pointer.","5","1"],["2","pokecasino","137","Opens the Casino system.","3","1"],["111","cmd8a","138","Apparently does absolutely nothing.","4","3"],["22","checkpcitem","74","Checks if the player has the specified item on his/her PC.","5","2"],["211","waitmovementpos","82","Waits for applymovement to finish. Then sets the specified X/Y coordinates.","5","3"],["","choosecontestpkmn","139","Opens up a menu for choosing a contest Pokemon.","1","0"],["","startcontest","140","Start a Pokemon Contest.","1","0"],["","showcontestresults","141","Shows Pokemon contest results.","1","0"],["","contestlinktransfer","142","Establishes a connection using the wireless adapter. Emerald only.","1","0"],["2","random","143","Generates a random number storing it into LASTRESULT.","3","1"],["31","givemoney","144","Gives the player some money.","6","2"],["31","paymoney","145","Takes some money from the player.","6","2"],["31","checkmoney","146","Checks if the player has a specified amount of money.","6","2"],["111","showmoney","147","Shows the money counter on set coordinates..","4","2"],["11","hidemoney","148","Hides the money counter.","3","2"],["11","updatemoney","149","Updates the amount of money displayed in the money counter.","3","2"],["2","cmd96","150","Apparently does absolutely nothing.","3","1"],["1","fadescreen","151","Fades the screen in or out.","2","1"],["11","fadescreendelay","152","Fades the screen in or out, after some delay.","3","2"],["2","darken","153","Calls flash animation that lightens the area. Must be called from a level script.","3","1"],["1","lighten","154","Calls flash animation that lightens the area.","2","1"],["3","preparemsg2","155","Unknown Command","5","1"],["2","doanimation","156","Executes the specified move animation.","3","1"],["12","setanimation","157","Sets the move animation.","4","2"],["2","checkanimation","158","Checks whether an animation is currently being played or not. If so, it'll pause until the animation is done.","3","1"],["2","sethealingplace","159","Sets the place where the player goes once he/she is out of usable Pokemon.","3","1"],["","checkgender","160","Checks if the player is a boy or a girl and stores it in LASTRESULT.","1","0"],["22","cry","161","Plays back the cry of a Pokemon.","5","2"],["2222","setmaptile","162","Sets a tile on the map. You must somehow refresh that part.","9","4"],["","resetweather","163","Prepares to fade the weather into the default type.","1","0"],["2","setweather","164","Prepares to fade the weather into the type specified.","3","1"],["","doweather","165","riggers the weather change set with setweather/resetweather.","1","0"],["1","cmda6","166","Unknown Command.","2","1"],["2","setmapfooter","167","Changes the current map footer loading the new one. The map must be refreshed afterwards in order to work fine.","3","1"],["2111","spritelevelup","168","Makes the specified sprite go up one level at selected bank and map.","6","4"],["211","restorespritelevel","169","Restores the original level, at selected bank and map, for the specified sprite.","5","3"],["112211","createsprite","170","Creates a virtual sprite in the current map.","9","6"],["11","spriteface2","171","Changes a facing of a virtual sprite.","3","2"],["22","setdooropened","172","Prepares a door to be opened.","5","2"],["22","setdoorclosed","173","Prepares a door to be closed.","5","2"],["","doorchange","174","Changes the state of the selected door.","1","0"],["22","setdooropened2","175","Prepares a door to be opened. No animation.","5","2"],["22","setdoorclosed2","176","Prepares a door to be closed. No animation.","5","2"],["1212","cmdb1","177","Unknown Command.","7","4"],["","cmdb2","178","Unknown Command.","1","0"],["2","checkcoins","179","Checks the actual amount of coins and stores it on a specified variable.","3","1"],["2","givecoins","180","Gives the player a specified quantity of coins.","3","1"],["2","removecoins","181","Removes a specified quantity of coins.","3","1"],["212","setwildbattle","182","Prepares to start a battle with a specified Pokemon, level and item.","6","3"],["","dowildbattle","183","Triggers the battle specified by setbattle.","1","0"],["3","setvirtualaddress","184","Jumps to the specified value - value at 0x020375C4 in RAM, continuing execution from there.","5","1"],["3","virtualgoto","185","Jumps to a custom function.","5","1"],["3","virtualcall","186","Calls a custom function.","5","1"],["13","virtualgotoif","187","Jumps to a custom function, conditional version.","6","2"],["13","virtualcallif","188","Calls a custom function, conditional version.","6","2"],["3","virtualmsgbox","189","Prepares a pointer to dialogue text for use.","5","1"],["3","virtualloadpointer","190","Prepares a pointer to dialogue text for use.","5","1"],["13","virtualbuffer","191","Stores a custom string within a buffer.","6","2"],["11","showcoins","192","Shows the coin counter on set coordinates.","3","2"],["11","hidecoins","193","Hides the coin counter.","3","2"],["","updatecoins","194","Updates the amount of coins displayed in the coin counter.","1","0"],["1","cmdc3","195","Uknown Command.","2","1"],["11122","warp6","196","Warps the player to another map.","8","5"],["","waitcry","197","Waits for cry to finish.","1","0"],["12","bufferboxname","198","Stores the name of a PC box within a specified buffer.","4","2"],["1","textcolor","199","Changes the text color used. FR/LG only.","2","1"],["","cmdc8","200","Unknown Command.","1","0"],["","cmdc9","201","Unknown Command.","1","0"],["","signmsg","202","Changes the graphics used by msgboxes in order to make them look like signs. FR/LG only.","1","0"],["","normalmsg","203","Clears the effect of the msgboxsign command. FR/LG only.","1","0"],["13","comparehiddenvar","204","Compares the value of a chosen hidden variable. FR/LG only.","6","2"],["2","setobedience","205","Sets the specified Pokemon in player's party as obedient.","3","1"],["2","checkobedience","206","Checks if the specified Pokemon in player's party is obedient or not. The result is stored in LASTRESULT.","3","1"],["","executeram","207","Calculates the current location of the RAM script area and passes the execution to that offset.","1","0"],["2","setworldmap","208","Sets the flag used to allow the player to fly to a specific place. FR/LG only.","3","1"],["11122","warpteleport2","209","Warps the player to another map. Teleport effect.","8","5"],["21","setcatchlocation","210","Changes the catch location for a specified Pokemon in player's party.","4","2"],["3","braille2","211","Unknown Command.","5","1"],["122","bufferitems","212","Stores a plural item name within a specified buffer. FR/LG only.","6","3"],["2","cmdd5","213","Unknown Command.","3","1"],["","cmdd6","214","Unknown Command.","1","0"],["11122","warp7","215","Unknown Command.","8","5"],["","cmdd8","216","Unknown Command.","1","0"],["","cmdd9","217","Unknown Command.","1","0"],["","hidebox2","218","Unknown Command.","1","0"],["3","preparemsg3","219","Unknown Command.","5","1"],["1","fadescreen3","220","Fades the screen in or out. Emerald only.","2","1"],["12","buffertrainerclass","221","Stores the name of the selected trainer class within a specified buffer. Emerald only.","4","2"],["12","buffertrainername","222","Stores the name of the selected trainer within a specified buffer. Emerald only.","4","2"],["11122","warp8","223","Unknown Command.","8","5"],["12","buffercontestype","224","Stores the name of the selected contest type within a specified buffer. Emerald only.","4","2"],["122","bufferitems2","225","Stores a plural item name within a specified buffer. Emerald only.","6","3"],["30","msgbox","-2","Prints text to a messagebox.","8","2"],["003","if","-3","Compares the value stored in LASTRESULT to argument 1, then goes to pointer.","7","003"],["","giveitem","-4","Gives a specified item and displays the aftermath.","12","3"],["","giveitem2","-6","Gives a specified item and displays the aftermath. Plays a fanfare.","12","3"],["22","checkpcitem","74","Checks amount of items in PC from first variable in the quantity contained in the second variable.","5","2"]];for(let t=0;t<r.length;t++){let n=r[t],o=n[1],a=parseInt(n[2]),s=n[3],c=parseInt(n[4]),l=parseInt(n[5]),p=[],d=n[0];for(let x=0;x<l&&x<d.length;x++){let u=d.charAt(x),m=parseInt(u);3==m&&m++,p.push(m)}let h=new Re(a,o,c,l,p,s);this.commands.set(h.index,h)}this.messageTypes.set(0,"MSG_OBTAIN"),this.messageTypes.set(1,"MSG_FIND"),this.messageTypes.set(2,"MSG_FACE"),this.messageTypes.set(3,"MSG_SIGN"),this.messageTypes.set(4,"MSG_KEEPOPEN"),this.messageTypes.set(5,"MSG_YESNO"),this.messageTypes.set(6,"MSG_NORMAL"),this.messageTypes.set(10,"MSG_POKENAV"),this.movementTypes.set(0,"Face Down"),this.movementTypes.set(1,"Face Up"),this.movementTypes.set(2,"Face Left"),this.movementTypes.set(3,"Face Right"),this.movementTypes.set(4,"Face Down (Faster)"),this.movementTypes.set(5,"Face Up (Faster)"),this.movementTypes.set(6,"Face Left (Faster)"),this.movementTypes.set(7,"Face Right (Faster)"),this.movementTypes.set(8,"Step Down (Very Slow)"),this.movementTypes.set(9,"Step Up (Very Slow)"),this.movementTypes.set(10,"Step Left (Very Slow)"),this.movementTypes.set(11,"Step Right (Very Slow)"),this.movementTypes.set(12,"Step Down (Slow)"),this.movementTypes.set(13,"Step Up (Slow)"),this.movementTypes.set(14,"Step Left (Slow)"),this.movementTypes.set(15,"Step Right (Slow)"),this.movementTypes.set(16,"Step Down (Normal)"),this.movementTypes.set(17,"Step Up (Normal)"),this.movementTypes.set(18,"Step Left (Normal)"),this.movementTypes.set(19,"Step Right (Normal)"),this.movementTypes.set(20,"Jump2 Down"),this.movementTypes.set(21,"Jump2 Up"),this.movementTypes.set(22,"Jump2 Left"),this.movementTypes.set(23,"Jump2 Right"),this.movementTypes.set(24,"Delay1"),this.movementTypes.set(25,"Delay2"),this.movementTypes.set(26,"Delay3"),this.movementTypes.set(27,"Delay4"),this.movementTypes.set(28,"Delay5"),this.movementTypes.set(29,"Step Down (Fast)"),this.movementTypes.set(30,"Step Up (Fast)"),this.movementTypes.set(31,"Step Left (Fast)"),this.movementTypes.set(32,"Step Right (Fast)"),this.movementTypes.set(33,"Step on the Spot Down (Normal)"),this.movementTypes.set(34,"Step on the Spot Up (Normal)"),this.movementTypes.set(35,"Step on the Spot Left (Normal)"),this.movementTypes.set(36,"Step on the Spot Right (Normal)"),this.movementTypes.set(37,"Step on the Spot Down (Faster)"),this.movementTypes.set(38,"Step on the Spot Up (Faster)"),this.movementTypes.set(39,"Step on the Spot Left (Faster)"),this.movementTypes.set(40,"Step on the Spot Right (Faster)"),this.movementTypes.set(41,"Step on the Spot Down (Fastest)"),this.movementTypes.set(42,"Step on the Spot Up (Fastest)"),this.movementTypes.set(43,"Step on the Spot Left (Fastest)"),this.movementTypes.set(44,"Step on the Spot Right (Fastest)"),this.movementTypes.set(45,"Face Down (Delayed)"),this.movementTypes.set(46,"Face Up (Delayed)"),this.movementTypes.set(47,"Face Left (Delayed)"),this.movementTypes.set(48,"Face Right (Delayed)"),this.movementTypes.set(49,"Slide Down (Slow)"),this.movementTypes.set(50,"Slide Up (Slow)"),this.movementTypes.set(51,"Slide Left (Slow)"),this.movementTypes.set(52,"Slide Right (Slow)"),this.movementTypes.set(53,"Slide Down (Normal)"),this.movementTypes.set(54,"Slide Up (Normal)"),this.movementTypes.set(55,"Slide Left (Normal)"),this.movementTypes.set(56,"Slide Right (Normal)"),this.movementTypes.set(57,"Slide Down (Fast)"),this.movementTypes.set(58,"Slide Up (Fast)"),this.movementTypes.set(59,"Slide Left (Fast)"),this.movementTypes.set(60,"Slide Right (Fast)"),this.movementTypes.set(61,"Slide Running on Right Foot (Down)"),this.movementTypes.set(62,"Slide Running on Right Foot (Up)"),this.movementTypes.set(63,"Slide Running on Right Foot (Left)"),this.movementTypes.set(64,"Slide Running on Right Foot (Right)"),this.movementTypes.set(65,"Slide Running on Left Foot (Down)"),this.movementTypes.set(66,"Slide Running on Left Foot (Up)"),this.movementTypes.set(67,"Slide Running on Left Foot (Left)"),this.movementTypes.set(68,"Slide Running on Left Foot (Right)"),this.movementTypes.set(70,"Jump Facing Left (Down)"),this.movementTypes.set(71,"Jump Facing Down (Up)"),this.movementTypes.set(72,"Jump Facing Up (Left)"),this.movementTypes.set(73,"Jump Facing Left (Right)"),this.movementTypes.set(74,"Face Player"),this.movementTypes.set(75,"Face Against Player"),this.movementTypes.set(78,"Jump Down"),this.movementTypes.set(79,"Jump Up"),this.movementTypes.set(80,"Jump Left"),this.movementTypes.set(81,"Jump Right"),this.movementTypes.set(82,"Jump in Place (Facing Down)"),this.movementTypes.set(83,"Jump in Place (Facing Up)"),this.movementTypes.set(84,"Jump in Place (Facing Left)"),this.movementTypes.set(85,"Jump in Place (Facing Right)"),this.movementTypes.set(86,"Jump in Place (Facing Down/Up)"),this.movementTypes.set(87,"Jump in Place (Facing Up/Down)"),this.movementTypes.set(88,"Jump in Place (Facing Left/Right)"),this.movementTypes.set(89,"Jump in Place (Facing Right/Left)"),this.movementTypes.set(96,"Hide"),this.movementTypes.set(97,"Show"),this.movementTypes.set(98,"Exclamation Mark (!)"),this.movementTypes.set(99,"Question Mark (?)"),this.movementTypes.set(100,"Cross (X)"),this.movementTypes.set(101,"Double Exclamation Mark (!!)"),this.movementTypes.set(102,"Happy (^_^)"),this.movementTypes.set(254,"End of Movements"),this.movementTypes.set(256,this.movementTypes.get(0)),this.movementTypes.set(257,this.movementTypes.get(1)),this.movementTypes.set(258,this.movementTypes.get(2)),this.movementTypes.set(259,this.movementTypes.get(3)),this.movementTypes.set(260,"Step Down (Slow)"),this.movementTypes.set(261,"Step Up (Slow)"),this.movementTypes.set(262,"Step Left (Slow)"),this.movementTypes.set(263,"Step Right (Slow)"),this.movementTypes.set(264,"Step Down (Normal)"),this.movementTypes.set(265,"Step Up (Normal)"),this.movementTypes.set(266,"Step Left (Normal)"),this.movementTypes.set(267,"Step Right (Normal)"),this.movementTypes.set(268,"Jump2 Down"),this.movementTypes.set(269,"Jump2 Up"),this.movementTypes.set(270,"Jump2 Left"),this.movementTypes.set(271,"Jump2 Right"),this.movementTypes.set(272,this.movementTypes.get(24)),this.movementTypes.set(273,this.movementTypes.get(25)),this.movementTypes.set(274,this.movementTypes.get(26)),this.movementTypes.set(275,this.movementTypes.get(27)),this.movementTypes.set(276,this.movementTypes.get(28)),this.movementTypes.set(277,"Slide Down"),this.movementTypes.set(278,"Slide Up"),this.movementTypes.set(279,"Slide Left"),this.movementTypes.set(280,"Slide Right"),this.movementTypes.set(281,"Step on the Spot Down (Slow)"),this.movementTypes.set(282,"Step on the Spot Up (Slow)"),this.movementTypes.set(283,"Step on the Spot Left (Slow)"),this.movementTypes.set(284,"Step on the Spot Right (Slow)"),this.movementTypes.set(285,"Step on the Spot Down (Normal)"),this.movementTypes.set(286,"Step on the Spot Up (Normal)"),this.movementTypes.set(287,"Step on the Spot Left (Normal)"),this.movementTypes.set(288,"Step on the Spot Right (Normal)"),this.movementTypes.set(289,"Step on the Spot Down (Faster)"),this.movementTypes.set(290,"Step on the Spot Up (Faster)"),this.movementTypes.set(291,"Step on the Spot Left (Faster)"),this.movementTypes.set(292,"Step on the Spot Right (Faster)"),this.movementTypes.set(293,"Step on the Spot Down (Fastest)"),this.movementTypes.set(294,"Step on the Spot Up (Fastest)"),this.movementTypes.set(295,"Step on the Spot Left (Fastest)"),this.movementTypes.set(296,"Step on the Spot Right (Fastest)"),this.movementTypes.set(297,"Slide Down"),this.movementTypes.set(298,"Slide Up"),this.movementTypes.set(299,"Slide Left"),this.movementTypes.set(300,"Slide Right"),this.movementTypes.set(301,"Slide Down"),this.movementTypes.set(302,"Slide Up"),this.movementTypes.set(303,"Slide Left"),this.movementTypes.set(304,"Slide Right"),this.movementTypes.set(305,"Slide Down"),this.movementTypes.set(306,"Slide Up"),this.movementTypes.set(307,"Slide Left"),this.movementTypes.set(308,"Slide Right"),this.movementTypes.set(309,"Slide Running Down"),this.movementTypes.set(310,"Slide Running Up"),this.movementTypes.set(311,"Slide Running Left"),this.movementTypes.set(312,"Slide Running Right"),this.movementTypes.set(314,"Jump Facing Left (Down)"),this.movementTypes.set(315,"Jump Facing Down (Up)"),this.movementTypes.set(316,"Jump Facing Up (Left)"),this.movementTypes.set(317,"Jump Facing Left (Right)"),this.movementTypes.set(318,this.movementTypes.get(74)),this.movementTypes.set(319,this.movementTypes.get(75)),this.movementTypes.set(322,this.movementTypes.get(78)),this.movementTypes.set(323,this.movementTypes.get(79)),this.movementTypes.set(324,this.movementTypes.get(80)),this.movementTypes.set(325,this.movementTypes.get(81)),this.movementTypes.set(326,this.movementTypes.get(82)),this.movementTypes.set(327,this.movementTypes.get(83)),this.movementTypes.set(328,this.movementTypes.get(84)),this.movementTypes.set(329,this.movementTypes.get(85)),this.movementTypes.set(330,this.movementTypes.get(86)),this.movementTypes.set(331,this.movementTypes.get(87)),this.movementTypes.set(332,this.movementTypes.get(88)),this.movementTypes.set(333,this.movementTypes.get(89)),this.movementTypes.set(334,"Face Left"),this.movementTypes.set(340,this.movementTypes.get(96)),this.movementTypes.set(341,this.movementTypes.get(97)),this.movementTypes.set(342,this.movementTypes.get(98)),this.movementTypes.set(343,this.movementTypes.get(99)),this.movementTypes.set(344,"Love (<3)"),this.movementTypes.set(354,"Walk Down"),this.movementTypes.set(355,"Walk Down"),this.movementTypes.set(356,this.movementTypes.get(45)),this.movementTypes.set(357,this.movementTypes.get(46)),this.movementTypes.set(358,this.movementTypes.get(47)),this.movementTypes.set(359,this.movementTypes.get(48)),this.movementTypes.set(368,this.movementTypes.get(82)),this.movementTypes.set(369,this.movementTypes.get(83)),this.movementTypes.set(370,this.movementTypes.get(84)),this.movementTypes.set(371,this.movementTypes.get(85)),this.movementTypes.set(372,"Jump Down Running"),this.movementTypes.set(373,"Jump Up Running"),this.movementTypes.set(374,"Jump Left Running"),this.movementTypes.set(375,"Jump Right Running"),this.movementTypes.set(376,"Jump2 Down Running"),this.movementTypes.set(377,"Jump2 Up Running"),this.movementTypes.set(378,"Jump2 Left Running"),this.movementTypes.set(379,"Jump2 Right Running"),this.movementTypes.set(380,"Walk on the Spot (Down)"),this.movementTypes.set(381,"Walk on the Spot (Up)"),this.movementTypes.set(382,"Walk on the Spot (Lef)"),this.movementTypes.set(383,"Walk on the Spot (Right)"),this.movementTypes.set(384,"Slide Down Running"),this.movementTypes.set(385,"Slide Up Running"),this.movementTypes.set(386,"Slide Left Running"),this.movementTypes.set(387,"Slide Right Running"),this.movementTypes.set(388,"Slide Down"),this.movementTypes.set(389,"Slide Up"),this.movementTypes.set(390,"Slide Left"),this.movementTypes.set(391,"Slide Right"),this.movementTypes.set(392,"Slide Down on Left Foot"),this.movementTypes.set(393,"Slide Up on Left Foot"),this.movementTypes.set(394,"Slide Left on Left Foot "),this.movementTypes.set(395,"Slide Right on Left Foot"),this.movementTypes.set(396,"Slide Left diagonally (Facing Up)"),this.movementTypes.set(397,"Slide Right diagonally (Facing Up)"),this.movementTypes.set(398,"Slide Left diagonally (Facing Down)"),this.movementTypes.set(399,"Slide Right diagonally (Facing Down)"),this.movementTypes.set(400,"Slide2 Left diagonally (Facing Up)"),this.movementTypes.set(401,"Slide2 Right diagonally (Facing Up)"),this.movementTypes.set(402,"Slide2 Left diagonally (Facing Down)"),this.movementTypes.set(403,"Slide2 Right diagonally (Facing Down)"),this.movementTypes.set(406,"Walk Left"),this.movementTypes.set(407,"Walk Right"),this.movementTypes.set(408,"Levitate"),this.movementTypes.set(409,"Stop Levitating"),this.movementTypes.set(412,"Fly Up Vertically"),this.movementTypes.set(413,"Land")}}class Re{constructor(r,t,n,o,a,s){this.index=r,this.label=t,this.commandLength=n,this.paramCount=o,this.paramLengths=a,this.description=s}}const Qe=function Jn(i,r){return i===r||i!=i&&r!=r},ae=function qn(i,r){for(var t=i.length;t--;)if(Qe(i[t][0],r))return t;return-1};var Qn=Array.prototype.splice;function N(i){var r=-1,t=null==i?0:i.length;for(this.clear();++r<t;){var n=i[r];this.set(n[0],n[1])}}N.prototype.clear=function Nn(){this.__data__=[],this.size=0},N.prototype.delete=function Wn(i){var r=this.__data__,t=ae(r,i);return!(t<0||(t==r.length-1?r.pop():Qn.call(r,t,1),--this.size,0))},N.prototype.get=function jn(i){var r=this.__data__,t=ae(r,i);return t<0?void 0:r[t][1]},N.prototype.has=function zn(i){return ae(this.__data__,i)>-1},N.prototype.set=function Vn(i,r){var t=this.__data__,n=ae(t,i);return n<0?(++this.size,t.push([i,r])):t[n][1]=r,this};const se=N,We="object"==typeof global&&global&&global.Object===Object&&global;var si="object"==typeof self&&self&&self.Object===Object&&self;const k=We||si||Function("return this")(),L=k.Symbol;var He=Object.prototype,pi=He.hasOwnProperty,di=He.toString,G=L?L.toStringTag:void 0;var mi=Object.prototype.toString;var je=L?L.toStringTag:void 0;const V=function bi(i){return null==i?void 0===i?"[object Undefined]":"[object Null]":je&&je in Object(i)?function xi(i){var r=pi.call(i,G),t=i[G];try{i[G]=void 0;var n=!0}catch(a){}var o=di.call(i);return n&&(r?i[G]=t:delete i[G]),o}(i):function gi(i){return mi.call(i)}(i)},X=function yi(i){var r=typeof i;return null!=i&&("object"==r||"function"==r)},Ye=function Mi(i){if(!X(i))return!1;var r=V(i);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r};var i,Ai=k["__core-js_shared__"],ze=(i=/[^.]+$/.exec(Ai&&Ai.keys&&Ai.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";var Ui=Function.prototype.toString;const P=function Pi(i){if(null!=i){try{return Ui.call(i)}catch(r){}try{return i+""}catch(r){}}return""};var Di=/^\[object .+?Constructor\]$/,Li=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const qi=function Ji(i){return!(!X(i)||function ki(i){return!!ze&&ze in i}(i))&&(Ye(i)?Li:Di).test(P(i))},I=function Wi(i,r){var t=function Ri(i,r){return null==i?void 0:i[r]}(i,r);return qi(t)?t:void 0},K=I(k,"Map"),$=I(Object,"create");var $i=Object.prototype.hasOwnProperty;var io=Object.prototype.hasOwnProperty;function J(i){var r=-1,t=null==i?0:i.length;for(this.clear();++r<t;){var n=i[r];this.set(n[0],n[1])}}J.prototype.clear=function Yi(){this.__data__=$?$(null):{},this.size=0},J.prototype.delete=function Gi(i){var r=this.has(i)&&delete this.__data__[i];return this.size-=r?1:0,r},J.prototype.get=function eo(i){var r=this.__data__;if($){var t=r[i];return"__lodash_hash_undefined__"===t?void 0:t}return $i.call(r,i)?r[i]:void 0},J.prototype.has=function oo(i){var r=this.__data__;return $?void 0!==r[i]:io.call(r,i)},J.prototype.set=function so(i,r){var t=this.__data__;return this.size+=this.has(i)?0:1,t[i]=$&&void 0===r?"__lodash_hash_undefined__":r,this};const Ge=J,le=function uo(i,r){var t=i.__data__;return function xo(i){var r=typeof i;return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i}(r)?t["string"==typeof r?"string":"hash"]:t.map};function q(i){var r=-1,t=null==i?0:i.length;for(this.clear();++r<t;){var n=i[r];this.set(n[0],n[1])}}q.prototype.clear=function co(){this.size=0,this.__data__={hash:new Ge,map:new(K||se),string:new Ge}},q.prototype.delete=function mo(i){var r=le(this,i).delete(i);return this.size-=r?1:0,r},q.prototype.get=function _o(i){return le(this,i).get(i)},q.prototype.has=function vo(i){return le(this,i).has(i)},q.prototype.set=function yo(i,r){var t=le(this,i),n=t.size;return t.set(i,r),this.size+=t.size==n?0:1,this};const Co=q;function R(i){var r=this.__data__=new se(i);this.size=r.size}R.prototype.clear=function Kn(){this.__data__=new se,this.size=0},R.prototype.delete=function ei(i){var r=this.__data__,t=r.delete(i);return this.size=r.size,t},R.prototype.get=function ni(i){return this.__data__.get(i)},R.prototype.has=function oi(i){return this.__data__.has(i)},R.prototype.set=function So(i,r){var t=this.__data__;if(t instanceof se){var n=t.__data__;if(!K||n.length<199)return n.push([i,r]),this.size=++t.size,this;t=this.__data__=new Co(n)}return t.set(i,r),this.size=t.size,this};const Ao=R;var Eo=function(){try{var i=I(Object,"defineProperty");return i({},"",{}),i}catch(r){}}();const Ve=Eo,Xe=function Uo(i,r,t){"__proto__"==r&&Ve?Ve(i,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):i[r]=t};var Io=Object.prototype.hasOwnProperty;const Ke=function Do(i,r,t){var n=i[r];(!Io.call(i,r)||!Qe(n,t)||void 0===t&&!(r in i))&&Xe(i,r,t)},ce=function Bo(i,r,t,n){var o=!t;t||(t={});for(var a=-1,s=r.length;++a<s;){var c=r[a],l=n?n(t[c],i[c],c,t,i):void 0;void 0===l&&(l=i[c]),o?Xe(t,c,l):Ke(t,c,l)}return t},ee=function No(i){return null!=i&&"object"==typeof i},$e=function Jo(i){return ee(i)&&"[object Arguments]"==V(i)};var et=Object.prototype,qo=et.hasOwnProperty,Ro=et.propertyIsEnumerable,Qo=$e(function(){return arguments}())?$e:function(i){return ee(i)&&qo.call(i,"callee")&&!Ro.call(i,"callee")};const Wo=Qo,ge=Array.isArray;var tt="object"==typeof exports&&exports&&!exports.nodeType&&exports,nt=tt&&"object"==typeof module&&module&&!module.nodeType&&module,it=nt&&nt.exports===tt?k.Buffer:void 0;const ot=(it?it.isBuffer:void 0)||function jo(){return!1};var Ko=/^(?:0|[1-9]\d*)$/;const er=function $o(i,r){var t=typeof i;return!!(r=null==r?9007199254740991:r)&&("number"==t||"symbol"!=t&&Ko.test(i))&&i>-1&&i%1==0&&i<r},rt=function nr(i){return"number"==typeof i&&i>-1&&i%1==0&&i<=9007199254740991};var C={};C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Arguments]"]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object Boolean]"]=C["[object DataView]"]=C["[object Date]"]=C["[object Error]"]=C["[object Function]"]=C["[object Map]"]=C["[object Number]"]=C["[object Object]"]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object WeakMap]"]=!1;const _e=function Zr(i){return function(r){return i(r)}};var at="object"==typeof exports&&exports&&!exports.nodeType&&exports,te=at&&"object"==typeof module&&module&&!module.nodeType&&module,fe=te&&te.exports===at&&We.process;const Q=function(){try{return te&&te.require&&te.require("util").types||fe&&fe.binding&&fe.binding("util")}catch(r){}}();var st=Q&&Q.isTypedArray;const Ir=st?_e(st):function Ar(i){return ee(i)&&rt(i.length)&&!!C[V(i)]};var Br=Object.prototype.hasOwnProperty;const lt=function Fr(i,r){var t=ge(i),n=!t&&Wo(i),o=!t&&!n&&ot(i),a=!t&&!n&&!o&&Ir(i),s=t||n||o||a,c=s?function Fo(i,r){for(var t=-1,n=Array(i);++t<i;)n[t]=r(t);return n}(i.length,String):[],l=c.length;for(var p in i)(r||Br.call(i,p))&&(!s||!("length"==p||o&&("offset"==p||"parent"==p)||a&&("buffer"==p||"byteLength"==p||"byteOffset"==p)||er(p,l)))&&c.push(p);return c};var Or=Object.prototype;const ve=function Nr(i){var r=i&&i.constructor;return i===("function"==typeof r&&r.prototype||Or)},ct=function Lr(i,r){return function(t){return i(r(t))}},qr=ct(Object.keys,Object);var Qr=Object.prototype.hasOwnProperty;const pt=function jr(i){return null!=i&&rt(i.length)&&!Ye(i)},be=function Yr(i){return pt(i)?lt(i):function Wr(i){if(!ve(i))return qr(i);var r=[];for(var t in Object(i))Qr.call(i,t)&&"constructor"!=t&&r.push(t);return r}(i)};var $r=Object.prototype.hasOwnProperty;const ta=function ea(i){if(!X(i))return function Vr(i){var r=[];if(null!=i)for(var t in Object(i))r.push(t);return r}(i);var r=ve(i),t=[];for(var n in i)"constructor"==n&&(r||!$r.call(i,n))||t.push(n);return t},ye=function na(i){return pt(i)?lt(i,!0):ta(i)};var dt="object"==typeof exports&&exports&&!exports.nodeType&&exports,xt=dt&&"object"==typeof module&&module&&!module.nodeType&&module,ht=xt&&xt.exports===dt?k.Buffer:void 0,ut=ht?ht.allocUnsafe:void 0;const mt=function xa(){return[]};var ua=Object.prototype.propertyIsEnumerable,gt=Object.getOwnPropertySymbols,ma=gt?function(i){return null==i?[]:(i=Object(i),function pa(i,r){for(var t=-1,n=null==i?0:i.length,o=0,a=[];++t<n;){var s=i[t];r(s,t,i)&&(a[o++]=s)}return a}(gt(i),function(r){return ua.call(i,r)}))}:mt;const Te=ma,_t=function fa(i,r){for(var t=-1,n=r.length,o=i.length;++t<n;)i[o+t]=r[t];return i},ft=ct(Object.getPrototypeOf,Object);var ya=Object.getOwnPropertySymbols?function(i){for(var r=[];i;)_t(r,Te(i)),i=ft(i);return r}:mt;const vt=ya,bt=function wa(i,r,t){var n=r(i);return ge(i)?n:_t(n,t(i))},Ma=function Sa(i){return bt(i,be,Te)},ka=function Aa(i){return bt(i,ye,vt)},Ce=I(k,"DataView"),we=I(k,"Promise"),Se=I(k,"Set"),Me=I(k,"WeakMap");var yt="[object Map]",Tt="[object Promise]",Ct="[object Set]",wt="[object WeakMap]",St="[object DataView]",Da=P(Ce),Ba=P(K),Fa=P(we),Oa=P(Se),Na=P(Me),D=V;(Ce&&D(new Ce(new ArrayBuffer(1)))!=St||K&&D(new K)!=yt||we&&D(we.resolve())!=Tt||Se&&D(new Se)!=Ct||Me&&D(new Me)!=wt)&&(D=function(i){var r=V(i),t="[object Object]"==r?i.constructor:void 0,n=t?P(t):"";if(n)switch(n){case Da:return St;case Ba:return yt;case Fa:return Tt;case Oa:return Ct;case Na:return wt}return r});const Ae=D;var Ja=Object.prototype.hasOwnProperty;const Mt=k.Uint8Array,ke=function Wa(i){var r=new i.constructor(i.byteLength);return new Mt(r).set(new Mt(i)),r};var Ya=/\w*$/;var At=L?L.prototype:void 0,kt=At?At.valueOf:void 0;const bs=function vs(i,r,t){var n=i.constructor;switch(r){case"[object ArrayBuffer]":return ke(i);case"[object Boolean]":case"[object Date]":return new n(+i);case"[object DataView]":return function Ha(i,r){var t=r?ke(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.byteLength)}(i,t);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function Ka(i,r){var t=r?ke(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.length)}(i,t);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(i);case"[object RegExp]":return function za(i){var r=new i.constructor(i.source,Ya.exec(i));return r.lastIndex=i.lastIndex,r}(i);case"[object Symbol]":return function Va(i){return kt?Object(kt.call(i)):{}}(i)}};var Zt=Object.create,ys=function(){function i(){}return function(r){if(!X(r))return{};if(Zt)return Zt(r);i.prototype=r;var t=new i;return i.prototype=void 0,t}}();const Ts=ys;var Et=Q&&Q.isMap;const Zs=Et?_e(Et):function Ms(i){return ee(i)&&"[object Map]"==Ae(i)};var Ut=Q&&Q.isSet;const Ds=Ut?_e(Ut):function Us(i){return ee(i)&&"[object Set]"==Ae(i)};var Pt="[object Arguments]",It="[object Function]",Dt="[object Object]",T={};T[Pt]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object DataView]"]=T["[object Boolean]"]=T["[object Date]"]=T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Map]"]=T["[object Number]"]=T[Dt]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object Symbol]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Error]"]=T[It]=T["[object WeakMap]"]=!1;const sl=function pe(i,r,t,n,o,a){var s,c=1&r,l=2&r,p=4&r;if(t&&(s=o?t(i,n,o,a):t(i)),void 0!==s)return s;if(!X(i))return i;var d=ge(i);if(d){if(s=function qa(i){var r=i.length,t=new i.constructor(r);return r&&"string"==typeof i[0]&&Ja.call(i,"index")&&(t.index=i.index,t.input=i.input),t}(i),!c)return function la(i,r){var t=-1,n=i.length;for(r||(r=Array(n));++t<n;)r[t]=i[t];return r}(i,s)}else{var h=Ae(i),x=h==It||"[object GeneratorFunction]"==h;if(ot(i))return function aa(i,r){if(r)return i.slice();var t=i.length,n=ut?ut(t):new i.constructor(t);return i.copy(n),n}(i,c);if(h==Dt||h==Pt||x&&!o){if(s=l||x?{}:function Cs(i){return"function"!=typeof i.constructor||ve(i)?{}:Ts(ft(i))}(i),!c)return l?function Ta(i,r){return ce(i,vt(i),r)}(i,function ia(i,r){return i&&ce(r,ye(r),i)}(s,i)):function ga(i,r){return ce(i,Te(i),r)}(i,function zr(i,r){return i&&ce(r,be(r),i)}(s,i))}else{if(!T[h])return o?i:{};s=bs(i,h,c)}}a||(a=new Ao);var u=a.get(i);if(u)return u;a.set(i,s),Ds(i)?i.forEach(function(b){s.add(pe(b,r,t,b,i,a))}):Zs(i)&&i.forEach(function(b,M){s.set(M,pe(b,r,t,M,i,a))});var f=d?void 0:(p?l?ka:Ma:l?ye:be)(i);return function ko(i,r){for(var t=-1,n=null==i?0:i.length;++t<n&&!1!==r(i[t],t,i););}(f||i,function(b,M){f&&(b=i[M=b]),Ke(s,M,pe(b,r,t,M,i,a))}),s},dl=function pl(i){return sl(i,5)};var xl=v(1824);let Bt=(()=>{class i{constructor(t,n){this.gbaService=t,this.characterSetService=n,this.constants=new On}decompile(t,n){let o=new hl;o.address=t;let a=!1,s=t-1;for(o.secondaryScriptAddresses=[],o.textAddresses=[],o.movementAddresses=[];!a;){s++;let c=this.gbaService.getByteAt(s),l=dl(this.constants.commands.get(c)),p=new ul(l);if(!l)break;let d=1,h=l.paramCount;for(let x=0;x<h;x++)switch(l.paramLengths[x]){case 1:this.gbaService.goTo(s+d);let m=this.gbaService.getByte();"trainerbattle"==l.label&&(0==m||5==m)&&(l.paramLengths.splice(l.paramLengths.length-1,1),l.commandLength-=4),p.paramValues.push(m),d+=1;break;case 2:this.gbaService.goTo(s+d);let f=this.gbaService.getShort();p.paramValues.push(f),d+=2;break;case 4:this.gbaService.goTo(s+d);let b=this.gbaService.getPointer();n||(n=[]),!o.secondaryScriptAddresses.includes(b)&&!n.includes(b)&&(("call"==l.label||"goto"==l.label||"if1"==l.label||"if2"==l.label)&&!o.secondaryScriptAddresses.includes(b)||"trainerbattle"==l.label)&&o.secondaryScriptAddresses.push(b),!o.textAddresses.includes(b)&&("loadpointer"==l.label&&this.gbaService.getByte()==this.getCommand("callstd").index||"preparemsg"==l.label)&&!o.textAddresses.includes(b)&&o.textAddresses.push(b),!o.movementAddresses.includes(b)&&"applymovement"==l.label&&!o.textAddresses.includes(b)&&o.movementAddresses.push(b),p.paramValues.push(b),d+=4}l.commandLength>0&&(s+=l.commandLength-1,t+=l.commandLength-1),t++,("end"==l.label||"return"==l.label||"goto"==l.label)&&(a=!0),p&&p.template&&o.commands.push(p)}n||(n=o.secondaryScriptAddresses.slice(0));for(let c=0;c<o.secondaryScriptAddresses.length;c++)try{let l=this.decompile(o.secondaryScriptAddresses[c]);n.push.apply(l.secondaryScriptAddresses),o.secondaryScripts.push(l)}catch(l){break}for(let c=0;c<o.textAddresses.length;c++){this.gbaService.goTo(o.textAddresses[c]);let l=new gl(o.textAddresses[c],this.gbaService.getGameStringAutoList(1)[0]);o.texts.push(l)}for(let c=0;c<o.movementAddresses.length;c++){this.gbaService.goTo(o.movementAddresses[c]);let l=[];for(;254!==l[l.length-1];)l.push(this.gbaService.getByte());let p=new ml(o.movementAddresses[c],l);o.movements.push(p)}return o}getCommand(t){for(let n of this.constants.commands.values())if(t==n.label)return n;return new Re(-1,"unknown",1,0,[],"Unknown command")}toXSE(t){console.log("Converting to XSE: "+t.address.toString(16).toUpperCase());let n=this.toXSEScript(t);n+="\n";let o=this.hasXSETexts(t);return o&&(n+="\n",n+="'---------\n",n+="' Strings\n",n+="'---------\n"),n+=this.toXSEText(t),o&&(n+="\n"),this.hasXSEMovements(t)&&(n+="'-----------\n",n+="' Movements\n",n+="'-----------\n"),n+=this.toXSEMovement(t),n.trim()}hasXSEMovements(t){if(t.movements.length>0)return!0;for(let n=0;n<t.secondaryScripts.length;n++)if(t.secondaryScripts[n].movements.length>0)return!0;return!1}hasXSETexts(t){if(t.texts.length>0)return!0;for(let n=0;n<t.secondaryScripts.length;n++)if(t.secondaryScripts[n].texts.length>0)return!0;return!1}toXSEText(t,n){n||(n="");let o="";for(let a=0;a<t.texts.length;a++){let s="#org 0x"+t.texts[a].address.toString(16).toUpperCase()+"\n";-1!==o.indexOf(s)||-1!==n.indexOf(s)||(o+=s,o+="= "+t.texts[a].text.split("\n").join("\\n").replace("|FD|\xc0","[player]").replace("|FD|\xc9","[rival]")+"\n\n")}n+=o;for(let a=0;a<t.secondaryScripts.length;a++)o+=this.toXSEText(t.secondaryScripts[a],n);return o}toXSEMovement(t,n){n||(n="");let o="";for(let a=0;a<t.movements.length;a++){let s="#org 0x"+t.movements[a].address.toString(16).toUpperCase()+"\n";if(-1===o.indexOf(s)&&-1===n.indexOf(s)){o+=s;for(let c=0;c<t.movements[a].movements.length;c++){let l=t.movements[a].movements[c];o+="#raw 0x"+l.toString(16).toUpperCase(),this.constants.movementTypes.has(l),o+=" '"+this.constants.movementTypes.get(l),o+="\n"}o+="\n"}}n+=o;for(let a=0;a<t.secondaryScripts.length;a++)o+=this.toXSEMovement(t.secondaryScripts[a],n);return o}toXSEScript(t,n){if(n||(n=""),n.includes("0x"+t.address.toString(16)))return"";let o="\n'---------------\n";o+="#org 0x"+t.address.toString(16).toUpperCase()+"\n";for(let a=0;t.commands.length;a++){let s=t.commands[a];if(!s)break;let c=this.toXSECommand(t,s,a);(c.startsWith("msgbox")||c.startsWith("giveitem2"))&&a++,c.startsWith("giveitem")&&(a+=2),o+=c+"\n"}o=o.replace(/0x800C/g,"PLAYERFACING"),o=o.replace(/0x800D/g,"LASTRESULT"),o=o.replace(/0x800F/g,"LASTTALKED"),n+=o;for(let a=0;a<t.secondaryScripts.length;a++)n.indexOf("0x"+t.secondaryScripts[a].address.toString(16).toUpperCase())&&(o+=this.toXSEScript(t.secondaryScripts[a],n));return o}toXSECommand(t,n,o){let a="";if(n&&n.template)switch(n.template.label){case"loadpointer":if(t.commands.length>o+1&&"callstd"==t.commands[o+1].template.label){a="msgbox 0x8"+n.paramValues[1].toString(16).toUpperCase()+" "+this.constants.messageTypes.get(t.commands[o+1].paramValues[0]);let l=this.getTextAt(t,n.paramValues[1]).split("\n").join("\\n").replace("|FD|\xc0","[player]").replace("|FD|\xc9","[rival]"),p=l&&l.length>35;a+=l?" '\""+l.substring(0,34)+(p?"...":"")+'"':""}else{a=n.template.label;for(let l=0;l<n.paramValues.length;l++)n.paramValues[l].toString(16).length<=4?a+=" 0x"+n.paramValues[l].toString(16).toUpperCase():a+=" 0x8"+n.paramValues[l].toString(16).toUpperCase()}break;case"preparemsg":a=n.template.label;for(let l=0;l<n.paramValues.length;l++)n.paramValues[l].toString(16).length<=4?a+=" 0x"+n.paramValues[l].toString(16).toUpperCase():a+=" 0x8"+n.paramValues[l].toString(16).toUpperCase();let s=this.getTextAt(t,n.paramValues[0]).split("\n").join("\\n").replace("|FD|\xc0","[player]").replace("|FD|\xc9","[rival]"),c=s&&s.length>35;s&&(a+=s?" '\""+s.substring(0,34)+(c?"...":"")+'"':"");break;case"copyvarifnotzero":if(t.commands.length>o+3&&"copyvarifnotzero"==t.commands[o].template.label&&"copyvarifnotzero"==t.commands[o+1].template.label&&"copyvarifnotzero"==t.commands[o+2].template.label&&"callstd"==t.commands[o+3].template.label){let p=t.commands[o+1].paramValues[1],d=t.commands[o+2].paramValues[1];a="giveitem2 0x"+t.commands[o].paramValues[1].toString(16).toUpperCase()+" 0x"+p.toString(16).toUpperCase()+" 0x"+d.toString(16).toUpperCase()}else if(t.commands.length>o+3&&"copyvarifnotzero"==t.commands[o].template.label&&"copyvarifnotzero"==t.commands[o+1].template.label&&"callstd"==t.commands[o+2].template.label){let p=t.commands[o+1].paramValues[1],d=t.commands[o+2].paramValues[0];a="giveitem 0x"+t.commands[o].paramValues[1].toString(16).toUpperCase()+" 0x"+p.toString(16).toUpperCase()+" "+this.constants.messageTypes.get(d)}else{a=n.template.label;for(let l=0;l<n.paramValues.length;l++)n.paramValues[l].toString(16).length<=4?a+=" 0x"+n.paramValues[l].toString(16).toUpperCase():a+=" 0x8"+n.paramValues[l].toString(16).toUpperCase()}break;case"if1":a="if 0x"+n.paramValues[0].toString(16).toUpperCase()+" goto 0x8"+n.paramValues[1].toString(16).toUpperCase();break;case"if2":a="if 0x"+n.paramValues[0].toString(16).toUpperCase()+" call 0x8"+n.paramValues[1].toString(16).toUpperCase();break;default:a=n.template.label;for(let l=0;l<n.paramValues.length;l++)n.paramValues[l].toString(16).length<=4?a+=" 0x"+n.paramValues[l].toString(16).toUpperCase():a+=" 0x8"+n.paramValues[l].toString(16).toUpperCase()}return a=a.replace("applymovement 0xFF","applymovement MOVE_PLAYER"),a}getTextAt(t,n){for(let o=0;o<t.texts.length;o++)if(t.texts[o].address==n)return t.texts[o].text}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(w.VP),e.LFG(xl.Y))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class hl{constructor(r,t=[],n=[],o=[],a=[],s=[],c=[],l=[]){this.address=r,this.commands=t,this.secondaryScripts=n,this.texts=o,this.movements=a,this.secondaryScriptAddresses=s,this.textAddresses=c,this.movementAddresses=l}}class ul{constructor(r,t=[]){this.template=r,this.paramValues=t}}class ml{constructor(r,t=[]){this.address=r,this.movements=t}}class gl{constructor(r,t){this.address=r,this.text=t}}var Ft=v(5750),Ze=v(6428),Ot=v(4807),Nt=v(9224),_l=v(4208),Lt=v(7446);function fl(i,r){if(1&i&&(e.TgZ(0,"div",12)(1,"h3",13),e._uU(2),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.map.label?t.map.label:"??????????")}}function vl(i,r){if(1&i&&e._UZ(0,"img",14),2&i){const t=e.oxw();e.Q6J("src",t.battlefield.backgroundImage,e.LSH)}}let yl=(()=>{class i{constructor(t,n){this.battlefieldService=t,this.dialog=n,this.isShowingAnimations=!1,this.animationsUpdated=new e.vpe,this.isShowingOverworlds=!1,this.overworldsUpdated=new e.vpe,this.zoom=2,this.zoomUpdated=new e.vpe}ngOnInit(){this.map&&this.onChangeMap()}ngOnChanges(t){t&&t.map&&this.onChangeMap()}updateAnimationsEnabled(t){void 0!==t&&(this.isShowingAnimations=t),this.animationsUpdated.emit(this.isShowingAnimations)}updateOverworldsEnabled(t){void 0!==t&&(this.isShowingOverworlds=t),this.overworldsUpdated.emit(this.isShowingOverworlds)}updateZoom(t){void 0!==t&&(this.zoom=t),this.zoomUpdated.emit(this.zoom)}getNextZoomLevel(){return this.zoom+1>3?1:this.zoom+1}editBlocks(){this.dialog.open(Je,{data:{currentMap:this.map}})}editDoors(){this.dialog.open(qe,{data:{currentMap:this.map}})}onChangeMap(){this.battlefield=this.battlefieldService.loadBattlefield(this.map.header.battlefieldType)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_l.P),e.Y36(Z.uw))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-map-card"]],inputs:{map:"map",isShowingAnimations:"isShowingAnimations",isShowingOverworlds:"isShowingOverworlds",zoom:"zoom"},outputs:{animationsUpdated:"animationsUpdated",overworldsUpdated:"overworldsUpdated",zoomUpdated:"zoomUpdated"},features:[e.TTD],decls:19,vars:5,consts:[[1,"mb-3"],[1,"d-inline-flex","justify-content-center","w-100"],["class","poke-border-sm bg-gray p-3 mb-3",4,"ngIf"],[1,"w-100","mb-3"],[1,"poke-sprite-circle","d-inline-flex","justify-content-center","w-100"],["class","w-100 poke-border-sm",3,"src",4,"ngIf"],[1,"bg-gray","w-100","poke-border-sm","px-3","py-2","d-flex","flex-column","mb-2"],[1,"mb-2",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["mat-flat-button","","color","accent","disabled","",1,"w-100","mb-2"],["mat-flat-button","","color","accent",1,"w-100","mb-2",3,"click"],["mat-flat-button","","color","accent","disabled","",1,"w-100"],[1,"poke-border-sm","bg-gray","p-3","mb-3"],[1,"mb-0","font-p2"],[1,"w-100","poke-border-sm",3,"src"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-card",0)(1,"div",1),e.YNc(2,fl,3,1,"div",2),e.qZA(),e.TgZ(3,"div",3)(4,"div",4),e.YNc(5,vl,1,1,"img",5),e.qZA()(),e.TgZ(6,"div",6)(7,"mat-checkbox",7),e.NdJ("ngModelChange",function(a){return n.isShowingAnimations=a})("ngModelChange",function(){return n.updateAnimationsEnabled()}),e._uU(8,"Animations (experimental)"),e.qZA(),e.TgZ(9,"mat-checkbox",8),e.NdJ("ngModelChange",function(a){return n.isShowingOverworlds=a})("ngModelChange",function(){return n.updateOverworldsEnabled()}),e._uU(10,"Overworlds"),e.qZA()(),e.TgZ(11,"button",9),e._uU(12,"Change Name"),e.qZA(),e.TgZ(13,"button",10),e.NdJ("click",function(){return n.editDoors()}),e._uU(14,"Doors"),e.qZA(),e.TgZ(15,"button",10),e.NdJ("click",function(){return n.updateZoom(n.getNextZoomLevel())}),e._uU(16),e.qZA(),e.TgZ(17,"button",11),e._uU(18,"Editor Settings"),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",n.map),e.xp6(3),e.Q6J("ngIf",n.battlefield.backgroundImage),e.xp6(2),e.Q6J("ngModel",n.isShowingAnimations),e.xp6(2),e.Q6J("ngModel",n.isShowingOverworlds),e.xp6(7),e.hij("Zoom: ",n.zoom,"x"))},directives:[Nt.a8,_.O5,Lt.oG,g.JJ,g.On,O.lW],styles:[".poke-sprite-circle[_ngcontent-%COMP%]{border-radius:50%;background-color:#eaf5ff}.poke-sprite-small[_ngcontent-%COMP%]{background-color:#f7f5c580;display:inline-flex;justify-content:center;align-items:center}.poke-sprite-circle-big[_ngcontent-%COMP%]{border-radius:50%;background-color:#fffeeb80;position:absolute;height:100%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}.poke-sprite-small[_ngcontent-%COMP%]:hover{cursor:pointer;border:2px solid #349dff}.poke-sprite-active[_ngcontent-%COMP%]{cursor:pointer;background-color:#eaf5ff;border:2px solid #349dff;border-radius:8px}#monster-data[_ngcontent-%COMP%]{height:100%;position:relative}.monster-background[_ngcontent-%COMP%]{position:absolute;image-rendering:pixelated;opacity:.35;width:auto;height:100%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}"]}),i})();var Jt=v(9832);function Tl(i,r){if(1&i&&e._UZ(0,"img",6),2&i){const t=e.oxw();e.Udp("width",t.currentMapCanvas.width*t.zoom+"px")("height",t.currentMapCanvas.height*t.zoom+"px")("z-index",15),e.Q6J("src",t.currentMapCanvas.toDataURL(),e.LSH)}}function Cl(i,r){if(1&i&&(e.TgZ(0,"div",4)(1,"div")(2,"span"),e._uU(3),e.qZA()()()),2&i){const t=r.index,n=e.oxw().index,o=e.oxw(2);e.xp6(1),e.Gre("block-hover position-absolute d-flex align-items-center justify-content-center meta-bg-",o.getMovement(o.currentMap.blockData.blockMetas[n*o.currentMap.layout.mapWidth+t]).type,""),e.Udp("width",16*o.zoom+"px")("height",16*o.zoom+"px")("top",16*n*o.zoom+"px")("left",16*t*o.zoom+"px"),e.xp6(1),e.Udp("font-weight","500")("font-size",12+8*(o.zoom-1)+"px"),e.xp6(1),e.Oqu(o.currentMap.blockData.blockMetas[n*o.currentMap.layout.mapWidth+t].toString(16).toUpperCase())}}const W=function(){return[]};function wl(i,r){if(1&i&&(e.TgZ(0,"div",4),e.YNc(1,Cl,4,16,"div",5),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.DdM(1,W).constructor(t.currentMap.layout.mapWidth))}}function Sl(i,r){if(1&i&&(e.TgZ(0,"div",4),e.YNc(1,wl,2,2,"div",5),e.qZA()),2&i){const t=e.oxw();e.Udp("z-index",500),e.xp6(1),e.Q6J("ngForOf",e.DdM(3,W).constructor(t.currentMap.layout.mapHeight))}}function Ml(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1,"P"),e.qZA()),2&i){const t=e.oxw(3);e.Udp("font-weight","550")("font-size",12+8*(t.zoom-1)+"px")}}function Al(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",8),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw(2).setCurrentEntity(a,"NPC")}),e.YNc(2,Ml,2,4,"span",9),e.qZA()()}if(2&i){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Udp("background-color",n.isShowingOverworlds?"":"#ffa825ce")("width",16*n.zoom+"px")("height",16*n.zoom+"px")("top",16*t.yPosition*n.zoom+"px")("left",16*t.xPosition*n.zoom+"px"),e.Q6J("ngClass",t==n.currentNPC&&"NPC"==n.currentEntityType?"block-selected":""),e.xp6(1),e.Q6J("ngIf",!n.isShowingOverworlds)}}function kl(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",8),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw(2).setCurrentEntity(a,"SIGN")}),e.TgZ(2,"span"),e._uU(3,"SI"),e.qZA()()()}if(2&i){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Udp("background-color","#0fa500b3")("width",16*n.zoom+"px")("height",16*n.zoom+"px")("top",16*t.yPosition*n.zoom+"px")("left",16*t.xPosition*n.zoom+"px"),e.Q6J("ngClass",t==n.currentSign&&"SIGN"==n.currentEntityType?"block-selected":""),e.xp6(1),e.Udp("font-weight","550")("font-size",12+8*(n.zoom-1)+"px")}}function Zl(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",8),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw(2).setCurrentEntity(a,"WARP")}),e.TgZ(2,"span"),e._uU(3,"W"),e.qZA()()()}if(2&i){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Udp("background-color","#5900ff70")("width",16*n.zoom+"px")("height",16*n.zoom+"px")("top",16*t.yPosition*n.zoom+"px")("left",16*t.xPosition*n.zoom+"px"),e.Q6J("ngClass",t==n.currentWarp&&"WARP"==n.currentEntityType?"block-selected":""),e.xp6(1),e.Udp("font-weight","550")("font-size",12+8*(n.zoom-1)+"px")}}function El(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",8),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw(2).setCurrentEntity(a,"SCRIPT")}),e.TgZ(2,"span"),e._uU(3,"S"),e.qZA()()()}if(2&i){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Udp("background-color","#ff25c896")("width",16*n.zoom+"px")("height",16*n.zoom+"px")("top",16*t.yPosition*n.zoom+"px")("left",16*t.xPosition*n.zoom+"px"),e.Q6J("ngClass",t==n.currentScript&&"SCRIPT"==n.currentEntityType?"block-selected":""),e.xp6(1),e.Udp("font-weight","550")("font-size",12+8*(n.zoom-1)+"px")}}function Ul(i,r){if(1&i&&(e.TgZ(0,"div",4),e.YNc(1,Al,3,12,"div",7),e.YNc(2,kl,4,15,"div",7),e.YNc(3,Zl,4,15,"div",7),e.YNc(4,El,4,15,"div",7),e.qZA()),2&i){const t=e.oxw();e.Udp("z-index",550),e.xp6(1),e.Q6J("ngForOf",t.currentMap.entityData.npcs),e.xp6(1),e.Q6J("ngForOf",t.currentMap.entityData.signs),e.xp6(1),e.Q6J("ngForOf",t.currentMap.entityData.warps),e.xp6(1),e.Q6J("ngForOf",t.currentMap.entityData.scripts)}}function Pl(i,r){if(1&i&&(e.TgZ(0,"div",4)(1,"div",10),e._UZ(2,"span"),e.qZA()()),2&i){const t=r.index,n=e.oxw().index,o=e.oxw(2);e.xp6(1),e.Udp("background-color",o.isEncounterBlock(o.currentMap.blockData.blockIds[n*o.currentMap.layout.mapWidth+t])?"":"rgba(0, 0, 0, 0.6)")("width",16*o.zoom+"px")("height",16*o.zoom+"px")("top",16*n*o.zoom+"px")("left",16*t*o.zoom+"px"),e.xp6(1),e.Udp("font-weight","500")("font-size",12+8*(o.zoom-1)+"px")}}function Il(i,r){if(1&i&&(e.TgZ(0,"div",4),e.YNc(1,Pl,3,14,"div",5),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.DdM(1,W).constructor(t.currentMap.layout.mapWidth))}}function Dl(i,r){if(1&i&&(e.TgZ(0,"div",4),e.YNc(1,Il,2,2,"div",5),e.qZA()),2&i){const t=e.oxw();e.Udp("z-index",500),e.xp6(1),e.Q6J("ngForOf",e.DdM(3,W).constructor(t.currentMap.layout.mapHeight))}}function Bl(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",11),e.NdJ("mouseover",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw().mouseOverBlock(a,s)})("mousedown",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw().clickBlock(a,s)})("mouseup",function(){return e.CHM(t),e.oxw(2).isMouseDown=!1}),e.qZA()()}if(2&i){const t=r.index,n=e.oxw().index,o=e.oxw();e.xp6(1),e.Udp("width",16*o.zoom+"px")("height",16*o.zoom+"px")("top",16*n*o.zoom+"px")("left",16*t*o.zoom+"px")}}function Fl(i,r){if(1&i&&(e.TgZ(0,"div",4),e.YNc(1,Bl,2,8,"div",5),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.DdM(1,W).constructor(t.currentMap.layout.mapWidth))}}const B=16;let Ol=(()=>{class i{constructor(t,n,o,a){this.zone=t,this.gbaService=n,this.bitmapService=o,this.worldService=a,this.currentWorldTool="tiles",this.zoom=2,this.isAnimatingTiles=!1,this.isShowingOverworlds=!1,this.currentEntityType="NPC",this.currentEntityId=0,this.entitySelected=new e.vpe,this.isDrawingMap=!1,this.isBlockChanged=!1,this.isMouseDown=!1,this.currentHoverBlockId=0,this.blockHovered=new e.vpe,this.blockClicked=new e.vpe,this.movements=[{id:0,title:"All Movement",color:"#0000ffb3",layer:"Transition",type:"allowed"},{id:1,title:"Obstacle",color:"#ff0000b3",layer:"All Layers",type:"restricted"},{id:4,title:"Surf Only",color:"#ff00ffb3",layer:"Surfing",type:"allowed"},{id:5,title:"Obstacle",color:"#ffff00b3",layer:"Layer 0",type:"restricted"},{id:8,title:"All Movement",color:"#808000b3",layer:"Layer 1",type:"allowed"},{id:9,title:"Obstacle",color:"#008000b3",layer:"Layer 1",type:"restricted"},{id:12,title:"All Movement",color:"#800080b3",layer:"Layer 2 (default)",type:"allowed"},{id:13,title:"Obstacle",color:"#ff0080b3",layer:"Layer 2 (default)",type:"restricted"},{id:16,title:"All Movement",color:"#4aa22db3",layer:"Layer 3",type:"allowed"},{id:17,title:"Obstacle",color:"#1ae64db3",layer:"Layer 3",type:"restricted"},{id:20,title:"All Movement",color:"#005300b3",layer:"Layer 4",type:"allowed"},{id:21,title:"Obstacle",color:"#7da6bdb3",layer:"Layer 4",type:"restricted"},{id:24,title:"All Movement",color:"#156a62b3",layer:"Layer 5",type:"allowed"},{id:25,title:"Obstacle",color:"#ab2951b3",layer:"Layer 5",type:"restricted"},{id:28,title:"All Movement",color:"#7035bfb3",layer:"Layer 6",type:"allowed"},{id:29,title:"Obstacle",color:"#6175d6b3",layer:"Layer 6",type:"restricted"},{id:32,title:"All Movement",color:"#ffff00b3",layer:"Layer 7",type:"allowed"},{id:33,title:"Obstacle",color:"#658040b3",layer:"Layer 7",type:"restricted"},{id:36,title:"All Movement",color:"#4e70f8b3",layer:"Layer 8",type:"allowed"},{id:37,title:"Obstacle",color:"#3159a4b3",layer:"Layer 8",type:"restricted"},{id:40,title:"All Movement",color:"#b4de21b3",layer:"Layer 9",type:"allowed"},{id:41,title:"Obstacle",color:"#f54b50b3",layer:"Layer 9",type:"restricted"},{id:44,title:"All Movement",color:"#1eac68b3",layer:"Layer 10",type:"allowed"},{id:45,title:"Obstacle",color:"#be7641b3",layer:"Layer 10",type:"restricted"},{id:48,title:"All Movement",color:"#14eba5b3",layer:"Layer 11",type:"allowed"},{id:49,title:"Obstacle",color:"#804040b3",layer:"Layer 11",type:"restricted"},{id:52,title:"All Movement",color:"#c8ab37b3",layer:"Layer 12",type:"allowed"},{id:53,title:"Obstacle",color:"#3ec165b3",layer:"Layer 12",type:"restricted"},{id:56,title:"All Movement",color:"#00ffffb3",layer:"Layer 13",type:"allowed"},{id:57,title:"Obstacle",color:"#bc0ac0b3",layer:"Layer 13",type:"restricted"},{id:60,title:"Depends on Surrounding Blocks",color:"#5355acb3",layer:"Layer Varies",type:"wildcard"}],this.currentMapCanvas=document.createElement("canvas"),this.currentMapContext=this.currentMapCanvas.getContext("2d")}ngOnInit(){this.currentMap&&this.onMapChange()}ngOnChanges(t){t&&t.currentMap&&this.onMapChange()}onMapChange(){this.currentMapContext.clearRect(0,0,this.currentMapCanvas.width,this.currentMapCanvas.height),this.currentMapCanvas.width=16*this.currentMap.layout.mapWidth,this.currentMapCanvas.height=16*this.currentMap.layout.mapHeight,this.worldRenderRef&&cancelAnimationFrame(this.worldRenderRef),this.drawMap()}setCurrentEntity(t,n){this.entitySelected.emit({id:t,type:n})}isEncounterBlock(t){return this.isGrassEncounterBlock(t)||this.isSurfEncounterBlock(t)}isGrassEncounterBlock(t){let n=this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService);return 2==n.behaviorId||209==n.behaviorId}isSurfEncounterBlock(t){let n=this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService);return 16==n.behaviorId||17==n.behaviorId||21==n.behaviorId}drawMap(){this.worldRenderRef=requestAnimationFrame(this.drawMap.bind(this)),this.zone.runOutsideAngular(()=>{this.isDrawingMap=!1,this.drawTiles(),this.isAnimatingTiles&&this.drawTileAnimations()})}drawTiles(){for(let t=0;t<this.currentMap.layout.mapHeight;t++)for(let n=0;n<this.currentMap.layout.mapWidth;n++){let a=this.currentMap.blockset.getBlock(this.currentMap.blockData.blockIds[t*this.currentMap.layout.mapWidth+n],this.gbaService,this.bitmapService),s=n*B,c=t*B;this.currentMapContext.clearRect(s,c,16,16),this.worldService.drawBlock(this.currentMapContext,a,s,c,this.isDrawingMap,0)}if(this.isShowingOverworlds)for(let t=0;t<this.currentMap.entityData.npcs.length;t++){let n=this.currentMap.entityData.npcs[t];if(n&&n.overworldSprite){let o=n.xPosition*B-(n.overworldSprite.width>16?n.overworldSprite.width/4:0),a=n.yPosition*B-(n.overworldSprite.height-B);n.overworldSprite&&n.xPosition<this.currentMap.layout.mapWidth&&n.yPosition<this.currentMap.layout.mapHeight&&this.currentMapContext.drawImage(n.overworldSprite,o,a)}}for(let t=0;t<this.currentMap.layout.mapHeight;t++)for(let n=0;n<this.currentMap.layout.mapWidth;n++){let a=this.currentMap.blockset.getBlock(this.currentMap.blockData.blockIds[t*this.currentMap.layout.mapWidth+n],this.gbaService,this.bitmapService);this.worldService.drawBlock(this.currentMapContext,a,n*B,t*B,this.isDrawingMap,1)}this.isBlockChanged=!1,this.isDrawingMap=!0}drawTileAnimations(){let t=performance.now();for(const[n,o]of this.currentMap.blockset.primaryTileset.tileCache.entries()){let a=o;a.bitmap.bitmapFrames.length>1&&(a.bitmap.isAnimating||a.bitmap.start(this.zone),a.bitmap.doAnimation(t))}for(const[n,o]of this.currentMap.blockset.secondaryTileset.tileCache.entries()){let a=o;a.bitmap.bitmapFrames.length>1&&(a.bitmap.isAnimating||a.bitmap.start(this.zone),a.bitmap.doAnimation(t))}}mouseOverBlock(t,n){this.currentHoverBlockId=this.currentMap.blockData.blockIds[n*this.currentMap.layout.mapWidth+t],this.blockHovered.emit(this.currentHoverBlockId),this.isMouseDown&&this.clickBlock(t,n)}clickBlock(t,n){this.isMouseDown=!0,this.blockClicked.emit({col:t,row:n})}getMovement(t){for(let n=0;n<this.movements.length;n++)if(this.movements[n].id==t)return this.movements[n];return{id:t,title:"???",color:"#ccccccb3"}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.R0b),e.Y36(w.VP),e.Y36(y.Lw),e.Y36(E))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-map-renderer"]],inputs:{currentWorldTool:"currentWorldTool",currentMap:"currentMap",zoom:"zoom",isAnimatingTiles:"isAnimatingTiles",isShowingOverworlds:"isShowingOverworlds",currentEntityType:"currentEntityType",currentEntityId:"currentEntityId",currentNPC:"currentNPC",currentSign:"currentSign",currentWarp:"currentWarp",currentScript:"currentScript"},outputs:{entitySelected:"entitySelected",blockHovered:"blockHovered",blockClicked:"blockClicked"},features:[e.TTD],decls:8,vars:14,consts:[[1,"overflow-auto","mw-100"],[1,"mw-100","overflow-auto","position-relative"],["class","d-block position-absolute",3,"src","width","height","zIndex",4,"ngIf"],["class","position-absolute",3,"zIndex",4,"ngIf"],[1,"position-absolute"],["class","position-absolute",4,"ngFor","ngForOf"],[1,"d-block","position-absolute",3,"src"],[4,"ngFor","ngForOf"],[1,"block-hover","position-absolute","d-flex","align-items-center","justify-content-center",3,"ngClass","click"],[3,"fontWeight","fontSize",4,"ngIf"],[1,"block-hover","position-absolute","d-flex","align-items-center","justify-content-center"],[1,"block-hover","position-absolute",3,"mouseover","mousedown","mouseup"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Tl,1,7,"img",2),e.YNc(3,Sl,2,4,"div",3),e.YNc(4,Ul,5,6,"div",3),e.YNc(5,Dl,2,4,"div",3),e.TgZ(6,"div",4),e.YNc(7,Fl,2,2,"div",5),e.qZA()()()),2&t&&(e.Udp("min-height",n.currentMapCanvas.height*n.zoom+"px")("min-width",n.currentMapCanvas.width*n.zoom+"px"),e.xp6(1),e.Udp("min-height",n.currentMapCanvas.height*n.zoom+"px"),e.xp6(1),e.Q6J("ngIf",n.currentMapCanvas),e.xp6(1),e.Q6J("ngIf","movement"==n.currentWorldTool),e.xp6(1),e.Q6J("ngIf","entities"==n.currentWorldTool),e.xp6(1),e.Q6J("ngIf","encounters"==n.currentWorldTool),e.xp6(1),e.Udp("z-index",500),e.xp6(1),e.Q6J("ngForOf",e.DdM(13,W).constructor(n.currentMap.layout.mapHeight)))},directives:[_.O5,_.sg,_.mk],styles:["@media (min-width: 768px){.map-wrapper-1x[_ngcontent-%COMP%], .map-wrapper-2x[_ngcontent-%COMP%], .map-wrapper-3x[_ngcontent-%COMP%]{overflow:auto}}.meta-bg-0[_ngcontent-%COMP%]{background-color:#ff25c896}.meta-bg-1[_ngcontent-%COMP%]{background-color:#ff0000b3}.meta-bg-4[_ngcontent-%COMP%]{background-color:#ff0096b3}.meta-bg-5[_ngcontent-%COMP%]{background-color:#ff0000b3}.meta-bg-12[_ngcontent-%COMP%]{background-color:#5900ffb3}.meta-bg-13[_ngcontent-%COMP%]{background-color:#a54a00b3}.meta-bg-16[_ngcontent-%COMP%]{background-color:#0fa500b3}.meta-bg-20[_ngcontent-%COMP%]{background-color:#00a59aa4}.meta-bg-28[_ngcontent-%COMP%]{background-color:#a0a500b3}.movement-overlay[_ngcontent-%COMP%]{font-size:14px;line-height:16px;z-index:30}.movement-selector-preview[_ngcontent-%COMP%]{height:32px;width:32px;display:flex;align-items:center;justify-content:center}.script-fadeout[_ngcontent-%COMP%]{background-image:linear-gradient(#f0f0f0 0%,white 95%)}"]}),i})();function Nl(i,r){if(1&i&&(e.TgZ(0,"mat-option",6),e._uU(1),e.qZA()),2&i){const t=r.$implicit,n=r.index,o=e.oxw();e.Q6J("value",n-o.gbaService.constants().MAP_NAME_OFFSET),e.xp6(1),e.AsE(" ",n," - ",t," ")}}function Ll(i,r){if(1&i&&(e.TgZ(0,"mat-option",6),e._uU(1),e.ALo(2,"uppercase"),e.qZA()),2&i){const t=r.$implicit,n=r.index,o=e.oxw();e.Q6J("value",n+o.gbaService.constants().MUSIC_MODIFIER),e.xp6(1),e.AsE(" ",n+o.gbaService.constants().MUSIC_MODIFIER," - ",e.lcZ(2,3,t)," ")}}let Jl=(()=>{class i{constructor(t,n){this.gbaService=t,this.worldService=n}ngOnInit(){}metadataChanged(){let t=new w.jo;t.key=this.currentMap.header.address+"-changed",t.changeReason=this.currentMap.label+" Header Changed",t.address=this.currentMap.header.address,t.bytesBefore=this.currentMap.header.data;let n=new ArrayBuffer(28),o=new DataView(n);o.setUint32(0,this.gbaService.toPointer(this.currentMap.header.mapDataAddress),!0),o.setUint32(4,this.gbaService.toPointer(this.currentMap.header.eventDataAddress),!0),o.setUint32(8,this.gbaService.toPointer(this.currentMap.header.mapScriptsAddress),!0),o.setUint32(12,this.gbaService.toPointer(this.currentMap.header.connectionsAddress),!0),o.setUint16(16,this.currentMap.header.musicId,!0),o.setUint16(18,this.currentMap.header.mapIndex,!0),o.setUint8(20,this.currentMap.header.labelIndex),o.setUint8(21,this.currentMap.header.visibilityType),o.setUint8(22,this.currentMap.header.weatherType),o.setUint8(23,this.currentMap.header.mapType),o.setUint8(24,t.bytesBefore[24]),o.setUint8(25,t.bytesBefore[25]),o.setUint8(26,this.currentMap.header.shouldShowLabelOnEntry),o.setUint8(27,this.currentMap.header.battlefieldType),t.bytesToWrite=new Uint8Array(n),this.gbaService.queueChange(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.VP),e.Y36(E))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-header-tool"]],inputs:{currentMap:"currentMap"},decls:164,vars:72,consts:[[1,"w-100","p-3"],[1,"row","mb-2"],[1,"col-md-6"],["appearance","fill",1,"w-100"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),e._uU(5,"Name"),e.qZA(),e.TgZ(6,"mat-select",4),e.NdJ("ngModelChange",function(a){return n.currentMap.header.labelIndex=a})("ngModelChange",function(){return n.metadataChanged()}),e.YNc(7,Nl,2,3,"mat-option",5),e.qZA()()(),e.TgZ(8,"div",2)(9,"mat-form-field",3)(10,"mat-label"),e._uU(11,"Music"),e.qZA(),e.TgZ(12,"mat-select",4),e.NdJ("ngModelChange",function(a){return n.currentMap.header.musicId=a})("ngModelChange",function(){return n.metadataChanged()}),e.YNc(13,Ll,3,5,"mat-option",5),e.qZA()()()(),e.TgZ(14,"div",1)(15,"div",2)(16,"mat-form-field",3)(17,"mat-label"),e._uU(18,"Visibility"),e.qZA(),e.TgZ(19,"mat-select",4),e.NdJ("ngModelChange",function(a){return n.currentMap.header.visibilityType=a})("ngModelChange",function(){return n.metadataChanged()}),e.TgZ(20,"mat-option",6),e._uU(21,"0 - Regular"),e.qZA(),e.TgZ(22,"mat-option",6),e._uU(23,"1 - Dark, Flash Usable"),e.qZA(),e.TgZ(24,"mat-option",6),e._uU(25,"2 - Dark, Flash Unusable"),e.qZA(),e.TgZ(26,"mat-option",6),e._uU(27,"3 - ???"),e.qZA(),e.TgZ(28,"mat-option",6),e._uU(29,"4 - ???"),e.qZA(),e.TgZ(30,"mat-option",6),e._uU(31,"5 - ???"),e.qZA(),e.TgZ(32,"mat-option",6),e._uU(33,"6 - ???"),e.qZA(),e.TgZ(34,"mat-option",6),e._uU(35,"7 - ???"),e.qZA(),e.TgZ(36,"mat-option",6),e._uU(37,"8 - ???"),e.qZA(),e.TgZ(38,"mat-option",6),e._uU(39,"9 - ???"),e.qZA(),e.TgZ(40,"mat-option",6),e._uU(41,"10 - ???"),e.qZA(),e.TgZ(42,"mat-option",6),e._uU(43,"11 - ???"),e.qZA(),e.TgZ(44,"mat-option",6),e._uU(45,"12 - ???"),e.qZA(),e.TgZ(46,"mat-option",6),e._uU(47,"13 - ???"),e.qZA(),e.TgZ(48,"mat-option",6),e._uU(49,"14 - ???"),e.qZA(),e.TgZ(50,"mat-option",6),e._uU(51,"15 - ???"),e.qZA()()()(),e.TgZ(52,"div",2)(53,"mat-form-field",3)(54,"mat-label"),e._uU(55,"Weather"),e.qZA(),e.TgZ(56,"mat-select",4),e.NdJ("ngModelChange",function(a){return n.currentMap.header.weatherType=a})("ngModelChange",function(){return n.metadataChanged()}),e.TgZ(57,"mat-option",6),e._uU(58,"0 - Inside a Building"),e.qZA(),e.TgZ(59,"mat-option",6),e._uU(60,"1 - Sunny, Clouds in Water"),e.qZA(),e.TgZ(61,"mat-option",6),e._uU(62,"2 - Normal"),e.qZA(),e.TgZ(63,"mat-option",6),e._uU(64,"3 - Rainy"),e.qZA(),e.TgZ(65,"mat-option",6),e._uU(66,"4 - Three Snow Flakes"),e.qZA(),e.TgZ(67,"mat-option",6),e._uU(68,"5 - Thunderstorm"),e.qZA(),e.TgZ(69,"mat-option",6),e._uU(70,"6 - Steady Mist"),e.qZA(),e.TgZ(71,"mat-option",6),e._uU(72,"7 - Steady Snow"),e.qZA(),e.TgZ(73,"mat-option",6),e._uU(74,"8 - Sandstorm"),e.qZA(),e.TgZ(75,"mat-option",6),e._uU(76,"9 - Fading Mist"),e.qZA(),e.TgZ(77,"mat-option",6),e._uU(78,"10 - Dense Mist"),e.qZA(),e.TgZ(79,"mat-option",6),e._uU(80,"11 - Cloudy"),e.qZA(),e.TgZ(81,"mat-option",6),e._uU(82,"12 - Underground Flash"),e.qZA(),e.TgZ(83,"mat-option",6),e._uU(84,"13 - Heavy Thunderstorm"),e.qZA(),e.TgZ(85,"mat-option",6),e._uU(86,"14 - Underwater Mist"),e.qZA(),e.TgZ(87,"mat-option",6),e._uU(88,"15 - ???"),e.qZA()()()()(),e.TgZ(89,"div",1)(90,"div",2)(91,"mat-form-field",3)(92,"mat-label"),e._uU(93,"Map Type"),e.qZA(),e.TgZ(94,"mat-select",4),e.NdJ("ngModelChange",function(a){return n.currentMap.header.mapType=a})("ngModelChange",function(){return n.metadataChanged()}),e.TgZ(95,"mat-option",6),e._uU(96,"0 - ???"),e.qZA(),e.TgZ(97,"mat-option",6),e._uU(98,"1 - Village"),e.qZA(),e.TgZ(99,"mat-option",6),e._uU(100,"2 - City"),e.qZA(),e.TgZ(101,"mat-option",6),e._uU(102,"3 - Route"),e.qZA(),e.TgZ(103,"mat-option",6),e._uU(104,"4 - Underground"),e.qZA(),e.TgZ(105,"mat-option",6),e._uU(106,"5 - Underwater"),e.qZA(),e.TgZ(107,"mat-option",6),e._uU(108,"6 - ???"),e.qZA(),e.TgZ(109,"mat-option",6),e._uU(110,"7 - ???"),e.qZA(),e.TgZ(111,"mat-option",6),e._uU(112,"8 - Inside a Building"),e.qZA(),e.TgZ(113,"mat-option",6),e._uU(114,"9 - Inside a Secret Base"),e.qZA(),e.TgZ(115,"mat-option",6),e._uU(116,"10 - ???"),e.qZA(),e.TgZ(117,"mat-option",6),e._uU(118,"11 - ???"),e.qZA(),e.TgZ(119,"mat-option",6),e._uU(120,"12 - ???"),e.qZA(),e.TgZ(121,"mat-option",6),e._uU(122,"13 - ???"),e.qZA(),e.TgZ(123,"mat-option",6),e._uU(124,"14 - ???"),e.qZA(),e.TgZ(125,"mat-option",6),e._uU(126,"15 - ???"),e.qZA()()()(),e.TgZ(127,"div",2)(128,"mat-form-field",3)(129,"mat-label"),e._uU(130,"Battle Style"),e.qZA(),e.TgZ(131,"mat-select",4),e.NdJ("ngModelChange",function(a){return n.currentMap.header.battlefieldType=a})("ngModelChange",function(){return n.metadataChanged()}),e.TgZ(132,"mat-option",6),e._uU(133,"0 - Random"),e.qZA(),e.TgZ(134,"mat-option",6),e._uU(135,"1 - Gym"),e.qZA(),e.TgZ(136,"mat-option",6),e._uU(137,"2 - Evil Team"),e.qZA(),e.TgZ(138,"mat-option",6),e._uU(139,"3 - ???"),e.qZA(),e.TgZ(140,"mat-option",6),e._uU(141,"4 - Elite 4"),e.qZA(),e.TgZ(142,"mat-option",6),e._uU(143,"5 - Elite 4"),e.qZA(),e.TgZ(144,"mat-option",6),e._uU(145,"6 - Elite 4"),e.qZA(),e.TgZ(146,"mat-option",6),e._uU(147,"7 - Elite 4"),e.qZA(),e.TgZ(148,"mat-option",6),e._uU(149,"8 - Pok\xe9ball"),e.qZA(),e.TgZ(150,"mat-option",6),e._uU(151,"9 - ???"),e.qZA(),e.TgZ(152,"mat-option",6),e._uU(153,"10 - ???"),e.qZA(),e.TgZ(154,"mat-option",6),e._uU(155,"11 - ???"),e.qZA(),e.TgZ(156,"mat-option",6),e._uU(157,"12 - ???"),e.qZA(),e.TgZ(158,"mat-option",6),e._uU(159,"13 - ???"),e.qZA(),e.TgZ(160,"mat-option",6),e._uU(161,"14 - ???"),e.qZA(),e.TgZ(162,"mat-option",6),e._uU(163,"15 - ???"),e.qZA()()()()()()),2&t&&(e.xp6(6),e.Q6J("ngModel",n.currentMap.header.labelIndex),e.xp6(1),e.Q6J("ngForOf",n.worldService.mapNames),e.xp6(5),e.Q6J("ngModel",n.currentMap.header.musicId),e.xp6(1),e.Q6J("ngForOf",n.gbaService.constants().MUSIC_NAMES),e.xp6(6),e.Q6J("ngModel",n.currentMap.header.visibilityType),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(2),e.Q6J("value",4),e.xp6(2),e.Q6J("value",5),e.xp6(2),e.Q6J("value",6),e.xp6(2),e.Q6J("value",7),e.xp6(2),e.Q6J("value",8),e.xp6(2),e.Q6J("value",9),e.xp6(2),e.Q6J("value",10),e.xp6(2),e.Q6J("value",11),e.xp6(2),e.Q6J("value",12),e.xp6(2),e.Q6J("value",13),e.xp6(2),e.Q6J("value",14),e.xp6(2),e.Q6J("value",15),e.xp6(6),e.Q6J("ngModel",n.currentMap.header.weatherType),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(2),e.Q6J("value",4),e.xp6(2),e.Q6J("value",5),e.xp6(2),e.Q6J("value",6),e.xp6(2),e.Q6J("value",7),e.xp6(2),e.Q6J("value",8),e.xp6(2),e.Q6J("value",9),e.xp6(2),e.Q6J("value",10),e.xp6(2),e.Q6J("value",11),e.xp6(2),e.Q6J("value",12),e.xp6(2),e.Q6J("value",13),e.xp6(2),e.Q6J("value",14),e.xp6(2),e.Q6J("value",15),e.xp6(7),e.Q6J("ngModel",n.currentMap.header.mapType),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(2),e.Q6J("value",4),e.xp6(2),e.Q6J("value",5),e.xp6(2),e.Q6J("value",6),e.xp6(2),e.Q6J("value",7),e.xp6(2),e.Q6J("value",8),e.xp6(2),e.Q6J("value",9),e.xp6(2),e.Q6J("value",10),e.xp6(2),e.Q6J("value",11),e.xp6(2),e.Q6J("value",12),e.xp6(2),e.Q6J("value",13),e.xp6(2),e.Q6J("value",14),e.xp6(2),e.Q6J("value",15),e.xp6(6),e.Q6J("ngModel",n.currentMap.header.battlefieldType),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(2),e.Q6J("value",4),e.xp6(2),e.Q6J("value",5),e.xp6(2),e.Q6J("value",6),e.xp6(2),e.Q6J("value",7),e.xp6(2),e.Q6J("value",8),e.xp6(2),e.Q6J("value",9),e.xp6(2),e.Q6J("value",10),e.xp6(2),e.Q6J("value",11),e.xp6(2),e.Q6J("value",12),e.xp6(2),e.Q6J("value",13),e.xp6(2),e.Q6J("value",14),e.xp6(2),e.Q6J("value",15))},directives:[S.KE,S.hX,U.gD,g.JJ,g.On,_.sg,A.ey],pipes:[_.gd],styles:[""]}),i})(),ql=(()=>{class i{constructor(t){this.gbaService=t}ngOnInit(){}metadataChanged(){let t=new w.jo;t.key=this.currentMap.header.address+"-changed",t.changeReason=this.currentMap.label+" Header Changed",t.address=this.currentMap.header.address,t.bytesBefore=this.currentMap.header.data;let n=new ArrayBuffer(28),o=new DataView(n);o.setUint32(0,this.gbaService.toPointer(this.currentMap.header.mapDataAddress),!0),o.setUint32(4,this.gbaService.toPointer(this.currentMap.header.eventDataAddress),!0),o.setUint32(8,this.gbaService.toPointer(this.currentMap.header.mapScriptsAddress),!0),o.setUint32(12,this.gbaService.toPointer(this.currentMap.header.connectionsAddress),!0),o.setUint16(16,this.currentMap.header.musicId,!0),o.setUint16(18,this.currentMap.header.mapIndex,!0),o.setUint8(20,this.currentMap.header.labelIndex),o.setUint8(21,this.currentMap.header.visibilityType),o.setUint8(22,this.currentMap.header.weatherType),o.setUint8(23,this.currentMap.header.mapType),o.setUint8(24,t.bytesBefore[24]),o.setUint8(25,t.bytesBefore[25]),o.setUint8(26,this.currentMap.header.shouldShowLabelOnEntry),o.setUint8(27,this.currentMap.header.battlefieldType),t.bytesToWrite=new Uint8Array(n),this.gbaService.queueChange(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.VP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-layout-tool"]],inputs:{currentMap:"currentMap"},decls:31,vars:4,consts:[[1,"w-100","p-3"],[1,"row"],[1,"col-md-6"],["appearance","fill",1,"w-100"],["type","number","min","0","max","255","matInput","","placeholder","0",3,"ngModel","ngModelChange"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),e._uU(5,"Primary Tileset"),e.qZA(),e.TgZ(6,"input",4),e.NdJ("ngModelChange",function(a){return n.currentMap.layout.primaryTileset.index=a}),e.qZA(),e.TgZ(7,"mat-hint"),e._uU(8,"Not yet editable"),e.qZA()()(),e.TgZ(9,"div",2)(10,"mat-form-field",3)(11,"mat-label"),e._uU(12,"Secondary Tileset"),e.qZA(),e.TgZ(13,"input",4),e.NdJ("ngModelChange",function(a){return n.currentMap.layout.secondaryTileset.index=a}),e.qZA(),e.TgZ(14,"mat-hint"),e._uU(15,"Not yet editable"),e.qZA()()()(),e.TgZ(16,"div",1)(17,"div",2)(18,"mat-form-field",3)(19,"mat-label"),e._uU(20,"Width"),e.qZA(),e.TgZ(21,"input",4),e.NdJ("ngModelChange",function(a){return n.currentMap.layout.mapWidth=a})("ngModelChange",function(){return n.metadataChanged()}),e.qZA(),e.TgZ(22,"mat-hint"),e._uU(23,"0-255"),e.qZA()()(),e.TgZ(24,"div",2)(25,"mat-form-field",3)(26,"mat-label"),e._uU(27,"Height"),e.qZA(),e.TgZ(28,"input",4),e.NdJ("ngModelChange",function(a){return n.currentMap.layout.mapHeight=a})("ngModelChange",function(){return n.metadataChanged()}),e.qZA(),e.TgZ(29,"mat-hint"),e._uU(30,"0-255"),e.qZA()()()()()),2&t&&(e.xp6(6),e.Q6J("ngModel",n.currentMap.layout.primaryTileset.index),e.xp6(7),e.Q6J("ngModel",n.currentMap.layout.secondaryTileset.index),e.xp6(8),e.Q6J("ngModel",n.currentMap.layout.mapWidth),e.xp6(7),e.Q6J("ngModel",n.currentMap.layout.mapHeight))},directives:[S.KE,S.hX,g.qQ,g.Fd,g.wV,re.Nt,g.Fj,g.JJ,g.On,S.bx],styles:[""]}),i})();function Rl(i,r){if(1&i&&e._UZ(0,"img",8),2&i){const t=e.oxw();e.Udp("width",2*t.currentPaintBlockCanvas.width+"px")("height",2*t.currentPaintBlockCanvas.height+"px")("z-index",15),e.Q6J("src",t.currentPaintBlockCanvas.toDataURL(),e.LSH)}}function Ql(i,r){if(1&i&&e._UZ(0,"img",9),2&i){const t=e.oxw();e.Udp("width",t.currentBlocksetCanvas.width*t.zoom+"px")("height",t.currentBlocksetCanvas.height*t.zoom+"px")("z-index",15),e.Q6J("src",t.currentBlocksetCanvas.toDataURL(),e.LSH)}}const Wl=function(i){return{"block-selected":i}};function Hl(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw().paintBlockSelected(a)}),e.qZA()}if(2&i){const t=r.index,n=e.oxw();e.Udp("left",16*t*n.zoom%(16*n.zoom*8)+"px")("top",16*n.floorValue(16*t*n.zoom/(16*n.zoom*8))*n.zoom+"px")("width",16*n.zoom+"px")("height",16*n.zoom+"px")("z-index",250),e.Q6J("ngClass",e.VKq(11,Wl,t==n.currentPaintBlockId))}}const jl=function(){return[]};let Yl=(()=>{class i{constructor(t,n,o,a,s){this.worldService=t,this.viewportService=n,this.gbaService=o,this.bitmapService=a,this.zone=s,this.isOpen=!1,this.zoom=2,this.isDrawingBlockset=!1,this.maxBlockCount=861,this.currentPaintBlockId=0,this.blockSelected=new e.vpe,this.currentBlocksetCanvas=document.createElement("canvas"),this.currentBlocksetContext=this.currentBlocksetCanvas.getContext("2d"),this.currentPaintBlockCanvas=document.createElement("canvas"),this.currentPaintBlockContext=this.currentPaintBlockCanvas.getContext("2d")}ngOnInit(){this.currentMap&&this.currentMap.blockset&&this.onChangeMap()}ngOnChanges(t){t&&t.currentMap&&this.onChangeMap()}floorValue(t){return Math.floor(t)}paintBlockSelected(t){this.currentPaintBlockId=t,this.currentPaintBlock=this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService),this.blockSelected.emit(t)}onChangeMap(){this.currentBlocksetContext.clearRect(0,0,this.currentBlocksetCanvas.width,this.currentBlocksetCanvas.height),this.currentBlocksetCanvas.width=128,this.currentBlocksetCanvas.height=1760,this.currentPaintBlockContext.clearRect(0,0,this.currentPaintBlockCanvas.width,this.currentPaintBlockCanvas.height),this.currentPaintBlockCanvas.width=16,this.currentPaintBlockCanvas.height=16,this.paintBlockSelected(1),this.renderBlockset()}renderBlockset(){return(0,ie.mG)(this,void 0,void 0,function*(){this.worldRenderRef=requestAnimationFrame(this.renderBlockset.bind(this)),this.zone.runOutsideAngular(()=>{this.drawBlockset(),this.drawPaintBlock()})})}drawBlockset(){for(let t=0;t<this.maxBlockCount;t++){let n=this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService),o=16*t%this.currentBlocksetCanvas.width,a=16*Math.floor(16*t/this.currentBlocksetCanvas.width);(this.worldService.isBlockAnimated(n)||!this.isDrawingBlockset)&&this.isOpen&&this.worldService.drawBlock(this.currentBlocksetContext,n,o,a,this.isDrawingBlockset)}}drawPaintBlock(){this.worldService.drawBlock(this.currentPaintBlockContext,this.currentPaintBlock,0,0,!1)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(E),e.Y36(ue.v),e.Y36(w.VP),e.Y36(y.Lw),e.Y36(e.R0b))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-blockset-minitool"]],inputs:{isOpen:"isOpen",currentMap:"currentMap",zoom:"zoom",currentPaintBlockId:"currentPaintBlockId"},outputs:{blockSelected:"blockSelected"},features:[e.TTD],decls:11,vars:11,consts:[[1,"map-sidenav","blockset-display"],[1,"w-100","d-inline-flex","align-items-center","py-2","pr-3"],[1,"mb-0","mr-4"],[1,"d-inline-flex"],["class","d-block position-absolute",3,"src","width","height","zIndex",4,"ngIf"],[1,"position-relative"],["class","d-block",3,"src","width","height","zIndex",4,"ngIf"],["class","position-absolute block-hover","matRipple","",3,"left","top","width","height","zIndex","ngClass","click",4,"ngFor","ngForOf"],[1,"d-block","position-absolute",3,"src"],[1,"d-block",3,"src"],["matRipple","",1,"position-absolute","block-hover",3,"ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2)(3,"b"),e._uU(4,"Painting"),e.qZA()(),e.TgZ(5,"div",3),e.YNc(6,Rl,1,7,"img",4),e.qZA()(),e.TgZ(7,"div")(8,"div",5),e.YNc(9,Ql,1,7,"img",6),e.YNc(10,Hl,1,13,"div",7),e.qZA()()()),2&t&&(e.xp6(5),e.Udp("width","32px")("height","32px"),e.xp6(1),e.Q6J("ngIf",n.currentPaintBlockCanvas.toDataURL()),e.xp6(1),e.Gre("map-sidenav blockset-display overflow-auto bg-white poke-tool-sub-sidenav-",n.zoom,"x poke-tool-card-inner-toolbar border-left"),e.xp6(2),e.Q6J("ngIf",n.currentBlocksetCanvas),e.xp6(1),e.Q6J("ngForOf",e.DdM(10,jl).constructor(n.maxBlockCount)))},directives:[_.O5,_.sg,A.wG,_.mk],styles:["@media (min-width: 768px){.map-wrapper-1x[_ngcontent-%COMP%], .map-wrapper-2x[_ngcontent-%COMP%], .map-wrapper-3x[_ngcontent-%COMP%]{overflow:auto}}.meta-bg-0[_ngcontent-%COMP%]{background-color:#ff25c896}.meta-bg-1[_ngcontent-%COMP%]{background-color:#ff0000b3}.meta-bg-4[_ngcontent-%COMP%]{background-color:#ff0096b3}.meta-bg-5[_ngcontent-%COMP%]{background-color:#ff0000b3}.meta-bg-12[_ngcontent-%COMP%]{background-color:#5900ffb3}.meta-bg-13[_ngcontent-%COMP%]{background-color:#a54a00b3}.meta-bg-16[_ngcontent-%COMP%]{background-color:#0fa500b3}.meta-bg-20[_ngcontent-%COMP%]{background-color:#00a59aa4}.meta-bg-28[_ngcontent-%COMP%]{background-color:#a0a500b3}.movement-overlay[_ngcontent-%COMP%]{font-size:14px;line-height:16px;z-index:30}.movement-selector-preview[_ngcontent-%COMP%]{height:32px;width:32px;display:flex;align-items:center;justify-content:center}.script-fadeout[_ngcontent-%COMP%]{background-image:linear-gradient(#f0f0f0 0%,white 95%)}"]}),i})();function zl(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().setMovement(o)}),e.TgZ(1,"h3",4)(2,"span",10),e._uU(3),e.qZA(),e._uU(4," - "),e.TgZ(5,"b",10),e._uU(6),e.qZA()()()}if(2&i){const t=e.oxw().$implicit,n=e.oxw();e.Gre("w-100 d-inline-flex align-items-center justify-content-between meta-bg-",t.type," px-2 cursor-pointer"),e.ekj("border-primary",t.id===n.currentMovementId),e.xp6(3),e.hij("0x",t.id.toString(16).toUpperCase(),""),e.xp6(3),e.Oqu(t.layer)}}function Gl(i,r){if(1&i&&(e.TgZ(0,"div",7),e.YNc(1,zl,7,7,"div",8),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","allowed"===t.type)}}function Vl(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().setMovement(o)}),e.TgZ(1,"h3",4)(2,"span",10),e._uU(3),e.qZA(),e._uU(4," - "),e.TgZ(5,"b",10),e._uU(6),e.qZA()()()}if(2&i){const t=e.oxw().$implicit,n=e.oxw();e.Gre("w-100 d-inline-flex align-items-center justify-content-between meta-bg-",t.type," px-2 cursor-pointer"),e.ekj("border-primary",t.id===n.currentMovementId),e.xp6(3),e.hij("0x",t.id.toString(16).toUpperCase(),""),e.xp6(3),e.Oqu(t.layer)}}function Xl(i,r){if(1&i&&(e.TgZ(0,"div",7),e.YNc(1,Vl,7,7,"div",8),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","restricted"===t.type)}}function Kl(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().setMovement(o)}),e.TgZ(1,"h3",4)(2,"span",10),e._uU(3),e.qZA(),e._uU(4," - "),e.TgZ(5,"b",10),e._uU(6),e.qZA()()()}if(2&i){const t=e.oxw().$implicit,n=e.oxw();e.Gre("w-100 d-inline-flex align-items-center justify-content-between meta-bg-",t.type," px-2 cursor-pointer"),e.ekj("border-primary",t.id===n.currentMovementId),e.xp6(3),e.hij("0x",t.id.toString(16).toUpperCase(),""),e.xp6(3),e.Oqu(t.layer)}}function $l(i,r){if(1&i&&(e.TgZ(0,"div",7),e.YNc(1,Kl,7,7,"div",8),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","wildcard"===t.type)}}let ec=(()=>{class i{constructor(){this.currentMovementId=12,this.movementSelected=new e.vpe,this.movements=[{id:0,title:"All Movement",color:"#0000ffb3",layer:"Transition",type:"allowed"},{id:1,title:"Obstacle",color:"#ff0000b3",layer:"All Layers",type:"restricted"},{id:4,title:"Surf Only",color:"#ff00ffb3",layer:"Surfing",type:"allowed"},{id:5,title:"Obstacle",color:"#ffff00b3",layer:"Layer 0",type:"restricted"},{id:8,title:"All Movement",color:"#808000b3",layer:"Layer 1",type:"allowed"},{id:9,title:"Obstacle",color:"#008000b3",layer:"Layer 1",type:"restricted"},{id:12,title:"All Movement",color:"#800080b3",layer:"Layer 2 (default)",type:"allowed"},{id:13,title:"Obstacle",color:"#ff0080b3",layer:"Layer 2 (default)",type:"restricted"},{id:16,title:"All Movement",color:"#4aa22db3",layer:"Layer 3",type:"allowed"},{id:17,title:"Obstacle",color:"#1ae64db3",layer:"Layer 3",type:"restricted"},{id:20,title:"All Movement",color:"#005300b3",layer:"Layer 4",type:"allowed"},{id:21,title:"Obstacle",color:"#7da6bdb3",layer:"Layer 4",type:"restricted"},{id:24,title:"All Movement",color:"#156a62b3",layer:"Layer 5",type:"allowed"},{id:25,title:"Obstacle",color:"#ab2951b3",layer:"Layer 5",type:"restricted"},{id:28,title:"All Movement",color:"#7035bfb3",layer:"Layer 6",type:"allowed"},{id:29,title:"Obstacle",color:"#6175d6b3",layer:"Layer 6",type:"restricted"},{id:32,title:"All Movement",color:"#ffff00b3",layer:"Layer 7",type:"allowed"},{id:33,title:"Obstacle",color:"#658040b3",layer:"Layer 7",type:"restricted"},{id:36,title:"All Movement",color:"#4e70f8b3",layer:"Layer 8",type:"allowed"},{id:37,title:"Obstacle",color:"#3159a4b3",layer:"Layer 8",type:"restricted"},{id:40,title:"All Movement",color:"#b4de21b3",layer:"Layer 9",type:"allowed"},{id:41,title:"Obstacle",color:"#f54b50b3",layer:"Layer 9",type:"restricted"},{id:44,title:"All Movement",color:"#1eac68b3",layer:"Layer 10",type:"allowed"},{id:45,title:"Obstacle",color:"#be7641b3",layer:"Layer 10",type:"restricted"},{id:48,title:"All Movement",color:"#14eba5b3",layer:"Layer 11",type:"allowed"},{id:49,title:"Obstacle",color:"#804040b3",layer:"Layer 11",type:"restricted"},{id:52,title:"All Movement",color:"#c8ab37b3",layer:"Layer 12",type:"allowed"},{id:53,title:"Obstacle",color:"#3ec165b3",layer:"Layer 12",type:"restricted"},{id:56,title:"All Movement",color:"#00ffffb3",layer:"Layer 13",type:"allowed"},{id:57,title:"Obstacle",color:"#bc0ac0b3",layer:"Layer 13",type:"restricted"},{id:60,title:"Depends on Surrounding Blocks",color:"#5355acb3",layer:"Layer Varies",type:"wildcard"}]}ngOnInit(){}setMovement(t){this.currentMovementId=t.id,this.movementSelected.emit(this.currentMovementId)}getMovement(t){for(let n=0;n<this.movements.length;n++)if(this.movements[n].id==t)return this.movements[n];return{id:t,title:"???",color:"#ccccccb3"}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-movement-minitool"]],inputs:{currentMovementId:"currentMovementId"},outputs:{movementSelected:"movementSelected"},decls:20,vars:15,consts:[[1,"w-100"],[1,"w-100","d-inline-flex","align-items-center","py-2","pr-3"],[1,"mb-0","mr-4"],[1,"d-inline-flex"],[1,"mb-0"],[1,"mb-3"],["class","w-100 pr-3",4,"ngFor","ngForOf"],[1,"w-100","pr-3"],["matRipple","",3,"class","border-primary","click",4,"ngIf"],["matRipple","",3,"click"],[1,"hex-value"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2)(3,"b"),e._uU(4,"Painting"),e.qZA()(),e.TgZ(5,"div",3)(6,"div"),e._uU(7),e.qZA()()(),e.TgZ(8,"h2",4),e._uU(9,"Allow Movement"),e.qZA(),e.TgZ(10,"div",5),e.YNc(11,Gl,2,1,"div",6),e.qZA(),e.TgZ(12,"h2",4),e._uU(13,"Prevent Movement"),e.qZA(),e.TgZ(14,"div",5),e.YNc(15,Xl,2,1,"div",6),e.qZA(),e.TgZ(16,"h2",4),e._uU(17,"Wildcard (varies)"),e.qZA(),e.TgZ(18,"div",5),e.YNc(19,$l,2,1,"div",6),e.qZA()()),2&t&&(e.xp6(5),e.Udp("width","32px")("height","32px"),e.xp6(1),e.Gre("d-flex justify-content-center align-items-center position-absolute meta-bg-",n.getMovement(n.currentMovementId).type,""),e.Udp("width","32px")("height","32px"),e.xp6(1),e.hij(" ",n.currentMovementId.toString(16).toUpperCase()," "),e.xp6(4),e.Q6J("ngForOf",n.movements),e.xp6(4),e.Q6J("ngForOf",n.movements),e.xp6(4),e.Q6J("ngForOf",n.movements))},directives:[_.sg,_.O5,A.wG],styles:[""]}),i})(),Ue=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-script-editor-dialog"]],decls:0,vars:0,template:function(t,n){},styles:[""]}),i})();function tc(i,r){if(1&i&&(e.TgZ(0,"mat-option",24),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=r.$implicit,n=r.index;e.Q6J("value",n),e.xp6(1),e.AsE("",n," - ",e.lcZ(2,3,t),"")}}function nc(i,r){if(1&i&&e._UZ(0,"img",33),2&i){const t=e.oxw().$implicit,n=e.oxw(3);e.Q6J("src",n.monsterService.monsterIcons[t.species].currentFrame.toDataURL(),e.LSH)}}function ic(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,nc,1,1,"img",32),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.species>0)}}function oc(i,r){if(1&i&&e._UZ(0,"img",34),2&i){const t=e.oxw().index,n=e.oxw(2);e.Q6J("src",n.currentNPC.trainerSprites[t],e.LSH)}}function rc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",25)(1,"div",26)(2,"div",27)(3,"p",4)(4,"b"),e._uU(5),e.qZA()(),e.TgZ(6,"div",28),e.YNc(7,ic,2,1,"div",29),e.qZA()(),e.YNc(8,oc,1,1,"img",30),e.qZA(),e.TgZ(9,"button",31),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).goToTrainer(a.uid)}),e.TgZ(10,"span"),e._uU(11),e.qZA()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.oxw(2);e.xp6(5),e.Oqu(t.name),e.xp6(2),e.Q6J("ngForOf",t.party),e.xp6(1),e.Q6J("ngIf",o.currentNPC.trainerSprites[n]),e.xp6(3),e.hij("Go to Tainer #",t.uid+1,"")}}function ac(i,r){if(1&i&&(e.TgZ(0,"span",37)(1,"b"),e._uU(2),e.qZA()()),2&i){const t=r.$implicit;e.xp6(2),e.Oqu((1==t.toString(16).length?"0":"")+t.toString(16).toUpperCase()+" ")}}function sc(i,r){if(1&i&&(e.TgZ(0,"div",35),e.YNc(1,ac,3,1,"span",36),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.currentNPC.data)}}function lc(i,r){if(1&i&&(e.TgZ(0,"div",38)(1,"div",39),e._UZ(2,"div",40),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(1),e.Udp("height","194px")("max-height","194px"),e.Q6J("innerText",t.currentNPC.script),e.xp6(1),e.Udp("bottom","0px")("left","0px")("height","25px")}}function cc(i,r){1&i&&(e.TgZ(0,"div",41)(1,"div",42)(2,"p",18),e._uU(3,"No Script Found"),e.qZA(),e.TgZ(4,"p",4),e._uU(5,"If you believe this NPC is already associated with a script, you can check:"),e.qZA(),e.TgZ(6,"ul")(7,"li"),e._uU(8,"Script entities (pink 'S' on the map)"),e.qZA(),e.TgZ(9,"li"),e._uU(10,"Map scripts in the Metadata tab"),e.qZA()()()()),2&i&&(e.xp6(1),e.Udp("height","194px")("max-height","194px"))}function pc(i,r){if(1&i&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE("Showing ",t.currentNPC.script.trim().split("\n").length>=10?"10":t.currentNPC.script.trim().split("\n").length," out of ",t.currentNPC.script.trim().split("\n").length," lines.")}}function dc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).editScript()}),e.TgZ(1,"span"),e._uU(2,"Edit Script"),e.qZA()()}}function xc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"p",2),e._uU(2,"You may edit existing entities. Adding new entities will be available soon."),e.qZA(),e.TgZ(3,"div",3)(4,"p",4)(5,"b"),e._uU(6,"NPC Entity"),e.qZA()(),e.TgZ(7,"div",5)(8,"span",6),e._uU(9),e.qZA(),e.TgZ(10,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityBackward()}),e._uU(11,"arrow_back"),e.qZA(),e.TgZ(12,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityForward()}),e._uU(13,"arrow_forward"),e.qZA()()(),e.TgZ(14,"mat-form-field",8)(15,"mat-label"),e._uU(16,"Local NPC Index"),e.qZA(),e.TgZ(17,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.npcIndex=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e.qZA(),e.TgZ(18,"mat-hint"),e._uU(19,"0-255"),e.qZA()(),e.TgZ(20,"mat-form-field",8)(21,"mat-label"),e._uU(22,"Sprite Index"),e.qZA(),e.TgZ(23,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.spriteId=o})("ngModelChange",function(){e.CHM(t);const o=e.oxw();return o.npcSpriteChanged(),o.npcChanged()}),e.qZA(),e.TgZ(24,"mat-hint"),e._uU(25,"0-255"),e.qZA()(),e.TgZ(26,"div",10)(27,"div",11)(28,"mat-form-field",8)(29,"mat-label"),e._uU(30,"Map X"),e.qZA(),e.TgZ(31,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.xPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e.qZA(),e.TgZ(32,"mat-hint"),e._uU(33),e.qZA()()(),e.TgZ(34,"div",11)(35,"mat-form-field",8)(36,"mat-label"),e._uU(37,"Map Y"),e.qZA(),e.TgZ(38,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.yPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e.qZA(),e.TgZ(39,"mat-hint"),e._uU(40),e.qZA()()()(),e.TgZ(41,"div",10)(42,"div",11)(43,"mat-form-field",8)(44,"mat-label"),e._uU(45,"Movement Type"),e.qZA(),e.TgZ(46,"mat-select",13),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.movementType=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e.YNc(47,tc,3,5,"mat-option",14),e.qZA()()(),e.TgZ(48,"div",11)(49,"mat-form-field",8)(50,"mat-label"),e._uU(51,"Movement Param"),e.qZA(),e.TgZ(52,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.movementParam=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e.qZA(),e.TgZ(53,"mat-hint"),e._uU(54,"0-255"),e.qZA()()()(),e.YNc(55,rc,12,4,"div",15),e.TgZ(56,"div",16)(57,"mat-checkbox",13),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.isTrainer=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e._uU(58,"Use Map View Radius"),e.qZA()(),e.TgZ(59,"mat-form-field",8)(60,"mat-label"),e._uU(61,"View Radius / Berry Index"),e.qZA(),e.TgZ(62,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.viewRadius=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e.qZA(),e.TgZ(63,"mat-hint"),e._uU(64,"Berry index if not marked as map"),e.qZA()(),e.TgZ(65,"mat-form-field",8)(66,"mat-label"),e._uU(67,"Script Address"),e.qZA(),e.TgZ(68,"input",17),e.NdJ("change",function(o){e.CHM(t);const a=e.oxw();return a.currentNPC.scriptAddress=a.getInputHexValue(o),a.npcChanged()}),e.qZA(),e.TgZ(69,"mat-hint"),e._uU(70,"Hexidecimal big endian"),e.qZA()(),e.TgZ(71,"mat-form-field",8)(72,"mat-label"),e._uU(73,"Global NPC Index"),e.qZA(),e.TgZ(74,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentNPC.personId=o})("ngModelChange",function(){return e.CHM(t),e.oxw().npcChanged()}),e.qZA(),e.TgZ(75,"mat-hint"),e._uU(76,"Used in scripts"),e.qZA()(),e.TgZ(77,"p",18)(78,"b"),e._uU(79,"Data"),e.qZA()(),e.YNc(80,sc,2,1,"div",19),e.TgZ(81,"p",18)(82,"b"),e._uU(83,"Script"),e.qZA()(),e.YNc(84,lc,3,11,"div",20),e.YNc(85,cc,11,4,"div",21),e.YNc(86,pc,2,2,"p",22),e.YNc(87,dc,3,0,"button",23),e.qZA()}if(2&i){const t=e.oxw();e.xp6(9),e.Oqu(t.currentNPC.uid),e.xp6(1),e.Q6J("ngClass",0==t.currentNPC.uid?"text-gray":""),e.xp6(2),e.Q6J("ngClass",t.currentNPC.uid==t.currentMap.entityData.npcs.length-1?"text-gray":""),e.xp6(5),e.Q6J("ngModel",t.currentNPC.npcIndex),e.xp6(6),e.Q6J("ngModel",t.currentNPC.spriteId),e.xp6(8),e.s9C("max",t.currentMap.layout.mapWidth),e.Q6J("ngModel",t.currentNPC.xPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapWidth,""),e.xp6(5),e.s9C("max",t.currentMap.layout.mapHeight),e.Q6J("ngModel",t.currentNPC.yPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapHeight,""),e.xp6(6),e.Q6J("ngModel",t.currentNPC.movementType),e.xp6(1),e.Q6J("ngForOf",t.movementTypes),e.xp6(5),e.Q6J("ngModel",t.currentNPC.movementParam),e.xp6(3),e.Q6J("ngForOf",t.currentNPC.trainers),e.xp6(2),e.Q6J("ngModel",t.currentNPC.isTrainer),e.xp6(5),e.Q6J("ngModel",t.currentNPC.viewRadius),e.xp6(6),e.Q6J("value",t.currentNPC.scriptAddress.toString(16).toUpperCase()),e.xp6(6),e.Q6J("ngModel",t.currentNPC.personId),e.xp6(6),e.Q6J("ngIf",t.currentNPC&&t.currentNPC.data),e.xp6(4),e.Q6J("ngIf",t.currentNPC.script),e.xp6(1),e.Q6J("ngIf",!t.currentNPC.script),e.xp6(1),e.Q6J("ngIf",t.currentNPC.script),e.xp6(1),e.Q6J("ngIf",t.currentNPC.script)}}function hc(i,r){1&i&&(e.TgZ(0,"mat-option",24),e._uU(1,"8 - Secret Base"),e.qZA()),2&i&&e.Q6J("value",8)}function uc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2,"Script Address"),e.qZA(),e.TgZ(3,"input",17),e.NdJ("change",function(o){e.CHM(t);const a=e.oxw(2);return a.currentSign.scriptAddress=a.getInputHexValue(o),a.scriptChanged()}),e.qZA(),e.TgZ(4,"mat-hint"),e._uU(5,"Hexidecimal big endian"),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("value",t.currentSign.scriptAddress.toString(16).toUpperCase())}}function mc(i,r){if(1&i&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t.uid),e.xp6(1),e.hij(" ",t.name," ")}}function gc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",51)(1,"mat-form-field",45)(2,"mat-label"),e._uU(3,"Hidden Item"),e.qZA(),e.TgZ(4,"mat-select",13),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).currentSign.hiddenItemId=o})("ngModelChange",function(){return e.CHM(t),e.oxw(2).signChanged()}),e.TgZ(5,"mat-option",24),e._uU(6,"??????????"),e.qZA(),e.YNc(7,mc,2,2,"mat-option",14),e.qZA()(),e.TgZ(8,"mat-form-field",8)(9,"mat-label"),e._uU(10,"Hidden Item Count"),e.qZA(),e.TgZ(11,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).currentSign.hiddenItemAmount=o})("ngModelChange",function(){return e.CHM(t),e.oxw(2).signChanged()}),e.qZA(),e.TgZ(12,"mat-hint"),e._uU(13,"0-255"),e.qZA()(),e.TgZ(14,"mat-form-field",8)(15,"mat-label"),e._uU(16,"Global Hidden Item Index"),e.qZA(),e.TgZ(17,"input",52),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).currentSign.globalHiddenIndex=o})("ngModelChange",function(){return e.CHM(t),e.oxw(2).signChanged()}),e.qZA(),e.TgZ(18,"mat-hint"),e._uU(19,"Used for tracking flags"),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.currentSign.hiddenItemId),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("ngForOf",t.itemService.items),e.xp6(4),e.Q6J("ngModel",t.currentSign.hiddenItemAmount),e.xp6(6),e.Q6J("ngModel",t.currentSign.globalHiddenIndex)}}function _c(i,r){if(1&i&&(e.TgZ(0,"span",37)(1,"b"),e._uU(2),e.qZA()()),2&i){const t=r.$implicit;e.xp6(2),e.Oqu((1==t.toString(16).length?"0":"")+t.toString(16).toUpperCase()+" ")}}function fc(i,r){if(1&i&&(e.TgZ(0,"div",53),e.YNc(1,_c,3,1,"span",36),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.currentSign.data)}}function vc(i,r){if(1&i&&(e.TgZ(0,"div",38)(1,"div",39),e._UZ(2,"div",40),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(1),e.Udp("height","194px")("max-height","194px"),e.Q6J("innerText",t.currentSign.script),e.xp6(1),e.Udp("bottom","0px")("left","0px")("height","25px")}}function bc(i,r){1&i&&(e.TgZ(0,"div",41)(1,"div",42)(2,"p",18),e._uU(3,"No Script Found"),e.qZA()()()),2&i&&(e.xp6(1),e.Udp("height","194px")("max-height","194px"))}function yc(i,r){if(1&i&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.AsE("Showing ",t.currentSign.script.trim().split("\n").length>=10?"10":t.currentSign.script.trim().split("\n").length," out of ",t.currentSign.script.trim().split("\n").length," lines.")}}function Tc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).editScript()}),e.TgZ(1,"span"),e._uU(2,"Edit Script"),e.qZA()()}}function Cc(i,r){if(1&i&&(e.TgZ(0,"div")(1,"p",18)(2,"b"),e._uU(3,"Script"),e.qZA()(),e.YNc(4,vc,3,11,"div",20),e.YNc(5,bc,4,4,"div",21),e.YNc(6,yc,2,2,"p",22),e.YNc(7,Tc,3,0,"button",23),e.qZA()),2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf",t.currentSign.script),e.xp6(1),e.Q6J("ngIf",!t.currentSign.script),e.xp6(1),e.Q6J("ngIf",t.currentSign.script),e.xp6(1),e.Q6J("ngIf",t.currentSign.script)}}function wc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"p",2),e._uU(2,"You may edit existing entities. Adding new entities will be available soon."),e.qZA(),e.TgZ(3,"div",3)(4,"p",4)(5,"b"),e._uU(6,"Sign Entity"),e.qZA()(),e.TgZ(7,"div",5)(8,"span",6),e._uU(9),e.qZA(),e.TgZ(10,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityBackward()}),e._uU(11,"arrow_back"),e.qZA(),e.TgZ(12,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityForward()}),e._uU(13,"arrow_forward"),e.qZA()()(),e.TgZ(14,"div",44)(15,"mat-form-field",8)(16,"mat-label"),e._uU(17,"Map X"),e.qZA(),e.TgZ(18,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentSign.xPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().signChanged()}),e.qZA(),e.TgZ(19,"mat-hint"),e._uU(20),e.qZA()(),e.TgZ(21,"mat-form-field",8)(22,"mat-label"),e._uU(23,"Map Y"),e.qZA(),e.TgZ(24,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentSign.yPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().signChanged()}),e.qZA(),e.TgZ(25,"mat-hint"),e._uU(26),e.qZA()()(),e.TgZ(27,"mat-form-field",45)(28,"mat-label"),e._uU(29,"Movement Layer"),e.qZA(),e.TgZ(30,"mat-select",13),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentSign.movementLayer=o})("ngModelChange",function(){return e.CHM(t),e.oxw().signChanged()}),e.TgZ(31,"mat-option",24),e._uU(32,"0 - All Layers"),e.qZA(),e.TgZ(33,"mat-option",24),e._uU(34,"0 - Surf Only"),e.qZA(),e.TgZ(35,"mat-option",24),e._uU(36,"2 - Layer 1"),e.qZA(),e.TgZ(37,"mat-option",24),e._uU(38,"3 - Layer 2 (default)"),e.qZA(),e.TgZ(39,"mat-option",24),e._uU(40,"4 - Layer 3"),e.qZA(),e.TgZ(41,"mat-option",24),e._uU(42,"5 - Layer 4"),e.qZA(),e.TgZ(43,"mat-option",24),e._uU(44,"6 - Layer 5"),e.qZA(),e.TgZ(45,"mat-option",24),e._uU(46,"7 - Layer 6"),e.qZA(),e.TgZ(47,"mat-option",24),e._uU(48,"8 - Layer 7"),e.qZA(),e.TgZ(49,"mat-option",24),e._uU(50,"9 - Layer 8"),e.qZA(),e.TgZ(51,"mat-option",24),e._uU(52,"10 - Layer 9"),e.qZA(),e.TgZ(53,"mat-option",24),e._uU(54,"11 - Layer 10"),e.qZA(),e.TgZ(55,"mat-option",24),e._uU(56,"12 - Layer 11"),e.qZA(),e.TgZ(57,"mat-option",24),e._uU(58,"13 - Layer 12"),e.qZA(),e.TgZ(59,"mat-option",24),e._uU(60,"14 - Layer 13"),e.qZA(),e.TgZ(61,"mat-option",24),e._uU(62,"15 - Layer 14"),e.qZA()()(),e.TgZ(63,"mat-form-field",45)(64,"mat-label"),e._uU(65,"Sign Type"),e.qZA(),e.TgZ(66,"mat-select",13),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentSign.signType=o})("ngModelChange",function(){return e.CHM(t),e.oxw().signChanged()}),e.TgZ(67,"mat-option",24),e._uU(68,"0 - Script"),e.qZA(),e.TgZ(69,"mat-option",24),e._uU(70,"1 - Script (when player facing north)"),e.qZA(),e.TgZ(71,"mat-option",24),e._uU(72,"2 - Script (when player facing south)"),e.qZA(),e.TgZ(73,"mat-option",24),e._uU(74,"3 - Script (when player facing east)"),e.qZA(),e.TgZ(75,"mat-option",24),e._uU(76,"4 - Script (when player facing west)"),e.qZA(),e.TgZ(77,"mat-option",24),e._uU(78,"5 - Hidden Item"),e.qZA(),e.TgZ(79,"mat-option",24),e._uU(80,"6 - Hidden Item"),e.qZA(),e.TgZ(81,"mat-option",24),e._uU(82,"7 - Hidden Item"),e.qZA(),e.YNc(83,hc,2,1,"mat-option",46),e.qZA()(),e.YNc(84,uc,6,1,"mat-form-field",47),e.YNc(85,gc,20,5,"div",48),e.YNc(86,fc,2,1,"div",49),e.YNc(87,Cc,8,4,"div",50),e.qZA()}if(2&i){const t=e.oxw();e.xp6(9),e.Oqu(t.currentSign.uid),e.xp6(1),e.Q6J("ngClass",0==t.currentSign.uid?"text-gray":""),e.xp6(2),e.Q6J("ngClass",t.currentSign.uid==t.currentMap.entityData.signs.length-1?"text-gray":""),e.xp6(6),e.s9C("max",t.currentMap.layout.mapWidth),e.Q6J("ngModel",t.currentSign.xPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapWidth,""),e.xp6(4),e.s9C("max",t.currentMap.layout.mapHeight),e.Q6J("ngModel",t.currentSign.yPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapHeight,""),e.xp6(4),e.Q6J("ngModel",t.currentSign.movementLayer),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(2),e.Q6J("value",4),e.xp6(2),e.Q6J("value",5),e.xp6(2),e.Q6J("value",6),e.xp6(2),e.Q6J("value",7),e.xp6(2),e.Q6J("value",8),e.xp6(2),e.Q6J("value",9),e.xp6(2),e.Q6J("value",10),e.xp6(2),e.Q6J("value",11),e.xp6(2),e.Q6J("value",12),e.xp6(2),e.Q6J("value",13),e.xp6(2),e.Q6J("value",14),e.xp6(2),e.Q6J("value",15),e.xp6(5),e.Q6J("ngModel",t.currentSign.signType),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(2),e.Q6J("value",4),e.xp6(2),e.Q6J("value",5),e.xp6(2),e.Q6J("value",6),e.xp6(2),e.Q6J("value",7),e.xp6(2),e.Q6J("ngIf","BPEE"==t.gbaService.header.gameCode),e.xp6(1),e.Q6J("ngIf",!(5==t.currentSign.signType||6==t.currentSign.signType||7==t.currentSign.signType)),e.xp6(1),e.Q6J("ngIf",5==t.currentSign.signType||6==t.currentSign.signType||7==t.currentSign.signType),e.xp6(1),e.Q6J("ngIf",t.currentSign&&t.currentSign.data),e.xp6(1),e.Q6J("ngIf",!(5==t.currentSign.signType||6==t.currentSign.signType||7==t.currentSign.signType))}}function Sc(i,r){if(1&i&&(e.TgZ(0,"span",37)(1,"b"),e._uU(2),e.qZA()()),2&i){const t=r.$implicit;e.xp6(2),e.Oqu((1==t.toString(16).length?"0":"")+t.toString(16).toUpperCase()+" ")}}function Mc(i,r){if(1&i&&(e.TgZ(0,"div",55),e.YNc(1,Sc,3,1,"span",36),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.currentWarp.data)}}function Ac(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"p",2),e._uU(2,"You may edit existing entities. Adding new entities will be available soon."),e.qZA(),e.TgZ(3,"div",3)(4,"p",4)(5,"b"),e._uU(6,"Warp Entity"),e.qZA()(),e.TgZ(7,"div",5)(8,"span",6),e._uU(9),e.qZA(),e.TgZ(10,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityBackward()}),e._uU(11,"arrow_back"),e.qZA(),e.TgZ(12,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityForward()}),e._uU(13,"arrow_forward"),e.qZA()()(),e.TgZ(14,"div",44)(15,"mat-form-field",8)(16,"mat-label"),e._uU(17,"Map X"),e.qZA(),e.TgZ(18,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentWarp.xPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().warpChanged()}),e.qZA(),e.TgZ(19,"mat-hint"),e._uU(20),e.qZA()(),e.TgZ(21,"mat-form-field",8)(22,"mat-label"),e._uU(23,"Map Y"),e.qZA(),e.TgZ(24,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentWarp.yPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().warpChanged()}),e.qZA(),e.TgZ(25,"mat-hint"),e._uU(26),e.qZA()()(),e.TgZ(27,"mat-form-field",8)(28,"mat-label"),e._uU(29,"Destination Warp"),e.qZA(),e.TgZ(30,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentWarp.destinationWarp=o})("ngModelChange",function(){return e.CHM(t),e.oxw().warpChanged()}),e.qZA(),e.TgZ(31,"mat-hint"),e._uU(32,"0-255"),e.qZA()(),e.TgZ(33,"mat-form-field",8)(34,"mat-label"),e._uU(35,"Destination Bank"),e.qZA(),e.TgZ(36,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentWarp.destinationBank=o})("ngModelChange",function(){return e.CHM(t),e.oxw().warpChanged()}),e.qZA(),e.TgZ(37,"mat-hint"),e._uU(38,"0-255"),e.qZA()(),e.TgZ(39,"mat-form-field",8)(40,"mat-label"),e._uU(41,"Destination Map"),e.qZA(),e.TgZ(42,"input",9),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentWarp.destinationMap=o})("ngModelChange",function(){return e.CHM(t),e.oxw().warpChanged()}),e.qZA(),e.TgZ(43,"mat-hint"),e._uU(44,"0-255"),e.qZA()(),e.YNc(45,Mc,2,1,"div",54),e.qZA()}if(2&i){const t=e.oxw();e.xp6(9),e.Oqu(t.currentWarp.uid),e.xp6(1),e.Q6J("ngClass",0==t.currentWarp.uid?"text-gray":""),e.xp6(2),e.Q6J("ngClass",t.currentWarp.uid==t.currentMap.entityData.warps.length-1?"text-gray":""),e.xp6(6),e.s9C("max",t.currentMap.layout.mapWidth),e.Q6J("ngModel",t.currentWarp.xPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapWidth,""),e.xp6(4),e.s9C("max",t.currentMap.layout.mapHeight),e.Q6J("ngModel",t.currentWarp.yPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapHeight,""),e.xp6(4),e.Q6J("ngModel",t.currentWarp.destinationWarp),e.xp6(6),e.Q6J("ngModel",t.currentWarp.destinationBank),e.xp6(6),e.Q6J("ngModel",t.currentWarp.destinationMap),e.xp6(3),e.Q6J("ngIf",t.currentWarp&&t.currentWarp.data)}}function kc(i,r){if(1&i&&(e.TgZ(0,"span",37)(1,"b"),e._uU(2),e.qZA()()),2&i){const t=r.$implicit;e.xp6(2),e.Oqu((1==t.toString(16).length?"0":"")+t.toString(16).toUpperCase()+" ")}}function Zc(i,r){if(1&i&&(e.TgZ(0,"div",59),e.YNc(1,kc,3,1,"span",36),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.currentScript.data)}}function Ec(i,r){if(1&i&&(e.TgZ(0,"div",38)(1,"div",39),e._UZ(2,"div",40),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(1),e.Udp("height","194px")("max-height","194px"),e.Q6J("innerText",t.currentScript.script),e.xp6(1),e.Udp("bottom","0px")("left","0px")("height","25px")}}function Uc(i,r){1&i&&(e.TgZ(0,"div",41)(1,"div",42)(2,"p",18),e._uU(3,"No Script Found"),e.qZA()()()),2&i&&(e.xp6(1),e.Udp("height","194px")("max-height","194px"))}function Pc(i,r){if(1&i&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE("Showing ",t.currentScript.script.trim().split("\n").length>=10?"10":t.currentScript.script.trim().split("\n").length," out of ",t.currentScript.script.trim().split("\n").length," lines.")}}function Ic(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).editScript()}),e.TgZ(1,"span"),e._uU(2,"Edit Script"),e.qZA()()}}function Dc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"p",2),e._uU(2,"You may edit existing entities. Adding new entities will be available soon."),e.qZA(),e.TgZ(3,"div",3)(4,"p",4)(5,"b"),e._uU(6,"Script Entity"),e.qZA()(),e.TgZ(7,"div",5)(8,"span",6),e._uU(9),e.qZA(),e.TgZ(10,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityBackward()}),e._uU(11,"arrow_back"),e.qZA(),e.TgZ(12,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().setEntityForward()}),e._uU(13,"arrow_forward"),e.qZA()()(),e.TgZ(14,"div",44)(15,"mat-form-field",8)(16,"mat-label"),e._uU(17,"Map X"),e.qZA(),e.TgZ(18,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentScript.xPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().scriptChanged()}),e.qZA(),e.TgZ(19,"mat-hint"),e._uU(20),e.qZA()(),e.TgZ(21,"mat-form-field",8)(22,"mat-label"),e._uU(23,"Map Y"),e.qZA(),e.TgZ(24,"input",12),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentScript.yPosition=o})("ngModelChange",function(){return e.CHM(t),e.oxw().scriptChanged()}),e.qZA(),e.TgZ(25,"mat-hint"),e._uU(26),e.qZA()()(),e.TgZ(27,"mat-form-field",8)(28,"mat-label"),e._uU(29,"Variable Number"),e.qZA(),e.TgZ(30,"input",52),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentScript.varNumber=o})("ngModelChange",function(){return e.CHM(t),e.oxw().scriptChanged()}),e.qZA()(),e.TgZ(31,"mat-form-field",8)(32,"mat-label"),e._uU(33,"Variable Value"),e.qZA(),e.TgZ(34,"input",52),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentScript.varValue=o})("ngModelChange",function(){return e.CHM(t),e.oxw().scriptChanged()}),e.qZA()(),e.TgZ(35,"mat-form-field",8)(36,"mat-label"),e._uU(37,"Script Address"),e.qZA(),e.TgZ(38,"input",56),e.NdJ("change",function(o){e.CHM(t);const a=e.oxw();return a.currentScript.scriptAddress=a.getInputHexValue(o),a.scriptChanged()}),e.qZA(),e.TgZ(39,"mat-hint"),e._uU(40,"Hexidecimal big endian"),e.qZA()(),e.TgZ(41,"p",18)(42,"b"),e._uU(43,"Data"),e.qZA()(),e.YNc(44,Zc,2,1,"div",57),e.TgZ(45,"p",18)(46,"b"),e._uU(47,"Script"),e.qZA()(),e.YNc(48,Ec,3,11,"div",20),e.YNc(49,Uc,4,4,"div",21),e.YNc(50,Pc,2,2,"p",22),e.YNc(51,Ic,3,0,"button",58),e.qZA()}if(2&i){const t=e.oxw();e.xp6(9),e.Oqu(t.currentScript.uid),e.xp6(1),e.Q6J("ngClass",0==t.currentScript.uid?"text-gray":""),e.xp6(2),e.Q6J("ngClass",t.currentScript.uid==t.currentMap.entityData.scripts.length-1?"text-gray":""),e.xp6(6),e.s9C("max",t.currentMap.layout.mapWidth),e.Q6J("ngModel",t.currentScript.xPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapWidth,""),e.xp6(4),e.s9C("max",t.currentMap.layout.mapHeight),e.Q6J("ngModel",t.currentScript.yPosition),e.xp6(2),e.hij("0-",t.currentMap.layout.mapHeight,""),e.xp6(4),e.Q6J("ngModel",t.currentScript.varNumber),e.xp6(4),e.Q6J("ngModel",t.currentScript.varValue),e.xp6(4),e.Q6J("value",t.currentScript.scriptAddress.toString(16).toUpperCase()),e.xp6(6),e.Q6J("ngIf",t.currentScript&&t.currentScript.data),e.xp6(4),e.Q6J("ngIf",t.currentScript.script),e.xp6(1),e.Q6J("ngIf",!t.currentScript.script),e.xp6(1),e.Q6J("ngIf",t.currentScript.script),e.xp6(1),e.Q6J("ngIf",t.currentScript.script)}}let Bc=(()=>{class i{constructor(t,n,o,a,s,c,l){this.gbaService=t,this.overworldService=n,this.dialog=o,this.trainerService=a,this.scriptService=s,this.itemService=c,this.monsterService=l,this.currentEntityType="NPC",this.currentEntityId=0,this.entitySelected=new e.vpe,this.movementTypes=["No Movement","Look around","Walk around","Walk up and down","Walk up and down","Walk left and right","Walk left and right","Look up","Look down","Look left","Look right","Look down","Hidden","Look up and down","Look left and right","Look up and left","Look up and right","Look down and left","Look down and right","Look up, down and left","Look up, down and right","Look up, left and right","Look down, left and right","Look around counterclockwise","Look around clockwise","Run up and down","Run up and down","Run left and right","Run left and right","Run up, right, left and down","Run right, left, down and up","Run down, up, right and left","Run left, down, up and right","Run up, left, right and down","Run left, right, down and up","Run down, up, left and right","Run right, down, up and left","Run left, up, down and right","Run up, down, right and left","Run right, left, up and down","Run down, right, left and up","Run right, up, down and left","Run up, down, left and right","Run left, right, up and down","Run down, left, right and up","Run around counterclockwise","Run around counterclockwise","Run around counterclockwise","Run around counterclockwise","Run around counterclockwise","Run around clockwise","Run around clockwise","Run around clockwise","Copy Player","Mirror Player","Mirror Player","Mirror Player","Tree wall disguise","Rock wall disguise","Mirror player (standing)","Copy player (standing)","Mirror player (standing)","Mirror player (standing)","Hidden","Walk on the spot (Down)","Walk on the spot (Up)","Walk on the spot (Left)","Walk on the spot (Right)","Jog on the spot (Down)","Jog on the spot (Up)","Jog on the spot (Left)","Jog on the spot (Right)","Run on the spot (Down)","Run on the spot (Up)","Run on the spot (Left)","Run on the spot (Right)","Hidden","Walk on the spot (Down)","Walk on the spot (Up)","Walk on the spot (Left)","Walk on the spot (Right)"]}ngOnInit(){}npcSpriteChanged(){let t=0,n=!1;switch(this.currentNPC.movementType){case 7:t=1;break;case 8:case 11:t=0;break;case 9:t=2;break;case 10:t=2,n=!0}let o=this.overworldService.getOverworldSprite(255&this.currentNPC.spriteId,t),a=document.createElement("canvas");a.width=o.width,a.height=o.height;let s=a.getContext("2d");n&&o.width<=32?(s.save(),s.translate(a.width,0),s.scale(-1,1),s.drawImage(o,0,0),s.restore()):(s.save(),s.drawImage(o,0,0),s.restore()),this.currentNPC.overworldSprite=a}npcChanged(){this.npcSpriteChanged();let t=new w.jo;t.key=this.currentNPC.address+"-changed",t.changeReason=this.currentMap.label+" NPC Data Changed",t.address=this.currentNPC.address,t.bytesBefore=this.currentNPC.data;let n=new ArrayBuffer(24),o=new DataView(n);o.setUint8(0,this.currentNPC.npcIndex),o.setUint8(1,this.currentNPC.spriteId),o.setUint8(2,t.bytesBefore[2]),o.setUint8(3,t.bytesBefore[3]),o.setUint16(4,this.currentNPC.xPosition,!0),o.setUint16(6,this.currentNPC.yPosition,!0),o.setUint8(8,t.bytesBefore[8]),o.setUint8(9,this.currentNPC.movementType),o.setUint8(10,this.currentNPC.movementParam),o.setUint8(11,t.bytesBefore[11]),o.setUint8(12,this.currentNPC.isTrainer?1:0),o.setUint8(13,t.bytesBefore[13]),o.setUint16(14,this.currentNPC.viewRadius,!0),o.setUint32(16,this.currentNPC.scriptAddress>0?this.gbaService.toPointer(this.currentNPC.scriptAddress):0,!0),o.setUint16(20,this.currentNPC.personId,!0),o.setUint8(22,t.bytesBefore[22]),o.setUint8(23,t.bytesBefore[23]),t.bytesToWrite=new Uint8Array(n),this.gbaService.queueChange(t)}signChanged(){let t=new w.jo;t.key=this.currentSign.address+"-changed",t.changeReason=this.currentMap.label+" Sign Data Changed",t.address=this.currentSign.address,t.bytesBefore=this.currentSign.data;let n=new ArrayBuffer(12),o=new DataView(n);o.setUint16(0,this.currentSign.xPosition,!0),o.setUint16(2,this.currentSign.yPosition,!0),o.setUint8(4,this.currentSign.movementLayer),o.setUint8(5,this.currentSign.signType),o.setUint8(6,t.bytesBefore[6]),o.setUint8(7,t.bytesBefore[7]),5==this.currentSign.signType||6==this.currentSign.signType||7==this.currentSign.signType?(o.setUint16(8,this.currentSign.hiddenItemId,!0),o.setUint8(9,this.currentSign.globalHiddenIndex),o.setUint8(10,this.currentSign.hiddenItemAmount)):o.setUint32(8,this.gbaService.toPointer(this.currentSign.scriptAddress),!0),t.bytesToWrite=new Uint8Array(n),this.gbaService.queueChange(t)}warpChanged(){let t=new w.jo;t.key=this.currentWarp.address+"-changed",t.changeReason=this.currentMap.label+" Warp Data Changed",t.address=this.currentWarp.address,t.bytesBefore=this.currentWarp.data;let n=new ArrayBuffer(8),o=new DataView(n);o.setUint16(0,this.currentWarp.xPosition,!0),o.setUint16(2,this.currentWarp.yPosition,!0),o.setUint8(4,t.bytesBefore[4]),o.setUint8(5,this.currentWarp.destinationWarp),o.setUint8(6,this.currentWarp.destinationMap),o.setUint8(7,this.currentWarp.destinationBank),t.bytesToWrite=new Uint8Array(n),this.gbaService.queueChange(t)}scriptChanged(){let t=new w.jo;t.key=this.currentScript.address+"-changed",t.changeReason=this.currentMap.label+" Script Data Changed",t.address=this.currentScript.address,t.bytesBefore=this.currentScript.data;let n=new ArrayBuffer(16),o=new DataView(n);o.setUint16(0,this.currentScript.xPosition,!0),o.setUint16(2,this.currentScript.yPosition,!0),o.setUint8(4,t.bytesBefore[4]),o.setUint8(5,t.bytesBefore[5]),o.setUint16(6,this.currentScript.varNumber,!0),o.setUint16(8,this.currentScript.varValue,!0),o.setUint8(10,t.bytesBefore[10]),o.setUint8(11,t.bytesBefore[11]),o.setUint32(12,this.gbaService.toPointer(this.currentScript.scriptAddress),!0),t.bytesToWrite=new Uint8Array(n),this.gbaService.queueChange(t)}getInputHexValue(t){let n=t.target.value,a=0;return/[0-9A-Fa-f]{6}/g.test(n)&&(a=Number.parseInt(n,16)),a}goToTrainer(t){this.gbaService.toolSwitched.emit({tool:"trainerTool"}),this.trainerService.trainerIndexChanged.emit(t)}editScript(){switch(this.currentEntityType){case"NPC":this.dialog.open(Ue,{data:{address:this.currentNPC.scriptAddress}});break;case"SIGN":this.dialog.open(Ue,{data:{address:this.currentSign.scriptAddress}});break;case"SCRIPT":this.dialog.open(Ue,{data:{address:this.currentScript.scriptAddress}})}}setCurrentEntity(t,n){this.currentEntityId=t,this.currentEntityType=n,this.entitySelected.emit({id:t,type:n})}setEntityForward(){switch(this.currentEntityType){case"NPC":if(this.currentNPC.uid+1>=this.currentMap.entityData.npcs.length)return;this.setCurrentEntity(this.currentNPC.uid+1,"NPC");break;case"SIGN":if(this.currentSign.uid+1>=this.currentMap.entityData.signs.length)return;this.setCurrentEntity(this.currentSign.uid+1,"SIGN");break;case"WARP":if(this.currentWarp.uid+1>=this.currentMap.entityData.warps.length)return;this.setCurrentEntity(this.currentWarp.uid+1,"WARP");break;case"SCRIPT":if(this.currentScript.uid+1>=this.currentMap.entityData.scripts.length)return;this.setCurrentEntity(this.currentScript.uid+1,"SCRIPT")}}setEntityBackward(){switch(this.currentEntityType){case"NPC":if(this.currentNPC.uid-1<0)return;this.setCurrentEntity(this.currentNPC.uid-1,"NPC");break;case"SIGN":if(this.currentSign.uid-1<0)return;this.setCurrentEntity(this.currentSign.uid-1,"SIGN");break;case"WARP":if(this.currentWarp.uid-1<0)return;this.setCurrentEntity(this.currentWarp.uid-1,"WARP");break;case"SCRIPT":if(this.currentScript.uid-1<0)return;this.setCurrentEntity(this.currentScript.uid-1,"SCRIPT")}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.VP),e.Y36(he.mY),e.Y36(Z.uw),e.Y36(Ot.hc),e.Y36(Bt),e.Y36(Ft.e),e.Y36(Ze.hP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-entity-minitool"]],inputs:{currentMap:"currentMap",currentEntityType:"currentEntityType",currentEntityId:"currentEntityId",currentNPC:"currentNPC",currentSign:"currentSign",currentWarp:"currentWarp",currentScript:"currentScript"},outputs:{entitySelected:"entitySelected"},decls:4,vars:4,consts:[["class","position-relative p-3",4,"ngIf"],[1,"position-relative","p-3"],[1,"mb-3","text-gray"],[1,"poke-border-sm","bg-gray","p-2","mb-3","w-100","d-inline-flex","align-items-center","justify-content-between"],[1,"mb-0"],[1,"d-inline-flex","align-items-center"],[1,"mr-2"],[1,"cursor-pointer",3,"ngClass","click"],["appearance","fill",1,"w-100","mb-2"],["type","number","min","0","max","255","matInput","","placeholder","0",3,"ngModel","ngModelChange"],[1,"row"],[1,"col-6"],["type","number","min","0","matInput","","placeholder","0",3,"max","ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","mb-3 p-2 bg-gray",4,"ngFor","ngForOf"],[1,"w-100","mb-2","mb-3","d-inline-flex","align-items-center"],["type","text","min","0","max","255","matInput","","placeholder","0",3,"value","change"],[1,"mb-1"],["class","bg-gray p-2 mb-3",4,"ngIf"],["class","bg-gray p-2 mb-0 overflow-hidden hex-value",4,"ngIf"],["class","bg-gray p-2 mb-0",4,"ngIf"],["class","text-gray mb-1",4,"ngIf"],["mat-raised-button","","type","button","color","primary","class","w-100",3,"click",4,"ngIf"],[3,"value"],[1,"mb-3","p-2","bg-gray"],[1,"w-100","d-inline-flex","align-items-center","justify-content-between","mb-2"],[1,"d-flex","flex-column"],[1,"d-inline-flex"],[4,"ngFor","ngForOf"],["width","64px","height","64px",3,"src",4,"ngIf"],["mat-raised-button","","type","button","color","primary",1,"w-100",3,"click"],["width","32px","height","32px",3,"src",4,"ngIf"],["width","32px","height","32px",3,"src"],["width","64px","height","64px",3,"src"],[1,"bg-gray","p-2","mb-3"],["class","mr-2 mb-1 hex-value",4,"ngFor","ngForOf"],[1,"mr-2","mb-1","hex-value"],[1,"bg-gray","p-2","mb-0","overflow-hidden","hex-value"],[1,"w-100","text-nowrap",3,"innerText"],[1,"position-absolute","w-100","script-fadeout"],[1,"bg-gray","p-2","mb-0"],[1,"w-100","overflow-hidden"],[1,"text-gray","mb-1"],[1,"d-flex-inline","justify-content-between"],["appearance","fill",1,"w-100"],[3,"value",4,"ngIf"],["class","w-100 mb-2","appearance","fill",4,"ngIf"],["class","w-100",4,"ngIf"],["class","bg-gray p-2 mb-5",4,"ngIf"],[4,"ngIf"],[1,"w-100"],["type","number","min","0","matInput","","placeholder","0",3,"ngModel","ngModelChange"],[1,"bg-gray","p-2","mb-5"],["class","bg-gray p-2",4,"ngIf"],[1,"bg-gray","p-2"],["type","text","matInput","","placeholder","0",3,"value","change"],["class","bg-gray p-2 mb-2",4,"ngIf"],["mat-raised-button","","type","button","color","primary","class","w-100","disabled","",3,"click",4,"ngIf"],[1,"bg-gray","p-2","mb-2"],["mat-raised-button","","type","button","color","primary","disabled","",1,"w-100",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,xc,88,24,"div",0),e.YNc(1,wc,88,40,"div",0),e.YNc(2,Ac,46,13,"div",0),e.YNc(3,Dc,52,17,"div",0)),2&t&&(e.Q6J("ngIf",n.currentMap&&"NPC"==n.currentEntityType&&n.currentNPC),e.xp6(1),e.Q6J("ngIf",n.currentMap&&"SIGN"==n.currentEntityType&&n.currentSign),e.xp6(1),e.Q6J("ngIf",n.currentMap&&"WARP"==n.currentEntityType&&n.currentWarp),e.xp6(1),e.Q6J("ngIf",n.currentMap&&"SCRIPT"==n.currentEntityType&&n.currentScript))},directives:[_.O5,z.Hw,_.mk,S.KE,S.hX,g.qQ,g.Fd,g.wV,re.Nt,g.Fj,g.JJ,g.On,S.bx,U.gD,_.sg,A.ey,O.lW,Lt.oG],pipes:[_.rS],styles:[""]}),i})();function Fc(i,r){if(1&i&&(e.TgZ(0,"div",5)(1,"p",6),e._uU(2),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("This map has no ",t.currentEncounterType.toLowerCase()," encounters. Adding new encounters will be available soon.")}}function Oc(i,r){if(1&i&&(e.TgZ(0,"mat-option",3),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",r.index),e.xp6(1),e.hij(" ",t.name," ")}}function Nc(i,r){if(1&i&&e._UZ(0,"img",16),2&i){const t=e.oxw().$implicit;e.Q6J("src",t.spriteCanvas,e.LSH)}}function Lc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"div",10)(2,"mat-form-field",1)(3,"mat-label"),e._uU(4),e.qZA(),e.TgZ(5,"mat-select",2),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.monsterId=o})("ngModelChange",function(){const a=e.CHM(t).$implicit,s=e.oxw(3);return s.updateEncounterSprites(),s.encounterChanged(a)}),e.YNc(6,Oc,2,2,"mat-option",11),e.qZA()(),e.YNc(7,Nc,1,1,"img",12),e.qZA(),e.TgZ(8,"div",13)(9,"div",14)(10,"mat-form-field",1)(11,"mat-label"),e._uU(12,"Min. Level"),e.qZA(),e.TgZ(13,"input",15),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.minLevel=o})("ngModelChange",function(){const a=e.CHM(t).$implicit;return e.oxw(3).encounterChanged(a)}),e.qZA(),e.TgZ(14,"mat-hint"),e._uU(15,"0-100"),e.qZA()()(),e.TgZ(16,"div",14)(17,"mat-form-field",1)(18,"mat-label"),e._uU(19,"Max. Level"),e.qZA(),e.TgZ(20,"input",15),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.maxLevel=o})("ngModelChange",function(){const a=e.CHM(t).$implicit;return e.oxw(3).encounterChanged(a)}),e.qZA(),e.TgZ(21,"mat-hint"),e._uU(22,"0-100"),e.qZA()()()()()}if(2&i){const t=r.$implicit,n=r.index,o=e.oxw(3);e.xp6(4),e.hij("Monster ",n+1,""),e.xp6(1),e.Q6J("ngModel",t.monsterId),e.xp6(1),e.Q6J("ngForOf",o.monsterService.monsters),e.xp6(1),e.Q6J("ngIf",t.spriteCanvas),e.xp6(6),e.Q6J("ngModel",t.minLevel),e.xp6(7),e.Q6J("ngModel",t.maxLevel)}}function Jc(i,r){if(1&i&&(e.TgZ(0,"div",5),e.YNc(1,Lc,23,6,"div",8),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function qc(i,r){if(1&i&&(e.TgZ(0,"div",5)(1,"p",6),e._uU(2,"You may edit existing encounters. Adding new encounters will be available soon."),e.qZA(),e.YNc(3,Jc,2,1,"div",7),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.currentMap.encounterData.getTypeList(t.currentEncounterType).wildMonsters)}}let Rc=(()=>{class i{constructor(t,n){this.gbaService=t,this.monsterService=n,this.currentEncounterType="GRASS"}ngOnInit(){this.currentMap&&this.onMapChange()}ngOnChanges(t){t&&t.currentMap&&this.onMapChange()}encounterChanged(t){let n=new w.jo;n.key=t.address+"-changed",n.changeReason=this.currentMap.label+" Encounter Data Changed",n.address=t.address,n.bytesBefore=t.monsterData;let o=new ArrayBuffer(4),a=new DataView(o);a.setUint8(0,t.minLevel),a.setUint8(1,t.maxLevel),a.setUint16(2,t.monsterId,!0),n.bytesToWrite=new Uint8Array(o),this.gbaService.queueChange(n)}onMapChange(){this.updateEncounterSprites()}updateEncounterSprites(){for(let t=0;t<this.currentMap.encounterData.encounterTypeGroups.length;t++)for(let n=0;n<this.currentMap.encounterData.encounterTypeGroups[t].wildMonsters.length;n++)for(let o=0;o<this.currentMap.encounterData.encounterTypeGroups[t].wildMonsters[n].length;o++){let a=this.currentMap.encounterData.encounterTypeGroups[t].wildMonsters[n][o];a.spriteCanvas=this.monsterService.loadBattleSprite(a.monsterId,!0,!1)}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.VP),e.Y36(Ze.hP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-encounter-minitool"]],inputs:{currentMap:"currentMap",currentEncounterType:"currentEncounterType"},features:[e.TTD],decls:15,vars:7,consts:[[1,"w-100","p-3"],["appearance","fill",1,"w-100"],[3,"ngModel","ngModelChange"],[3,"value"],["class","w-100",4,"ngIf"],[1,"w-100"],[1,"mb-3","text-gray"],["class","w-100",4,"ngFor","ngForOf"],["class","border poke-border-sm mb-3 pt-3 px-3",4,"ngFor","ngForOf"],[1,"border","poke-border-sm","mb-3","pt-3","px-3"],[1,"d-inline-flex","w-100","align-items-center"],[3,"value",4,"ngFor","ngForOf"],["width","64px","height","64px","class","ml-3",3,"src",4,"ngIf"],[1,"row"],[1,"col-6"],["type","number","min","0","max","100","matInput","","placeholder","0",3,"ngModel","ngModelChange"],["width","64px","height","64px",1,"ml-3",3,"src"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-label"),e._uU(3,"Encounter Type"),e.qZA(),e.TgZ(4,"mat-select",2),e.NdJ("ngModelChange",function(a){return n.currentEncounterType=a}),e.TgZ(5,"mat-option",3),e._uU(6,"Grass"),e.qZA(),e.TgZ(7,"mat-option",3),e._uU(8,"Surf"),e.qZA(),e.TgZ(9,"mat-option",3),e._uU(10,"Tree"),e.qZA(),e.TgZ(11,"mat-option",3),e._uU(12,"Fishing"),e.qZA()()(),e.YNc(13,Fc,3,1,"div",4),e.YNc(14,qc,4,1,"div",4),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngModel",n.currentEncounterType),e.xp6(1),e.Q6J("value","GRASS"),e.xp6(2),e.Q6J("value","SURF"),e.xp6(2),e.Q6J("value","TREE"),e.xp6(2),e.Q6J("value","FISHING"),e.xp6(2),e.Q6J("ngIf",!n.currentMap.encounterData.containsType(n.currentEncounterType)),e.xp6(1),e.Q6J("ngIf",n.currentMap.encounterData.containsType(n.currentEncounterType)))},directives:[S.KE,S.hX,U.gD,g.JJ,g.On,A.ey,_.O5,_.sg,g.qQ,g.Fd,g.wV,re.Nt,g.Fj,S.bx],styles:[""]}),i})();function Qc(i,r){if(1&i&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&i){const n=r.index;e.Q6J("value",r.$implicit),e.xp6(1),e.Oqu(n)}}function Wc(i,r){if(1&i&&(e.TgZ(0,"span",27)(1,"b"),e._uU(2),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.label)}}function Hc(i,r){1&i&&(e.TgZ(0,"span",27)(1,"b")(2,"em"),e._uU(3,"Nameless Map"),e.qZA()()())}function jc(i,r){if(1&i&&(e.TgZ(0,"mat-option",25)(1,"span"),e._uU(2),e.qZA(),e.YNc(3,Wc,3,1,"span",26),e.YNc(4,Hc,4,0,"span",26),e.qZA()),2&i){const t=r.$implicit,n=r.index;e.Q6J("value",t),e.xp6(2),e.Oqu(n+" - "),e.xp6(1),e.Q6J("ngIf",t.label),e.xp6(1),e.Q6J("ngIf",!t.label)}}function Yc(i,r){if(1&i&&e._UZ(0,"img",51),2&i){const t=e.oxw(3);e.Udp("width",2*t.currentPaintBlockCanvas.width+"px")("height",2*t.currentPaintBlockCanvas.height+"px")("z-index",15),e.Q6J("src",t.currentPaintBlockCanvas.toDataURL(),e.LSH)}}function zc(i,r){if(1&i&&(e.TgZ(0,"div",49),e.YNc(1,Yc,1,7,"img",50),e.qZA()),2&i){const t=e.oxw(2);e.Udp("width","32px")("height","32px"),e.xp6(1),e.Q6J("ngIf",t.currentPaintBlockCanvas.toDataURL())}}function Gc(i,r){if(1&i&&(e.TgZ(0,"div",49)(1,"div"),e._uU(2),e.qZA()()),2&i){const t=e.oxw(2);e.Udp("width","32px")("height","32px"),e.xp6(1),e.Gre("d-flex justify-content-center align-items-center position-absolute meta-bg-",t.getMovement(t.currentMovementId).type,""),e.Udp("width",2*t.currentPaintBlockCanvas.width+"px")("height",2*t.currentPaintBlockCanvas.height+"px"),e.xp6(1),e.hij(" ",t.currentMovementId.toString(16).toUpperCase()," ")}}function Vc(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1," N/A "),e.qZA())}function Xc(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-map-renderer",52),e.NdJ("blockClicked",function(o){return e.CHM(t),e.oxw(2).blockClicked(o.col,o.row)})("entitySelected",function(o){return e.CHM(t),e.oxw(2).setCurrentEntity(o.id,o.type)}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("currentWorldTool",t.currentWorldTool)("currentMap",t.currentMap)("zoom",t.zoom)("isAnimatingTiles",t.isAnimatingTiles)("isShowingOverworlds",t.isShowingOverworlds)("currentEntityType",t.currentEntityType)("currentEntityId",t.currentEntityId)("currentNPC",t.currentNPC)("currentSign",t.currentSign)("currentWarp",t.currentWarp)("currentScript",t.currentScript)}}function Kc(i,r){if(1&i&&e._UZ(0,"app-header-tool",53),2&i){const t=e.oxw(2);e.Q6J("currentMap",t.currentMap)}}function $c(i,r){if(1&i&&e._UZ(0,"app-layout-tool",53),2&i){const t=e.oxw(2);e.Q6J("currentMap",t.currentMap)}}function e0(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",28)(1,"div",29)(2,"div",30)(3,"div",31)(4,"div",32)(5,"mat-button-toggle-group",33,34),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().currentWorldTool=o})("ngModelChange",function(){return e.CHM(t),e.oxw().onToolUpdated()}),e.TgZ(7,"mat-button-toggle",35),e._uU(8,"Tiles"),e.qZA(),e.TgZ(9,"mat-button-toggle",36),e._uU(10,"Movement"),e.qZA(),e.TgZ(11,"mat-button-toggle",37),e._uU(12,"Entities"),e.qZA(),e.TgZ(13,"mat-button-toggle",38),e._uU(14,"Encounters"),e.qZA(),e.TgZ(15,"mat-button-toggle",39),e._uU(16,"Header"),e.qZA(),e.TgZ(17,"mat-button-toggle",40),e._uU(18,"Layout"),e.qZA()()()(),e.TgZ(19,"div",41)(20,"div",42)(21,"div",43)(22,"span",44)(23,"b"),e._uU(24,"Painting"),e.qZA()(),e.YNc(25,zc,2,5,"div",45),e.YNc(26,Gc,3,12,"div",45),e.YNc(27,Vc,2,0,"div",46),e.qZA()()()()(),e.YNc(28,Xc,1,11,"app-map-renderer",47),e.YNc(29,Kc,1,1,"app-header-tool",48),e.YNc(30,$c,1,1,"app-layout-tool",48),e.qZA()}if(2&i){const t=e.oxw();e.xp6(5),e.Udp("min-width","360px"),e.Q6J("ngModel",t.currentWorldTool),e.xp6(16),e.Udp("width","128px")("min-height","32px"),e.xp6(4),e.Q6J("ngIf","tiles"==t.currentWorldTool),e.xp6(1),e.Q6J("ngIf","movement"==t.currentWorldTool),e.xp6(1),e.Q6J("ngIf","tiles"!==t.currentWorldTool&&"movement"!==t.currentWorldTool),e.xp6(1),e.Q6J("ngIf","header"!==t.currentWorldTool&&"layout"!==t.currentWorldTool),e.xp6(1),e.Q6J("ngIf","header"===t.currentWorldTool),e.xp6(1),e.Q6J("ngIf","layout"===t.currentWorldTool)}}function t0(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleMinitoolPopup()}),e.TgZ(1,"mat-icon"),e._uU(2,"chrome_reader_mode"),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("disabled","header"===t.currentWorldTool||"layout"===t.currentWorldTool)}}function n0(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-blockset-minitool",55),e.NdJ("blockSelected",function(o){return e.CHM(t),e.oxw().paintBlockSelected(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("isOpen",t.isMinitoolPopupOpen)("currentMap",t.currentMap)("zoom",t.zoom)("currentPaintBlockId",t.currentPaintBlockId)}}function i0(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-movement-minitool",56),e.NdJ("movementSelected",function(o){return e.CHM(t),e.oxw().currentMovementId=o}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("currentMovementId",t.currentMovementId)}}function o0(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-entity-minitool",57),e.NdJ("entitySelected",function(o){return e.CHM(t),e.oxw().setCurrentEntity(o.id,o.type)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("currentMap",t.currentMap)("currentEntityType",t.currentEntityType)("currentEntityId",t.currentEntityId)("currentNPC",t.currentNPC)("currentSign",t.currentSign)("currentWarp",t.currentWarp)("currentScript",t.currentScript)}}function r0(i,r){if(1&i&&e._UZ(0,"app-encounter-minitool",58),2&i){const t=e.oxw();e.Q6J("currentMap",t.currentMap)("currentEncounterType",t.currentEncounterType)}}const a0=[{path:"",component:(()=>{class i{constructor(t,n,o,a,s,c,l,p,d,h,x,u){this.gbaService=t,this.worldService=n,this.changeDetector=o,this.bitmapService=a,this.scriptService=s,this.dialog=c,this.overworldService=l,this.zone=p,this.itemService=d,this.monsterService=h,this.trainerService=x,this.viewportService=u,this.currentWorldTool="tiles",this.currentBankId=0,this.currentMap=new Oe,this.currentMovementId=12,this.currentPaintBlockId=0,this.currentHoverBlockId=0,this.currentMetaId=0,this.currentEntityType="NPC",this.currentEntityId=0,this.currentOverlays=[],this.currentOverlayCache=new Map,this.defaultBank=0,this.defaultMap=0,this.isShowingOverworlds=!0,this.isMouseDown=!1,this.zoom=2,this.animatedTileIndexes=[],this.isDrawingBlockset=!1,this.currentEncounterType="GRASS",this.isAnimatingTiles=!1,this.isBlocksetRendered=!1,this.isBlockChanged=!1,this.isMinitoolAvailable=!1,this.isMinitoolPopupOpen=!1,this.movements=[{id:0,title:"All Movement",color:"#0000ffb3",layer:"Transition",type:"allowed"},{id:1,title:"Obstacle",color:"#ff0000b3",layer:"All Layers",type:"restricted"},{id:4,title:"Surf Only",color:"#ff00ffb3",layer:"Surfing",type:"allowed"},{id:5,title:"Obstacle",color:"#ffff00b3",layer:"Layer 0",type:"restricted"},{id:8,title:"All Movement",color:"#808000b3",layer:"Layer 1",type:"allowed"},{id:9,title:"Obstacle",color:"#008000b3",layer:"Layer 1",type:"restricted"},{id:12,title:"All Movement",color:"#800080b3",layer:"Layer 2 (default)",type:"allowed"},{id:13,title:"Obstacle",color:"#ff0080b3",layer:"Layer 2 (default)",type:"restricted"},{id:16,title:"All Movement",color:"#4aa22db3",layer:"Layer 3",type:"allowed"},{id:17,title:"Obstacle",color:"#1ae64db3",layer:"Layer 3",type:"restricted"},{id:20,title:"All Movement",color:"#005300b3",layer:"Layer 4",type:"allowed"},{id:21,title:"Obstacle",color:"#7da6bdb3",layer:"Layer 4",type:"restricted"},{id:24,title:"All Movement",color:"#156a62b3",layer:"Layer 5",type:"allowed"},{id:25,title:"Obstacle",color:"#ab2951b3",layer:"Layer 5",type:"restricted"},{id:28,title:"All Movement",color:"#7035bfb3",layer:"Layer 6",type:"allowed"},{id:29,title:"Obstacle",color:"#6175d6b3",layer:"Layer 6",type:"restricted"},{id:32,title:"All Movement",color:"#ffff00b3",layer:"Layer 7",type:"allowed"},{id:33,title:"Obstacle",color:"#658040b3",layer:"Layer 7",type:"restricted"},{id:36,title:"All Movement",color:"#4e70f8b3",layer:"Layer 8",type:"allowed"},{id:37,title:"Obstacle",color:"#3159a4b3",layer:"Layer 8",type:"restricted"},{id:40,title:"All Movement",color:"#b4de21b3",layer:"Layer 9",type:"allowed"},{id:41,title:"Obstacle",color:"#f54b50b3",layer:"Layer 9",type:"restricted"},{id:44,title:"All Movement",color:"#1eac68b3",layer:"Layer 10",type:"allowed"},{id:45,title:"Obstacle",color:"#be7641b3",layer:"Layer 10",type:"restricted"},{id:48,title:"All Movement",color:"#14eba5b3",layer:"Layer 11",type:"allowed"},{id:49,title:"Obstacle",color:"#804040b3",layer:"Layer 11",type:"restricted"},{id:52,title:"All Movement",color:"#c8ab37b3",layer:"Layer 12",type:"allowed"},{id:53,title:"Obstacle",color:"#3ec165b3",layer:"Layer 12",type:"restricted"},{id:56,title:"All Movement",color:"#00ffffb3",layer:"Layer 13",type:"allowed"},{id:57,title:"Obstacle",color:"#bc0ac0b3",layer:"Layer 13",type:"restricted"},{id:60,title:"Depends on Surrounding Blocks",color:"#5355acb3",layer:"Layer Varies",type:"wildcard"}],this.movementTypes=["No Movement","Look around","Walk around","Walk up and down","Walk up and down","Walk left and right","Walk left and right","Look up","Look down","Look left","Look right","Look down","Hidden","Look up and down","Look left and right","Look up and left","Look up and right","Look down and left","Look down and right","Look up, down and left","Look up, down and right","Look up, left and right","Look down, left and right","Look around counterclockwise","Look around clockwise","Run up and down","Run up and down","Run left and right","Run left and right","Run up, right, left and down","Run right, left, down and up","Run down, up, right and left","Run left, down, up and right","Run up, left, right and down","Run left, right, down and up","Run down, up, left and right","Run right, down, up and left","Run left, up, down and right","Run up, down, right and left","Run right, left, up and down","Run down, right, left and up","Run right, up, down and left","Run up, down, left and right","Run left, right, up and down","Run down, left, right and up","Run around counterclockwise","Run around counterclockwise","Run around counterclockwise","Run around counterclockwise","Run around counterclockwise","Run around clockwise","Run around clockwise","Run around clockwise","Copy Player","Mirror Player","Mirror Player","Mirror Player","Tree wall disguise","Rock wall disguise","Mirror player (standing)","Copy player (standing)","Mirror player (standing)","Mirror player (standing)","Hidden","Walk on the spot (Down)","Walk on the spot (Up)","Walk on the spot (Left)","Walk on the spot (Right)","Jog on the spot (Down)","Jog on the spot (Up)","Jog on the spot (Left)","Jog on the spot (Right)","Run on the spot (Down)","Run on the spot (Up)","Run on the spot (Left)","Run on the spot (Right)","Hidden","Walk on the spot (Down)","Walk on the spot (Up)","Walk on the spot (Left)","Walk on the spot (Right)"]}ngOnInit(){(!this.monsterService.monsters||0==this.monsterService.monsters.length)&&this.monsterService.loadMonsters(),(!this.trainerService.trainers||0==this.trainerService.trainers.length)&&this.trainerService.loadTrainers(),(!this.itemService.items||0==this.itemService.items.length)&&this.itemService.loadItems(),this.currentBlocksetCanvas=document.createElement("canvas"),this.currentBlocksetContext=this.currentBlocksetCanvas.getContext("2d"),this.currentPaintBlockCanvas=document.createElement("canvas"),this.currentPaintBlockContext=this.currentPaintBlockCanvas.getContext("2d"),this.viewportService.isMedium&&(this.isMinitoolPopupOpen=!0),this.gbaService.isLoaded()&&this.loadWorld(),this.gbaService.romLoaded.subscribe(()=>{this.loadWorld()}),this.dialog.afterOpened.subscribe(()=>{this.isMinitoolAvailable=!1,this.isMinitoolPopupOpen=!1}),this.dialog.afterAllClosed.subscribe(()=>{this.onToolUpdated()})}toggleMinitoolPopup(){this.isMinitoolPopupOpen=!this.isMinitoolPopupOpen}changeZoom(){this.zoom<3?this.zoom++:this.zoom=1}loadWorld(){return(0,ie.mG)(this,void 0,void 0,function*(){this.defaultBank=this.gbaService.constants().DEFAULT_MAP.split(".")[0],this.defaultMap=this.gbaService.constants().DEFAULT_MAP.split(".")[1],0==this.worldService.maps.length&&this.worldService.loadWorld(),this.worldService.isLoaded=!0,this.setCurrentBank(this.worldService.maps[this.defaultBank]),this.currentMap.header||this.setCurrent(this.worldService.maps[this.defaultBank][this.defaultMap],this.defaultBank,this.defaultMap),this.gbaService.markLoaded()})}setCurrent(t,n,o){let a=Date.now();if(n||(n=t.bankId),o||(o=t.mapId),this.currentMap&&this.currentMap.blockset&&(this.stopTileAnimations(),this.currentMap.blockset.primaryTileset.tileCache.clear(),this.currentMap.blockset.secondaryTileset.tileCache.clear(),this.worldRenderRef&&cancelAnimationFrame(this.worldRenderRef)),this.currentMap=this.worldService.getMap(n,o),this.currentMap.blockset.isLoaded=!0,this.currentMap.encounterData&&this.currentMap.encounterData.encounterTypeGroups&&this.currentMap.encounterData.encounterTypeGroups.length>0){for(let c=0;c<this.currentMap.encounterData.encounterTypeGroups.length;c++){this.currentEncounterType=this.currentMap.encounterData.encounterTypeGroups[c].type;break}this.updateEncounterSprites()}setTimeout(()=>{let c=Date.now();this.worldService.loadBlockCache(this.currentMap),this.changeDetector.detectChanges();let l=Date.now();console.log("Loaded tile cache in "+((l-c)/1e3).toFixed(1)+" seconds"),this.worldService.getDoorset(0,this.currentMap.layout.primaryTileset.palettes),this.animatedTileIndexes=this.currentMap.blockset.getAnimatedTileIndexes(this.currentMap.blockset.primaryTileset.index,this.currentMap.blockset.secondaryTileset.index);for(let p=0;p<this.animatedTileIndexes.length;p++)for(let d=0;d<this.animatedTileIndexes[p].length;d++){for(const[h,x]of this.currentMap.blockset.primaryTileset.tileCache.entries()){let u=x;if(u.tileId>0&&u.tileId==this.animatedTileIndexes[p][d]&&1==u.bitmap.bitmapFrames.length){let m=this.currentMap.blockset.getAnimatedTile(this.currentMap.blockset.primaryTileset.index,u.tileId,this.currentMap.blockset.primaryTileset.palettes,u.paletteId,u.xFlip,u.yFlip);if(m){u.bitmap.bitmapFrames=[];for(let f=0;f<m.animation.bitmapFrames.length;f++)u.bitmap.bitmapFrames.push(m.animation.bitmapFrames[f])}}}for(const[h,x]of this.currentMap.blockset.secondaryTileset.tileCache.entries()){let u=x;if(u.tileId>0&&u.tileId==this.animatedTileIndexes[p][d]&&1==u.bitmap.bitmapFrames.length){let m=this.currentMap.blockset.getAnimatedTile(this.currentMap.blockset.secondaryTileset.index,u.tileId,this.currentMap.blockset.primaryTileset.palettes,u.paletteId,u.xFlip,u.yFlip,this.currentMap.blockset.primaryTileset.index);if(m){u.bitmap.bitmapFrames=[];for(let f=0;f<m.animation.bitmapFrames.length;f++)u.bitmap.bitmapFrames.push(m.animation.bitmapFrames[f])}}}}this.grassOverlay=this.worldService.overlays[4],this.setCurrentEntity(0,"NPC"),this.currentBlocksetContext.clearRect(0,0,this.currentBlocksetCanvas.width,this.currentBlocksetCanvas.height),this.currentBlocksetCanvas.width=128,this.currentBlocksetCanvas.height=1760,this.currentPaintBlockContext.clearRect(0,0,this.currentBlocksetCanvas.width,this.currentBlocksetCanvas.height),this.currentPaintBlockCanvas.width=16,this.currentPaintBlockCanvas.height=16,this.isBlockChanged=!0,this.drawWorld()}),this.onToolUpdated();let s=Date.now();console.log("Loaded map in "+((s-a)/1e3).toFixed(1)+" seconds")}drawWorld(){return(0,ie.mG)(this,void 0,void 0,function*(){this.worldRenderRef=requestAnimationFrame(this.drawWorld.bind(this)),this.zone.runOutsideAngular(()=>{this.drawParties(),this.drawPaintBlock()})})}setTileAnimationState(t){void 0!==t&&(this.isAnimatingTiles=t),this.isAnimatingTiles||this.stopTileAnimations()}updateEncounterSprites(){for(let t=0;t<this.currentMap.encounterData.encounterTypeGroups.length;t++)for(let n=0;n<this.currentMap.encounterData.encounterTypeGroups[t].wildMonsters.length;n++)for(let o=0;o<this.currentMap.encounterData.encounterTypeGroups[t].wildMonsters[n].length;o++){let a=this.currentMap.encounterData.encounterTypeGroups[t].wildMonsters[n][o];a.spriteCanvas=this.monsterService.loadBattleSprite(a.monsterId,!0,!1)}}drawParties(){let t=performance.now();if("entities"==this.currentWorldTool&&"NPC"==this.currentEntityType&&this.currentNPC&&this.currentNPC.trainerSprites&&this.currentNPC.trainerSprites.length>0)for(let n=0;n<this.currentNPC.trainers.length;n++){let o=this.currentNPC.trainers[n];for(let a=0;a<o.partyCount;a++)this.monsterService.monsterIcons[o.party[a].species].isAnimating||this.monsterService.monsterIcons[o.party[a].species].start(),this.monsterService.monsterIcons[o.party[a].species].doAnimation(t)}}goToTrainer(t){this.gbaService.toolSwitched.emit({tool:"trainerTool"}),this.trainerService.trainerIndexChanged.emit(t)}stopTileAnimations(){for(const[t,n]of this.currentMap.blockset.primaryTileset.tileCache.entries())n.bitmap.stop();for(const[t,n]of this.currentMap.blockset.secondaryTileset.tileCache.entries())n.bitmap.stop()}mouseOverBlock(t,n){this.currentHoverBlockId=this.currentMap.blockData.blockIds[n*this.currentMap.layout.mapWidth+t],this.isMouseDown&&this.blockClicked(t,n)}setCurrentBank(t,n){t!=this.currentBank&&(this.currentBank=t),n&&this.setCurrent(this.worldService.getMap(this.worldService.maps.indexOf(this.currentBank),0))}blockEnter(t,n,o){let a=n*this.currentMap.layout.mapWidth+o;this.currentHoverBlockId=t.blockIds[a],this.currentMetaId=t.blockMetas[a]}paintBlockSelected(t){this.currentPaintBlockId=t,this.currentPaintBlock=this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService),this.viewportService.isMedium||(this.isMinitoolPopupOpen=!1),this.drawPaintBlock()}drawPaintBlock(){this.worldService.drawBlock(this.currentPaintBlockContext,this.currentPaintBlock,0,0,!1)}blockClicked(t,n){this.isMouseDown=!0;let o=n*this.currentMap.layout.mapWidth+t;if("tiles"==this.currentWorldTool||"movement"==this.currentWorldTool){"tiles"==this.currentWorldTool?this.currentMap.blockData.blockIds[o]=this.currentPaintBlockId:"movement"==this.currentWorldTool&&(this.currentMap.blockData.blockMetas[o]=this.currentMovementId),this.isBlockChanged=!0;let a=new w.jo;a.changeReason=this.currentMap.label+"  Block Changed at X:"+t+", Y:"+n,a.key=this.currentMap.layout.tileDataAddress+"-"+t+"-"+n+"-"+o,a.address=this.currentMap.layout.tileDataAddress+2*o;let s=this.gbaService.toBitString(this.currentMap.blockData.blockIds[o],10),l=this.gbaService.toBitString(this.currentMap.blockData.blockMetas[o],6)+s,p=Number.parseInt(l,2);a.bytesToWrite=this.gbaService.bytesFromShort(p),this.gbaService.goTo(a.address),a.bytesBefore=this.gbaService.getBytes(a.bytesToWrite.length),this.gbaService.queueChange(a)}"encounters"==this.currentWorldTool&&(this.isGrassEncounterBlock(this.currentMap.blockData.blockIds[o])?this.currentEncounterType="GRASS":this.isSurfEncounterBlock(this.currentMap.blockData.blockIds[o])&&("FISHING"==this.currentEncounterType||"GRASS"==this.currentEncounterType?this.currentEncounterType="SURF":"SURF"==this.currentEncounterType&&(this.currentEncounterType="FISHING"))),this.changeDetector.detectChanges()}editBlocks(){this.dialog.open(Je,{data:{currentMap:this.currentMap,blockset:this.currentBlocksetCanvas}})}editDoors(){this.dialog.open(qe,{data:{currentMap:this.currentMap}})}editOverlays(){this.dialog.open(Fn,{data:{currentMap:this.currentMap}})}floorValue(t){return Math.floor(t)}onToolUpdated(){this.isMinitoolAvailable="tiles"===this.currentWorldTool||"movement"===this.currentWorldTool||"entities"===this.currentWorldTool||"encounters"===this.currentWorldTool}setCurrentEntity(t,n){switch(console.log(t),this.currentEntityType=n,n){case"NPC":if(this.currentNPC=this.currentMap.entityData.npcs[t],this.currentNPC&&this.currentNPC.scriptAddress>0){let o=this.scriptService.decompile(this.currentNPC.scriptAddress);if(this.currentNPC.script=this.scriptService.toXSE(o),this.currentNPC.isTrainer||this.currentNPC.script.length<5e3&&this.currentNPC.script.includes("trainerbattle")){let a=this.currentNPC.script.split("trainerbattle");if(a.length>1)for(let s=1;s<a.length;s++){let c=parseInt(a[s].trim().split(" ")[1],16),l=this.trainerService.trainers[c-1];console.log(l),this.currentNPC.trainers.includes(l)||(this.currentNPC.trainers.push(l),this.currentNPC.trainerSprites.push(this.trainerService.loadSprite(l.spriteId)))}}}break;case"SIGN":if(this.currentSign=this.currentMap.entityData.signs[t],this.currentSign&&this.currentSign.scriptAddress>0){let o=this.scriptService.decompile(this.currentSign.scriptAddress);this.currentSign.script=this.scriptService.toXSE(o)}break;case"WARP":this.currentWarp=this.currentMap.entityData.warps[t];break;case"SCRIPT":if(this.currentScript=this.currentMap.entityData.scripts[t],this.currentScript&&this.currentScript.scriptAddress>0){let o=this.scriptService.decompile(this.currentScript.scriptAddress);this.currentScript.script=this.scriptService.toXSE(o)}}}isEncounterBlock(t){return this.isGrassEncounterBlock(t)||this.isSurfEncounterBlock(t)}isGrassEncounterBlock(t){let n=this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService);return 2==n.behaviorId||209==n.behaviorId}isSurfEncounterBlock(t){let n=this.currentMap.blockset.getBlock(t,this.gbaService,this.bitmapService);return 16==n.behaviorId||17==n.behaviorId||21==n.behaviorId}getInputHexValue(t){let n=t.target.value,a=0;return/[0-9A-Fa-f]{6}/g.test(n)&&(a=Number.parseInt(n,16)),a}getMovement(t){for(let n=0;n<this.movements.length;n++)if(this.movements[n].id==t)return this.movements[n];return{id:t,title:"???",color:"#ccccccb3"}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.VP),e.Y36(E),e.Y36(e.sBO),e.Y36(y.Lw),e.Y36(Bt),e.Y36(Z.uw),e.Y36(he.mY),e.Y36(e.R0b),e.Y36(Ft.e),e.Y36(Ze.hP),e.Y36(Ot.hc),e.Y36(ue.v))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-world"]],decls:37,vars:16,consts:[[1,"container-fluid"],[1,"row","mt-3"],[1,"col-md-3"],["id","search"],[1,"mb-3","pb-0"],["for","search",1,"mb-2"],[1,"row"],[1,"col-6"],["appearance","fill",1,"w-100"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","map-card"],[3,"map","isShowingAnimations","isShowingOverworlds","zoom","animationsUpdated","overworldsUpdated","zoomUpdated"],[1,"col-md-9"],["id","editable-data"],[1,"poke-sprite-circle-big","phone-or-bigger"],[1,"mb-3","p-0","pt-3"],[1,"mb-3","mx-3","mt-0"],["class","w-100 h-100 overflow-auto d-block",4,"ngIf"],["mat-fab","","color","accent","aria-label","Mini-tool button","class","minitool-button",3,"disabled","click",4,"ngIf"],[1,"minitool-popup"],[3,"isOpen","currentMap","zoom","currentPaintBlockId","blockSelected",4,"ngIf"],[3,"currentMovementId","movementSelected",4,"ngIf"],[3,"currentMap","currentEntityType","currentEntityId","currentNPC","currentSign","currentWarp","currentScript","entitySelected",4,"ngIf"],[3,"currentMap","currentEncounterType",4,"ngIf"],[3,"value"],["class","mr-2",4,"ngIf"],[1,"mr-2"],[1,"w-100","h-100","overflow-auto","d-block"],[1,"w-100","overflow-auto","bg-gray"],[1,"w-100","border-bottom","border-top","bg-white","px-2","py-1","d-inline-flex","align-items-center","justify-content-between","poke-secondary-header"],[1,"d-flex","flex-column","w-100"],[1,"d-inline-flex","align-items-center"],["name","mapView","aria-label","Map View",1,"mr-2",3,"ngModel","ngModelChange"],["worldTools",""],["value","tiles","checked",""],["value","movement"],["value","entities"],["value","encounters"],["value","header"],["value","layout"],[1,"d-inline-flex","tablet-or-bigger"],[1,"px-2","d-flex","flex-column","justify-content-center","align-items-center"],[1,"d-inline-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","d-inline-flex",3,"width","height",4,"ngIf"],[4,"ngIf"],[3,"currentWorldTool","currentMap","zoom","isAnimatingTiles","isShowingOverworlds","currentEntityType","currentEntityId","currentNPC","currentSign","currentWarp","currentScript","blockClicked","entitySelected",4,"ngIf"],[3,"currentMap",4,"ngIf"],[1,"d-inline-flex"],["class","d-block position-absolute",3,"src","width","height","zIndex",4,"ngIf"],[1,"d-block","position-absolute",3,"src"],[3,"currentWorldTool","currentMap","zoom","isAnimatingTiles","isShowingOverworlds","currentEntityType","currentEntityId","currentNPC","currentSign","currentWarp","currentScript","blockClicked","entitySelected"],[3,"currentMap"],["mat-fab","","color","accent","aria-label","Mini-tool button",1,"minitool-button",3,"disabled","click"],[3,"isOpen","currentMap","zoom","currentPaintBlockId","blockSelected"],[3,"currentMovementId","movementSelected"],[3,"currentMap","currentEntityType","currentEntityId","currentNPC","currentSign","currentWarp","currentScript","entitySelected"],[3,"currentMap","currentEncounterType"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-card",4)(5,"h3",5)(6,"b"),e._uU(7,"Pick a Map"),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"mat-form-field",8)(11,"mat-label"),e._uU(12,"Selected Bank"),e.qZA(),e.TgZ(13,"mat-select",9),e.NdJ("ngModelChange",function(a){return n.currentBank=a})("ngModelChange",function(){return n.setCurrentBank(n.currentBank,!0)}),e.YNc(14,Qc,2,2,"mat-option",10),e.qZA()()(),e.TgZ(15,"div",7)(16,"mat-form-field",8)(17,"mat-label"),e._uU(18,"Selected Map"),e.qZA(),e.TgZ(19,"mat-select",9),e.NdJ("ngModelChange",function(a){return n.currentMap=a})("ngModelChange",function(){return n.setCurrent(n.currentMap)}),e.YNc(20,jc,5,4,"mat-option",10),e.qZA()()()()()(),e.TgZ(21,"div",11)(22,"app-map-card",12),e.NdJ("animationsUpdated",function(a){return n.setTileAnimationState(a)})("overworldsUpdated",function(a){return n.isShowingOverworlds=a})("zoomUpdated",function(a){return n.zoom=a}),e.qZA()()(),e.TgZ(23,"div",13)(24,"div",14),e._UZ(25,"div",15),e.TgZ(26,"mat-card",16)(27,"h3",17)(28,"b"),e._uU(29,"Pick a Tool"),e.qZA()(),e.YNc(30,e0,31,13,"div",18),e.qZA()()()()(),e.YNc(31,t0,3,1,"button",19),e.TgZ(32,"div",20),e.YNc(33,n0,1,4,"app-blockset-minitool",21),e.YNc(34,i0,1,1,"app-movement-minitool",22),e.YNc(35,o0,1,7,"app-entity-minitool",23),e.YNc(36,r0,1,2,"app-encounter-minitool",24),e.qZA()),2&t&&(e.xp6(13),e.Q6J("ngModel",n.currentBank),e.xp6(1),e.Q6J("ngForOf",n.worldService.maps),e.xp6(5),e.Q6J("ngModel",n.currentMap),e.xp6(1),e.Q6J("ngForOf",n.currentBank),e.xp6(2),e.Q6J("map",n.currentMap)("isShowingAnimations",n.isAnimatingTiles)("isShowingOverworlds",n.isShowingOverworlds)("zoom",n.zoom),e.xp6(8),e.Q6J("ngIf",n.currentMap),e.xp6(1),e.Q6J("ngIf",n.isMinitoolAvailable),e.xp6(1),e.Udp("display",n.isMinitoolAvailable&&n.isMinitoolPopupOpen?"block":"none"),e.xp6(1),e.Q6J("ngIf","tiles"===n.currentWorldTool),e.xp6(1),e.Q6J("ngIf","movement"===n.currentWorldTool),e.xp6(1),e.Q6J("ngIf","entities"===n.currentWorldTool),e.xp6(1),e.Q6J("ngIf","encounters"===n.currentWorldTool))},directives:[Nt.a8,S.KE,S.hX,U.gD,g.JJ,g.On,_.sg,A.ey,_.O5,yl,Jt.A9,Jt.Yi,Ol,Jl,ql,O.lW,z.Hw,Yl,ec,Bc,Rc],styles:['@media (min-width: 768px){.map-wrapper-1x[_ngcontent-%COMP%], .map-wrapper-2x[_ngcontent-%COMP%], .map-wrapper-3x[_ngcontent-%COMP%]{overflow:auto}}.meta-bg-0[_ngcontent-%COMP%]{background-color:#ff25c896}.meta-bg-1[_ngcontent-%COMP%]{background-color:#ff0000b3}.meta-bg-4[_ngcontent-%COMP%]{background-color:#ff0096b3}.meta-bg-5[_ngcontent-%COMP%]{background-color:#ff0000b3}.meta-bg-12[_ngcontent-%COMP%]{background-color:#5900ffb3}.meta-bg-13[_ngcontent-%COMP%]{background-color:#a54a00b3}.meta-bg-16[_ngcontent-%COMP%]{background-color:#0fa500b3}.meta-bg-20[_ngcontent-%COMP%]{background-color:#00a59aa4}.meta-bg-28[_ngcontent-%COMP%]{background-color:#a0a500b3}.movement-overlay[_ngcontent-%COMP%]{font-size:14px;line-height:16px;z-index:30}.movement-selector-preview[_ngcontent-%COMP%]{height:32px;width:32px;display:flex;align-items:center;justify-content:center}.script-fadeout[_ngcontent-%COMP%]{background-image:linear-gradient(#f0f0f0 0%,white 95%)}.minitool-button[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:15px;z-index:8000}.minitool-popup[_ngcontent-%COMP%]{z-index:8000;position:fixed;bottom:90px;right:15px;min-height:30px;max-height:calc(100vh - 230px);max-width:calc(100vw - 45px);min-width:256px;background-color:#fff;overflow-y:auto;transition:all 1s linear;border:#A5D6E7 solid .25em;border-radius:1.1em;box-shadow:1px 1px #4870a0,1px -1px #4870a0,-1px 1px #4870a0,-1px -1px #4870a0;padding-left:16px}.minitool-popup[_ngcontent-%COMP%]:before{content:"";position:absolute;background:#E0F0F8;top:.6em;bottom:.6em;left:.15em;width:.4em;border-radius:100px}.minitool-popup[_ngcontent-%COMP%]:after{content:"";position:absolute;background:#E0F0F8;top:.6em;bottom:.6em;right:.15em;width:.4em;border-radius:100px}']}),i})()}];let s0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[Fe.Bz.forChild(a0)],Fe.Bz]}),i})();var l0=v(4202);let c0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[_.ez,l0.q,g.u5,s0]]}),i})()}}]);